/**
 * 0. Project  : WISE DA 프로젝트
 *
 * 1. FileName : DbCatalogManager.java
 * 2. Package : wiseitech.wisedq.executor.schema
 * 3. Comment :
 * 4. 작성자  : 
 * 5. 작성일  : 2014. 6. 17. 오후 5:48:09
 * 6. 변경이력 :
 *                    이름     : 일자          : 근거자료   : 변경내용
 *                   ------------------------------------------------------
 *                     : 2014. 6. 17. :            : 신규 개발.
 */
package kr.wise.executor.exceute.dbgap;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

import kr.wise.commons.ConnectionHelper;
import kr.wise.executor.dm.TargetDbmsDM;
import kr.wise.executor.exceute.schema.dbms.CollectorAltibaseV6;
import kr.wise.executor.exceute.schema.dbms.CollectorOracle;

import org.apache.log4j.Logger;

/**
 * <PRE>
 * 1. ClassName :
 * 2. FileName  : DbCatalogManager.java
 * 3. Package  : wiseitech.wisedq.executor.schema
 * 4. Comment  :
 * 5. 작성자   : 
 * 6. 작성일   : 2014. 6. 17. 오후 5:48:09
 * </PRE>
 */
public class DbGapManager {

	private static final Logger logger = Logger.getLogger(DbGapManager.class);

	private Map<String, String> dbgapInfo = null;

	private Connection con = null;
	private PreparedStatement pst_org = null;


	public DbGapManager(Map<String, String> dbgapInfo) {
		this.dbgapInfo = dbgapInfo;
	}

	public void launch() throws Exception {
		boolean result = false;

		try{
			con  = ConnectionHelper.getDAConnection();
			con.setAutoCommit(false);
			
			//WAT_DB_GAP 삭제 
			deleteWatGap();
			//WAT_DB_GAP  적재.
			result = saveWatGap();
			
			if(result){
				//DB GAP 분석 실행
				analysysDbGap();
			}
			
			
			con.commit();

		} catch(Exception e) {
			con.rollback();
			logger.error(e);
			throw e;
		} finally {
			if(pst_org != null) {try { pst_org.close(); } catch(Exception igonred) {}}
			if(con  != null) {try { con.close(); } catch(Exception igonred) {}}
		}
	}
	/** @param MAP 
	 * @throws Exception */
	
	private void deleteWatGap() throws Exception {
		int result = 0;
		String srcDbSchId = dbgapInfo.get("SRC_DB_SCH_ID");
		String tgtDbSchId = dbgapInfo.get("TGT_DB_SCH_ID");

		logger.error("deleteWatGap :::  srcDbSchId : "+srcDbSchId + "  tgtDbSchId : "+tgtDbSchId);
		
		StringBuffer strSQL = new StringBuffer();
		strSQL.append("\n  DELETE FROM WAT_DBC_GAP_TBL ");
		strSQL.append("\n   WHERE SRC_DB_SCH_ID = '"+srcDbSchId+"' ");
		strSQL.append("\n     AND TGT_DB_SCH_ID = '"+tgtDbSchId+"' ");
		result = setExecuteUpdate_Org(strSQL.toString());
		logger.debug("delete WAT_DBC_GAP_TBL : " + result);
		
		strSQL.setLength(0);
		strSQL.append("\n  DELETE FROM WAT_DBC_GAP_COL ");
		strSQL.append("\n   WHERE SRC_DB_SCH_ID = '"+srcDbSchId+"' ");
		strSQL.append("\n     AND TGT_DB_SCH_ID = '"+tgtDbSchId+"' ");
		result = setExecuteUpdate_Org(strSQL.toString());
		logger.debug("delete WAT_DBC_GAP_COL : " + result);
		
		strSQL.setLength(0);
		strSQL.append("\n  DELETE FROM WAT_DBC_GAP_IDX ");
		strSQL.append("\n   WHERE SRC_DB_SCH_ID = '"+srcDbSchId+"' ");
		strSQL.append("\n     AND TGT_DB_SCH_ID = '"+tgtDbSchId+"' ");
		result = setExecuteUpdate_Org(strSQL.toString());
		logger.debug("delete WAT_DBC_GAP_IDX : " + result);
		
		strSQL.setLength(0);
		strSQL.append("\n  DELETE FROM WAT_DBC_GAP_IDX_COL ");
		strSQL.append("\n   WHERE SRC_DB_SCH_ID = '"+srcDbSchId+"' ");
		strSQL.append("\n     AND TGT_DB_SCH_ID = '"+tgtDbSchId+"' ");
		result = setExecuteUpdate_Org(strSQL.toString());
		logger.debug("delete WAT_DBC_GAP_IDX_COL : " + result);

	}

	private boolean  saveWatGap() throws Exception {
		boolean bRtn = false;
		int result = 0;
		String srcDbSchId = dbgapInfo.get("SRC_DB_SCH_ID");
		String tgtDbSchId = dbgapInfo.get("TGT_DB_SCH_ID");
		
		logger.error("srcDbSchId : "+srcDbSchId + "  tgtDbSchId : "+tgtDbSchId);
		
		//테이블 적재
		StringBuffer strSQL = new StringBuffer();
		strSQL.append("\n --DB간 GAP 테이블 적재 ");
		strSQL.append("\n INSERT INTO WAT_DBC_GAP_TBL ");
		strSQL.append("\n SELECT  CASE WHEN SRC.SRC_DB_SCH_ID IS NULL THEN TGT.SRC_DB_SCH_ID ELSE SRC.SRC_DB_SCH_ID END AS  SRC_DB_SCH_ID ");
		strSQL.append("\n         ,SRC.SRC_TBL_PNM ");
		strSQL.append("\n         ,SRC.SRC_TBL_LNM ");
		strSQL.append("\n         ,SRC.SRC_TBL_SPAC_NM ");
		strSQL.append("\n         ,SRC.SRC_DBMS_TYPE ");
		strSQL.append("\n         ,CASE WHEN SRC.SRC_CONN_TRG_ID IS NULL THEN TGT.TGT_CONN_TRG_ID ELSE SRC.SRC_CONN_TRG_ID END AS  SRC_CONN_TRG_ID ");
		strSQL.append("\n         ,SRC.SRC_DDL_TBL_ID ");
		strSQL.append("\n         ,SRC.SRC_PDM_TBL_ID ");
		strSQL.append("\n         ,CASE WHEN SRC.TGT_DB_SCH_ID IS NULL THEN TGT.TGT_DB_SCH_ID ELSE SRC.TGT_DB_SCH_ID END AS  TGT_DB_SCH_ID ");
		strSQL.append("\n         ,TGT.TGT_TBL_PNM ");
		strSQL.append("\n         ,TGT.TGT_TBL_LNM ");
		strSQL.append("\n         ,TGT.TGT_TBL_SPAC_NM ");
		strSQL.append("\n         ,TGT.TGT_DBMS_TYPE ");
		strSQL.append("\n         ,CASE WHEN TGT.TGT_CONN_TRG_ID IS NULL THEN SRC.TGT_CONN_TRG_ID ELSE TGT.TGT_CONN_TRG_ID END AS  TGT_CONN_TRG_ID ");
		strSQL.append("\n         ,TGT.TGT_DDL_TBL_ID ");
		strSQL.append("\n         ,TGT.TGT_PDM_TBL_ID ");
		strSQL.append("\n         ,CASE WHEN SRC.SRC_TBL_PNM IS NULL THEN 'N' ELSE NULL END AS SRC_TBL_EXTNC_EXS ");
		strSQL.append("\n         ,CASE WHEN TGT.TGT_TBL_PNM IS NULL THEN 'N' ELSE NULL END AS TGT_TBL_EXTNC_EXS ");
		strSQL.append("\n         ,NULL AS TBL_ERR_EXS ");
		strSQL.append("\n         ,NULL AS TBL_ERR_DESCN ");
		strSQL.append("\n         ,NULL AS IDX_ERR_EXS ");
		strSQL.append("\n         ,NULL AS IDX_ERR_DESCN ");
		strSQL.append("\n         ,NULL AS COL_ERR_EXS ");
		strSQL.append("\n         ,NULL AS COL_ERR_DESCN ");
		strSQL.append("\n         ,NULL AS DESCN ");
		strSQL.append("\n         ,NULL AS VERS ");
		strSQL.append("\n         ,NULL AS REG_TYP_CD ");
		strSQL.append("\n         ,SYSDATE AS WRIT_DTM ");
		strSQL.append("\n   FROM (SELECT   A.SRC_DB_SCH_ID ");
		strSQL.append("\n                 ,A.TGT_DB_SCH_ID AS TGT_DB_SCH_ID ");
		strSQL.append("\n                 ,B.DBC_TBL_NM AS SRC_TBL_PNM ");
		strSQL.append("\n                 ,B.DBC_TBL_KOR_NM SRC_TBL_LNM ");
		strSQL.append("\n                 ,B.DBC_TBL_SPAC_NM AS SRC_TBL_SPAC_NM ");
		strSQL.append("\n                 ,B.DBMS_TYPE AS SRC_DBMS_TYPE ");		
		strSQL.append("\n                 ,B.DDL_TBL_ID AS SRC_DDL_TBL_ID ");
		strSQL.append("\n                 ,B.PDM_TBL_ID AS SRC_PDM_TBL_ID ");		
		strSQL.append("\n                 ,B.DB_CONN_TRG_ID AS SRC_CONN_TRG_ID ");
		strSQL.append("\n                 ,S.DB_CONN_TRG_ID AS TGT_CONN_TRG_ID ");
		strSQL.append("\n           FROM WAA_DB_MAP A ");
		strSQL.append("\n                INNER JOIN WAT_DBC_TBL B ");
		strSQL.append("\n                   ON A.SRC_DB_SCH_ID = B.DB_SCH_ID ");
		strSQL.append("\n                INNER JOIN WAA_DB_SCH S ");
		strSQL.append("\n                   ON A.TGT_DB_SCH_ID = S.DB_SCH_ID ");
		strSQL.append("\n                  AND S.EXP_DTM = TO_DATE('99991231','YYYYMMDD') ");
		strSQL.append("\n                  AND S.REG_TYP_CD IN ('C','U') ");
		strSQL.append("\n          WHERE A.EXP_DTM = TO_DATE('99991231','YYYYMMDD') ");
		strSQL.append("\n            AND A.REG_TYP_CD IN ('C','U') ");
		strSQL.append("\n            AND A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n         ) SRC ");
		strSQL.append("\n         FULL OUTER JOIN ( SELECT A.SRC_DB_SCH_ID AS SRC_DB_SCH_ID ");
		strSQL.append("\n                                 ,A.TGT_DB_SCH_ID ");
		strSQL.append("\n                                 ,B.DBC_TBL_NM AS TGT_TBL_PNM ");
		strSQL.append("\n                                 ,B.DBC_TBL_KOR_NM TGT_TBL_LNM ");
		strSQL.append("\n                                 ,B.DBC_TBL_SPAC_NM AS TGT_TBL_SPAC_NM ");
		strSQL.append("\n                                 ,B.DBMS_TYPE AS TGT_DBMS_TYPE ");
		strSQL.append("\n                                 ,B.DDL_TBL_ID AS TGT_DDL_TBL_ID ");
		strSQL.append("\n                                 ,B.PDM_TBL_ID AS TGT_PDM_TBL_ID ");	
		strSQL.append("\n                                 ,B.DB_CONN_TRG_ID AS TGT_CONN_TRG_ID ");
		strSQL.append("\n                                 ,S.DB_CONN_TRG_ID AS SRC_CONN_TRG_ID ");
		strSQL.append("\n                           FROM WAA_DB_MAP A ");
		strSQL.append("\n                                INNER JOIN WAT_DBC_TBL B ");
		strSQL.append("\n                                   ON A.TGT_DB_SCH_ID = B.DB_SCH_ID ");
		strSQL.append("\n                               INNER JOIN WAA_DB_SCH S ");
		strSQL.append("\n                                   ON A.SRC_DB_SCH_ID = S.DB_SCH_ID ");
		strSQL.append("\n                                 AND S.EXP_DTM = TO_DATE('99991231','YYYYMMDD') ");
		strSQL.append("\n                                 AND S.REG_TYP_CD IN ('C','U') ");
		strSQL.append("\n                          WHERE A.EXP_DTM = TO_DATE('99991231','YYYYMMDD') ");
		strSQL.append("\n                            AND A.REG_TYP_CD IN ('C','U') ");
		strSQL.append("\n                            AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                          ) TGT ");
		strSQL.append("\n           ON SRC.SRC_TBL_PNM = TGT.TGT_TBL_PNM ");
		result = setExecuteUpdate_Org(strSQL.toString());
		logger.debug(" insert WAT_DBC_GAP_TBL : " + result);
		
		//컬럼적재
		strSQL = new StringBuffer();
		strSQL.append("\n -- DB간 GAP 컬럼적재 ");
		strSQL.append("\n INSERT INTO WAT_DBC_GAP_COL ");
		strSQL.append("\n SELECT CASE WHEN SRC.SRC_DB_SCH_ID IS NULL THEN TGT.SRC_DB_SCH_ID ELSE SRC.SRC_DB_SCH_ID END AS  SRC_DB_SCH_ID ");
		strSQL.append("\n        ,SRC.SRC_TBL_PNM ");
		strSQL.append("\n        ,SRC.SRC_COL_PNM ");
		strSQL.append("\n        ,SRC.SRC_COL_LNM ");
		strSQL.append("\n        ,SRC.SRC_DATA_TYPE ");
		strSQL.append("\n        ,SRC.SRC_DATA_LEN ");
		strSQL.append("\n        ,SRC.SRC_DATA_PNUM ");
		strSQL.append("\n        ,SRC.SRC_DATA_PNT ");
		strSQL.append("\n        ,SRC.SRC_NULL_YN ");
		strSQL.append("\n        ,SRC.SRC_DEFLT_LEN ");
		strSQL.append("\n        ,SRC.SRC_DEFLT_VAL ");
		strSQL.append("\n        ,SRC.SRC_PK_YN ");
		strSQL.append("\n        ,SRC.SRC_ORD ");
		strSQL.append("\n        ,SRC.SRC_PK_ORD ");
		strSQL.append("\n        ,SRC.SRC_COL_DESCN ");		
		strSQL.append("\n        ,SRC.SRC_DDL_COL_ID ");
		strSQL.append("\n        ,SRC.SRC_PDM_COL_ID ");
		strSQL.append("\n        ,CASE WHEN SRC.TGT_DB_SCH_ID IS NULL THEN TGT.TGT_DB_SCH_ID ELSE SRC.TGT_DB_SCH_ID END AS  TGT_DB_SCH_ID ");
		strSQL.append("\n        ,TGT.TGT_TBL_PNM ");
		strSQL.append("\n        ,TGT.TGT_COL_PNM ");
		strSQL.append("\n        ,TGT.TGT_COL_LNM ");
		strSQL.append("\n        ,TGT.TGT_DATA_TYPE ");
		strSQL.append("\n        ,TGT.TGT_DATA_LEN ");
		strSQL.append("\n        ,TGT.TGT_DATA_PNUM ");
		strSQL.append("\n        ,TGT.TGT_DATA_PNT ");
		strSQL.append("\n        ,TGT.TGT_NULL_YN ");
		strSQL.append("\n        ,TGT.TGT_DEFLT_LEN ");
		strSQL.append("\n        ,TGT.TGT_DEFLT_VAL ");
		strSQL.append("\n        ,TGT.TGT_PK_YN ");
		strSQL.append("\n        ,TGT.TGT_ORD ");
		strSQL.append("\n        ,TGT.TGT_PK_ORD ");
		strSQL.append("\n        ,TGT.TGT_COL_DESCN ");
		strSQL.append("\n        ,TGT.TGT_DDL_COL_ID ");
		strSQL.append("\n        ,TGT.TGT_PDM_COL_ID ");
		strSQL.append("\n        ,CASE WHEN SRC.SRC_COL_PNM IS NULL THEN 'N' ELSE NULL END AS SRC_COL_EXTNC_EXS ");
		strSQL.append("\n        ,CASE WHEN TGT.TGT_COL_PNM IS NULL THEN 'N' ELSE NULL END AS TGT_COL_EXTNC_EXS ");
		strSQL.append("\n        ,NULL AS COL_ERR_EXS ");
		strSQL.append("\n        ,NULL AS COL_ERR_DESCN ");
		strSQL.append("\n        ,NULL AS DATA_TYPE_ERR_EXS ");
		strSQL.append("\n        ,NULL AS DATA_LEN_ERR_EXS ");
		strSQL.append("\n        ,NULL AS DATA_PNUM_ERR_EXS ");
		strSQL.append("\n        ,NULL AS DATA_PNT_ERR_EXS ");
		strSQL.append("\n        ,NULL AS ORD_ERR_EXS ");
		strSQL.append("\n        ,NULL AS PK_YN_ERR_EXS ");
		strSQL.append("\n        ,NULL AS PK_ORD_ERR_EXS ");
		strSQL.append("\n        ,NULL AS NULL_YN_ERR_EXS ");
		strSQL.append("\n        ,NULL AS DEFLT_ERR_EXS ");
		strSQL.append("\n        ,NULL AS CMMT_ERR_EXS ");
		strSQL.append("\n        ,NULL AS DESCN ");
		strSQL.append("\n        ,NULL AS VERS ");
		strSQL.append("\n        ,NULL AS REG_TYP_CD ");
		strSQL.append("\n        ,SYSDATE AS WRIT_DTM ");
		strSQL.append("\n   FROM (SELECT A.SRC_DB_SCH_ID ");
		strSQL.append("\n                ,B.DBC_TBL_NM AS SRC_TBL_PNM ");
		strSQL.append("\n                ,B.DBC_COL_NM AS SRC_COL_PNM ");
		strSQL.append("\n                ,B.DBC_COL_KOR_NM AS SRC_COL_LNM ");
		strSQL.append("\n                ,B.DATA_TYPE AS SRC_DATA_TYPE ");
		strSQL.append("\n                ,B.DATA_LEN  AS SRC_DATA_LEN ");
		strSQL.append("\n                ,B.DATA_PNUM AS SRC_DATA_PNUM ");
		strSQL.append("\n                ,B.DATA_PNT  AS SRC_DATA_PNT ");
		strSQL.append("\n                ,B.NULL_YN   AS SRC_NULL_YN ");
		strSQL.append("\n                ,B.DEFLT_LEN AS SRC_DEFLT_LEN ");
		strSQL.append("\n                ,B.DEFLT_VAL AS SRC_DEFLT_VAL ");
		strSQL.append("\n                ,B.PK_YN     AS SRC_PK_YN ");
		strSQL.append("\n                ,B.ORD       AS SRC_ORD ");
		strSQL.append("\n                ,B.PK_ORD    AS SRC_PK_ORD ");
		strSQL.append("\n                ,B.COL_DESCN AS SRC_COL_DESCN ");
		strSQL.append("\n                ,A.TGT_DB_SCH_ID AS TGT_DB_SCH_ID ");
		strSQL.append("\n                ,B.DDL_COL_ID AS SRC_DDL_COL_ID ");
		strSQL.append("\n                ,B.PDM_COL_ID AS SRC_PDM_COL_ID ");
		strSQL.append("\n           FROM WAA_DB_MAP A ");
		strSQL.append("\n                INNER JOIN WAT_DBC_COL B ");
		strSQL.append("\n                   ON A.SRC_DB_SCH_ID = B.DB_SCH_ID ");
		strSQL.append("\n                INNER JOIN WAA_DB_SCH S ");
		strSQL.append("\n                   ON A.TGT_DB_SCH_ID = S.DB_SCH_ID ");
		strSQL.append("\n                  AND S.EXP_DTM = TO_DATE('99991231','YYYYMMDD') ");
		strSQL.append("\n                  AND S.REG_TYP_CD IN ('C','U') ");
		strSQL.append("\n            WHERE A.EXP_DTM = TO_DATE('99991231','YYYYMMDD') ");
		strSQL.append("\n            AND A.REG_TYP_CD IN ('C','U') ");
		strSQL.append("\n            AND A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n         ) SRC ");
		strSQL.append("\n         FULL OUTER JOIN (SELECT A.TGT_DB_SCH_ID ");
		strSQL.append("\n                                ,B.DBC_TBL_NM AS TGT_TBL_PNM ");
		strSQL.append("\n                                ,B.DBC_COL_NM AS TGT_COL_PNM ");
		strSQL.append("\n                                ,B.DBC_COL_KOR_NM AS TGT_COL_LNM ");
		strSQL.append("\n                                ,B.DATA_TYPE AS TGT_DATA_TYPE ");
		strSQL.append("\n                                ,B.DATA_LEN  AS TGT_DATA_LEN ");
		strSQL.append("\n                                ,B.DATA_PNUM AS TGT_DATA_PNUM ");
		strSQL.append("\n                                ,B.DATA_PNT  AS TGT_DATA_PNT ");
		strSQL.append("\n                                ,B.NULL_YN   AS TGT_NULL_YN ");
		strSQL.append("\n                                ,B.DEFLT_LEN AS TGT_DEFLT_LEN ");
		strSQL.append("\n                                ,B.DEFLT_VAL AS TGT_DEFLT_VAL ");
		strSQL.append("\n                                ,B.PK_YN     AS TGT_PK_YN ");
		strSQL.append("\n                                ,B.ORD       AS TGT_ORD ");
		strSQL.append("\n                                ,B.PK_ORD    AS TGT_PK_ORD ");
		strSQL.append("\n                                ,B.COL_DESCN AS TGT_COL_DESCN ");
		strSQL.append("\n                                ,A.SRC_DB_SCH_ID AS SRC_DB_SCH_ID ");
		strSQL.append("\n                                ,B.DDL_COL_ID AS TGT_DDL_COL_ID ");
		strSQL.append("\n                                ,B.PDM_COL_ID AS TGT_PDM_COL_ID ");
		strSQL.append("\n                           FROM WAA_DB_MAP A ");
		strSQL.append("\n                                INNER JOIN WAT_DBC_COL B ");
		strSQL.append("\n                                   ON A.TGT_DB_SCH_ID = B.DB_SCH_ID ");
		strSQL.append("\n                                INNER JOIN WAA_DB_SCH S ");
		strSQL.append("\n                                   ON A.SRC_DB_SCH_ID = S.DB_SCH_ID ");
		strSQL.append("\n                                  AND S.EXP_DTM = TO_DATE('99991231','YYYYMMDD') ");
		strSQL.append("\n                                  AND S.REG_TYP_CD IN ('C','U') ");
		strSQL.append("\n                            WHERE A.EXP_DTM = TO_DATE('99991231','YYYYMMDD') ");
		strSQL.append("\n                            AND A.REG_TYP_CD IN ('C','U') ");
		strSQL.append("\n                            AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                          ) TGT ");
		strSQL.append("\n           ON SRC.SRC_TBL_PNM = TGT.TGT_TBL_PNM ");
		strSQL.append("\n          AND SRC.SRC_COL_PNM = TGT.TGT_COL_PNM ");
		result = setExecuteUpdate_Org(strSQL.toString());
		logger.debug(" insert WAT_DBC_GAP_COL : " + result);

		
		//인덱스 적재
		strSQL = new StringBuffer();
		strSQL.append("\n -- DB간 GAP 인덱스 적재 ") ;
		strSQL.append("\n INSERT INTO WAT_DBC_GAP_IDX ") ;
		strSQL.append("\n SELECT CASE WHEN SRC.SRC_DB_SCH_ID IS NULL THEN TGT.SRC_DB_SCH_ID ELSE SRC.SRC_DB_SCH_ID END AS  SRC_DB_SCH_ID ") ;
//		strSQL.append("\n        ,SRC.SRC_TBL_PNM ") ;
		strSQL.append("\n        ,CASE WHEN SRC.SRC_TBL_PNM IS NULL THEN TGT.TGT_TBL_PNM ELSE SRC.SRC_TBL_PNM END AS  SRC_TBL_PNM ") ;
		strSQL.append("\n        ,SRC.SRC_IDX_PNM ") ;
		strSQL.append("\n        ,SRC.SRC_IDX_LNM ") ;
		strSQL.append("\n        ,SRC.SRC_IDX_SPAC_NM ") ;
		strSQL.append("\n        ,SRC.SRC_PK_YN ") ;
		strSQL.append("\n        ,SRC.SRC_UQ_YN ") ;
		strSQL.append("\n        ,SRC.SRC_COL_EACNT ") ;
		strSQL.append("\n        ,SRC.SRC_DDL_IDX_ID ") ;
		strSQL.append("\n        ,CASE WHEN SRC.TGT_DB_SCH_ID IS NULL THEN TGT.TGT_DB_SCH_ID ELSE SRC.TGT_DB_SCH_ID END AS  TGT_DB_SCH_ID ") ;
//		strSQL.append("\n        ,TGT.TGT_TBL_PNM ") ;
		strSQL.append("\n        ,CASE WHEN TGT.TGT_TBL_PNM IS NULL THEN SRC.SRC_TBL_PNM ELSE TGT.TGT_TBL_PNM END AS  TGT_TBL_PNM  ") ;
		strSQL.append("\n        ,TGT.TGT_IDX_PNM ") ;
		strSQL.append("\n        ,TGT.TGT_IDX_LNM ") ;
		strSQL.append("\n        ,TGT.TGT_IDX_SPAC_NM ") ;
		strSQL.append("\n        ,TGT.TGT_PK_YN ") ;
		strSQL.append("\n        ,TGT.TGT_UQ_YN ") ;
		strSQL.append("\n        ,TGT.TGT_COL_EACNT ") ;
		strSQL.append("\n        ,TGT.TGT_DDL_IDX_ID ") ;
		strSQL.append("\n        ,CASE WHEN SRC.SRC_IDX_PNM IS NULL THEN 'N' ELSE NULL END AS SRC_IDX_EXTNC_EXS ") ;
		strSQL.append("\n        ,CASE WHEN TGT.TGT_IDX_PNM IS NULL THEN 'N' ELSE NULL END AS TGT_IDX_EXTNC_EXS ") ;
		strSQL.append("\n        ,NULL AS IDX_SPAC_NM_ERR_EXS ") ;
		strSQL.append("\n        ,NULL AS PK_YN_ERR_EXS ") ;
		strSQL.append("\n        ,NULL AS UQ_YN_ERR_EXS ") ;
		strSQL.append("\n        ,NULL AS COL_EACNT_ERR_EXS ") ;
		strSQL.append("\n        ,NULL AS IDX_ERR_EXS ") ;
		strSQL.append("\n        ,NULL AS IDX_ERR_DESCN ") ;
		strSQL.append("\n        ,NULL AS IDX_COL_ERR_EXS ") ;
		strSQL.append("\n        ,NULL AS IDX_COL_ERR_DESCN ") ;
		strSQL.append("\n        ,NULL AS DESCN ") ;
		strSQL.append("\n        ,NULL AS VERS ") ;
		strSQL.append("\n        ,NULL AS REG_TYP_CD ") ;
		strSQL.append("\n        ,SYSDATE AS WRIT_DTM ") ;
		strSQL.append("\n   FROM (SELECT A.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                ,B.DBC_TBL_NM AS SRC_TBL_PNM ") ;
		strSQL.append("\n                ,B.DBC_IDX_NM AS SRC_IDX_PNM ") ;
		strSQL.append("\n                ,B.DBC_IDX_KOR_NM AS SRC_IDX_LNM ") ;
		strSQL.append("\n                ,B.DBC_TBL_SPAC_NM AS SRC_IDX_SPAC_NM ") ;
		strSQL.append("\n                ,B.PK_YN  AS SRC_PK_YN ") ;
		strSQL.append("\n                ,B.UQ_YN AS SRC_UQ_YN ") ;
		strSQL.append("\n                ,B.COL_EACNT  AS SRC_COL_EACNT ") ;
		strSQL.append("\n                ,B.DDL_IDX_ID   AS SRC_DDL_IDX_ID ") ;
		strSQL.append("\n                ,A.TGT_DB_SCH_ID AS TGT_DB_SCH_ID ") ;
		strSQL.append("\n           FROM WAA_DB_MAP A ") ;
		strSQL.append("\n                INNER JOIN WAT_DBC_IDX B ") ;
		strSQL.append("\n                   ON A.SRC_DB_SCH_ID = B.DB_SCH_ID ") ;
		strSQL.append("\n                INNER JOIN WAA_DB_SCH S ") ;
		strSQL.append("\n                   ON A.TGT_DB_SCH_ID = S.DB_SCH_ID ") ;
		strSQL.append("\n                  AND S.EXP_DTM = TO_DATE('99991231','YYYYMMDD') ") ;
		strSQL.append("\n                  AND S.REG_TYP_CD IN ('C','U') ") ;
		strSQL.append("\n            WHERE A.EXP_DTM = TO_DATE('99991231','YYYYMMDD') ") ;
		strSQL.append("\n            AND A.REG_TYP_CD IN ('C','U') ") ;
		strSQL.append("\n            AND A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n         ) SRC ") ;
		strSQL.append("\n         FULL OUTER JOIN (SELECT A.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                                ,B.DBC_TBL_NM AS TGT_TBL_PNM ") ;
		strSQL.append("\n                                ,B.DBC_IDX_NM AS TGT_IDX_PNM ") ;
		strSQL.append("\n                                ,B.DBC_IDX_KOR_NM AS TGT_IDX_LNM ") ;
		strSQL.append("\n                                ,B.DBC_TBL_SPAC_NM AS TGT_IDX_SPAC_NM ") ;
		strSQL.append("\n                                ,B.PK_YN  AS TGT_PK_YN ") ;
		strSQL.append("\n                                ,B.UQ_YN AS TGT_UQ_YN ") ;
		strSQL.append("\n                                ,B.COL_EACNT  AS TGT_COL_EACNT ") ;
		strSQL.append("\n                                ,B.DDL_IDX_ID   AS TGT_DDL_IDX_ID ") ;
		strSQL.append("\n                                ,A.SRC_DB_SCH_ID AS SRC_DB_SCH_ID ") ;
		strSQL.append("\n                           FROM WAA_DB_MAP A ") ;
		strSQL.append("\n                                INNER JOIN WAT_DBC_IDX B ") ;
		strSQL.append("\n                                   ON A.TGT_DB_SCH_ID = B.DB_SCH_ID ") ;
		strSQL.append("\n                                INNER JOIN WAA_DB_SCH S ") ;
		strSQL.append("\n                                   ON A.SRC_DB_SCH_ID = S.DB_SCH_ID ") ;
		strSQL.append("\n                                  AND S.EXP_DTM = TO_DATE('99991231','YYYYMMDD') ") ;
		strSQL.append("\n                                  AND S.REG_TYP_CD IN ('C','U') ") ;
		strSQL.append("\n                            WHERE A.EXP_DTM = TO_DATE('99991231','YYYYMMDD') ") ;
		strSQL.append("\n                            AND A.REG_TYP_CD IN ('C','U') ") ;
		strSQL.append("\n                            AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                          ) TGT ") ;
		strSQL.append("\n           ON SRC.SRC_TBL_PNM = TGT.TGT_TBL_PNM ") ;
		strSQL.append("\n          AND SRC.SRC_IDX_PNM = TGT.TGT_IDX_PNM ") ;
		result = setExecuteUpdate_Org(strSQL.toString());
		logger.debug(" insert WAT_DBC_GAP_IDX : " + result);

		
		//인덱스컬럼적재
		strSQL = new StringBuffer();
		strSQL.append("\n -- DB간 GAP 인덱스 컬럼 적재 ") ;
		strSQL.append("\n INSERT INTO WAT_DBC_GAP_IDX_COL ") ;
		strSQL.append("\n SELECT CASE WHEN SRC.SRC_DB_SCH_ID IS NULL THEN TGT.SRC_DB_SCH_ID ELSE SRC.SRC_DB_SCH_ID END AS  SRC_DB_SCH_ID ") ;
		strSQL.append("\n        ,SRC.SRC_TBL_PNM ") ;
		strSQL.append("\n        ,SRC.SRC_IDX_PNM ") ;
		strSQL.append("\n        ,SRC.SRC_IDX_COL_PNM ") ;
		strSQL.append("\n        ,SRC.SRC_IDX_COL_LNM ") ;
		strSQL.append("\n        ,SRC.SRC_ORD ") ;
		strSQL.append("\n        ,SRC.SRC_SORT_TYPE ") ;
		strSQL.append("\n        ,SRC.SRC_DATA_TYPE ") ;
		strSQL.append("\n        ,SRC.SRC_DATA_PNUM ") ;
		strSQL.append("\n        ,SRC.SRC_DATA_LEN ") ;
		strSQL.append("\n        ,SRC.SRC_DATA_PNT ") ;
		strSQL.append("\n        ,SRC.SRC_DDL_IDX_COL_ID ") ;
		strSQL.append("\n        ,CASE WHEN SRC.TGT_DB_SCH_ID IS NULL THEN TGT.TGT_DB_SCH_ID ELSE SRC.TGT_DB_SCH_ID END AS  TGT_DB_SCH_ID ") ;
		strSQL.append("\n        ,TGT.TGT_TBL_PNM ") ;
		strSQL.append("\n        ,TGT.TGT_IDX_PNM ") ;
		strSQL.append("\n        ,TGT.TGT_IDX_COL_PNM ") ;
		strSQL.append("\n        ,TGT.TGT_IDX_COL_LNM ") ;
		strSQL.append("\n        ,TGT.TGT_ORD ") ;
		strSQL.append("\n        ,TGT.TGT_SORT_TYPE ") ;
		strSQL.append("\n        ,TGT.TGT_DATA_TYPE ") ;
		strSQL.append("\n        ,TGT.TGT_DATA_PNUM ") ;
		strSQL.append("\n        ,TGT.TGT_DATA_LEN ") ;
		strSQL.append("\n        ,TGT.TGT_DATA_PNT ") ;
		strSQL.append("\n        ,TGT.TGT_DDL_IDX_COL_ID ") ;
		strSQL.append("\n        ,CASE WHEN SRC.SRC_IDX_COL_PNM IS NULL THEN 'N' ELSE NULL END AS SRC_IDX_COL_EXTNC_EXS ") ;
		strSQL.append("\n        ,CASE WHEN TGT.TGT_IDX_COL_PNM IS NULL THEN 'N' ELSE NULL END AS TGT_IDX_COL_EXTNC_EXS ") ;
		strSQL.append("\n        ,NULL AS ORD_ERR_EXS ") ;
		strSQL.append("\n        ,NULL AS SORT_TYPE ") ;
		strSQL.append("\n        ,NULL AS DATA_TYPE_ERR_EXS ") ;
		strSQL.append("\n        ,NULL AS DATA_PNUM_ERR_EXS ") ;
		strSQL.append("\n        ,NULL AS DATA_LEN_ERR_EXS ") ;
		strSQL.append("\n        ,NULL AS DATA_PNT_ERR_EXS ") ;
		strSQL.append("\n        ,NULL AS IDX_COL_ERR_EXS ") ;
		strSQL.append("\n        ,NULL AS IDX_COL_ERR_DESCN ") ;
		strSQL.append("\n        ,NULL AS DESCN ") ;
		strSQL.append("\n        ,NULL AS VERS ") ;
		strSQL.append("\n        ,NULL AS REG_TYP_CD ") ;
		strSQL.append("\n        ,SYSDATE AS WRIT_DTM ") ;
		strSQL.append("\n   FROM (SELECT A.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                ,B.DBC_TBL_NM AS SRC_TBL_PNM ") ;
		strSQL.append("\n                ,B.DBC_IDX_NM AS SRC_IDX_PNM ") ;
		strSQL.append("\n                ,B.DBC_IDX_COL_NM AS SRC_IDX_COL_PNM ") ;
		strSQL.append("\n                ,B.DBC_IDX_COL_KOR_NM AS SRC_IDX_COL_LNM ") ;
		strSQL.append("\n                ,B.ORD AS SRC_ORD ") ;
		strSQL.append("\n                ,B.SORT_TYPE AS SRC_SORT_TYPE ") ;
		strSQL.append("\n                ,B.DATA_TYPE AS SRC_DATA_TYPE ") ;
		strSQL.append("\n                ,B.DATA_PNUM AS SRC_DATA_PNUM ") ;
		strSQL.append("\n                ,B.DATA_LEN AS SRC_DATA_LEN ") ;
		strSQL.append("\n                ,B.DATA_PNT AS SRC_DATA_PNT ") ;
		strSQL.append("\n                ,B.DDL_IDX_COL_ID   AS SRC_DDL_IDX_COL_ID ") ;
		strSQL.append("\n                ,A.TGT_DB_SCH_ID AS TGT_DB_SCH_ID ") ;
		strSQL.append("\n           FROM WAA_DB_MAP A ") ;
		strSQL.append("\n                INNER JOIN WAT_DBC_IDX_COL B ") ;
		strSQL.append("\n                   ON A.SRC_DB_SCH_ID = B.DB_SCH_ID ") ;
		strSQL.append("\n                INNER JOIN WAA_DB_SCH S ") ;
		strSQL.append("\n                   ON A.TGT_DB_SCH_ID = S.DB_SCH_ID ") ;
		strSQL.append("\n                  AND S.EXP_DTM = TO_DATE('99991231','YYYYMMDD') ") ;
		strSQL.append("\n                  AND S.REG_TYP_CD IN ('C','U') ") ;
		strSQL.append("\n            WHERE A.EXP_DTM = TO_DATE('99991231','YYYYMMDD') ") ;
		strSQL.append("\n            AND A.REG_TYP_CD IN ('C','U') ") ;
		strSQL.append("\n            AND A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n         ) SRC ") ;
		strSQL.append("\n         FULL OUTER JOIN (SELECT A.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                                ,B.DBC_TBL_NM AS TGT_TBL_PNM ") ;
		strSQL.append("\n                                ,B.DBC_IDX_NM AS TGT_IDX_PNM ") ;
		strSQL.append("\n                                ,B.DBC_IDX_COL_NM AS TGT_IDX_COL_PNM ") ;
		strSQL.append("\n                                ,B.DBC_IDX_COL_KOR_NM AS TGT_IDX_COL_LNM ") ;
		strSQL.append("\n                                ,B.ORD AS TGT_ORD ") ;
		strSQL.append("\n                                ,B.SORT_TYPE AS TGT_SORT_TYPE ") ;
		strSQL.append("\n                                ,B.DATA_TYPE AS TGT_DATA_TYPE ") ;
		strSQL.append("\n                                ,B.DATA_PNUM AS TGT_DATA_PNUM ") ;
		strSQL.append("\n                                ,B.DATA_LEN AS TGT_DATA_LEN ") ;
		strSQL.append("\n                                ,B.DATA_PNT AS TGT_DATA_PNT ") ;
		strSQL.append("\n                                ,B.DDL_IDX_COL_ID   AS TGT_DDL_IDX_COL_ID ") ;
		strSQL.append("\n                                ,A.SRC_DB_SCH_ID AS SRC_DB_SCH_ID ") ;
		strSQL.append("\n                           FROM WAA_DB_MAP A ") ;
		strSQL.append("\n                                INNER JOIN WAT_DBC_IDX_COL B ") ;
		strSQL.append("\n                                   ON A.TGT_DB_SCH_ID = B.DB_SCH_ID ") ;
		strSQL.append("\n                                INNER JOIN WAA_DB_SCH S ") ;
		strSQL.append("\n                                   ON A.SRC_DB_SCH_ID = S.DB_SCH_ID ") ;
		strSQL.append("\n                                  AND S.EXP_DTM = TO_DATE('99991231','YYYYMMDD') ") ;
		strSQL.append("\n                                  AND S.REG_TYP_CD IN ('C','U') ") ;
		strSQL.append("\n                            WHERE A.EXP_DTM = TO_DATE('99991231','YYYYMMDD') ") ;
		strSQL.append("\n                            AND A.REG_TYP_CD IN ('C','U') ") ;
		strSQL.append("\n                            AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                          ) TGT ") ;
		strSQL.append("\n           ON SRC.SRC_TBL_PNM = TGT.TGT_TBL_PNM ") ;
		strSQL.append("\n          AND SRC.SRC_IDX_PNM = TGT.TGT_IDX_PNM ") ;
		strSQL.append("\n          AND SRC.SRC_IDX_COL_PNM = TGT.TGT_IDX_COL_PNM ") ;
		
		result = setExecuteUpdate_Org(strSQL.toString());
		logger.debug(" insert WAT_DBC_GAP_IDX_COL : " + result);
		bRtn = true;
		return bRtn;
	}
	
	
	/** DBC 갭분석 실시한다.  
	 * @throws Exception */
	private void analysysDbGap() throws Exception {
		int result = 0;
		//DB COL GAP
		result = updateWatDbGapColErr();
		logger.debug("updateWatDbGapColErr : " + result + " OK!!");
		//DB IDX COL GAP
		result = updateWatDbGapIdxColErr();
		logger.debug("updateWatDbGapIdxColErr : " + result + " OK!!");
		//DB IDX GAP
		result = updateWatDbGapIdxErr();
		logger.debug("updateWatDbGapIdxErr : " + result + " OK!!");
		//DB IDX TBL
		result = updateWatDbGAPTblErr();
		logger.debug("updateWatDbGAPTblErr : " + result + " OK!!");
		
		
	}
	
	/** @return 
	 * @throws Exception */
	private int updateWatDbGAPTblErr() throws Exception {
		String srcDbSchId = dbgapInfo.get("SRC_DB_SCH_ID");
		String tgtDbSchId = dbgapInfo.get("TGT_DB_SCH_ID");
		
		logger.error("srcDbSchId : "+srcDbSchId + "  tgtDbSchId : "+tgtDbSchId);
		
		StringBuffer strSQL = new StringBuffer();
		strSQL.append("\n BEGIN ");
		strSQL.append("\n  UPDATE WAT_DBC_GAP_TBL ");
		strSQL.append("\n        SET TBL_ERR_EXS = NULL ");
		strSQL.append("\n              , TBL_ERR_DESCN  = NULL ");
		strSQL.append("\n              , IDX_ERR_EXS  = NULL ");
		strSQL.append("\n              , IDX_ERR_DESCN  = NULL ");
		strSQL.append("\n              , COL_ERR_EXS  = NULL ");
		strSQL.append("\n              , COL_ERR_DESCN  = NULL ");
		strSQL.append("\n    WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n       AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    ; ");
		strSQL.append("\n  UPDATE WAT_DBC_GAP_TBL ") ;
		strSQL.append("\n     SET  TBL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,TBL_ERR_DESCN = TBL_ERR_DESCN || '[소스테이블미존재]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(SRC_TBL_EXTNC_EXS,'_') = 'N' ") ;
		strSQL.append("\n   ; ") ;
		strSQL.append("\n   UPDATE WAT_DBC_GAP_TBL ") ;
		strSQL.append("\n     SET  TBL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,TBL_ERR_DESCN = TBL_ERR_DESCN || '[타겟테이블미존재]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(TGT_TBL_EXTNC_EXS,'_') = 'N' ") ;
		strSQL.append("\n   ; ") ;
		strSQL.append("\n --컬럼 GAP UPDATE ") ;
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.COL_ERR_DESCN =COL_ERR_DESCN ||  '[소스컬럼미존재]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND NVL(A.SRC_TBL_EXTNC_EXS, 'Y') = 'Y' ") ;
		strSQL.append("\n    AND NVL(A.TGT_TBL_EXTNC_EXS, 'Y') = 'Y' ") ;
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(SRC_COL_EXTNC_EXS) AS SRC_COL_EXTNC_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_COL ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.SRC_COL_EXTNC_EXS, '_') = 'N' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.COL_ERR_DESCN =COL_ERR_DESCN ||  '[타겟컬럼미존재]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND NVL(A.SRC_TBL_EXTNC_EXS, 'Y') = 'Y' ") ;
		strSQL.append("\n    AND NVL(A.TGT_TBL_EXTNC_EXS, 'Y') = 'Y' ") ;
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(TGT_COL_EXTNC_EXS) AS TGT_COL_EXTNC_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_COL ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.TGT_COL_EXTNC_EXS, '_') = 'N' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.COL_ERR_DESCN =COL_ERR_DESCN ||  '[컬럼데이터타입GAP]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(DATA_TYPE_ERR_EXS) AS DATA_TYPE_ERR_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_COL ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.DATA_TYPE_ERR_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.COL_ERR_DESCN =COL_ERR_DESCN ||  '[컬럼데이터길이GAP]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(DATA_LEN_ERR_EXS) AS DATA_LEN_ERR_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_COL ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.DATA_LEN_ERR_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.COL_ERR_DESCN =COL_ERR_DESCN ||  '[컬럼데이터자리수GAP]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(DATA_PNUM_ERR_EXS) AS DATA_PNUM_ERR_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_COL ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.DATA_PNUM_ERR_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.COL_ERR_DESCN =COL_ERR_DESCN ||  '[컬럼데이터소수점GAP]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(DATA_PNT_ERR_EXS) AS DATA_PNT_ERR_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_COL ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.DATA_PNT_ERR_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.COL_ERR_DESCN =COL_ERR_DESCN ||  '[컬럼순서GAP]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(ORD_ERR_EXS) AS ORD_ERR_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_COL ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.ORD_ERR_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.COL_ERR_DESCN =COL_ERR_DESCN ||  '[컬럼PK여부GAP]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(PK_YN_ERR_EXS) AS PK_YN_ERR_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_COL ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.PK_YN_ERR_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.COL_ERR_DESCN =COL_ERR_DESCN ||  '[컬럼PK순서GAP]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(PK_ORD_ERR_EXS) AS PK_ORD_ERR_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_COL ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.PK_ORD_ERR_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.COL_ERR_DESCN =COL_ERR_DESCN ||  '[컬럼NULL여부GAP]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(NULL_YN_ERR_EXS) AS NULL_YN_ERR_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_COL ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.NULL_YN_ERR_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.COL_ERR_DESCN =COL_ERR_DESCN ||  '[컬럼DEFAULT값 GAP]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(DEFLT_ERR_EXS) AS DEFLT_ERR_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_COL ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.DEFLT_ERR_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.COL_ERR_DESCN =COL_ERR_DESCN ||  '[컬럼COMMENT GAP]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(CMMT_ERR_EXS) AS CMMT_ERR_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_COL ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.CMMT_ERR_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
//		strSQL.append("\n --컬럼 GAP UPDATE ") ;
//		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
//		strSQL.append("\n    SET A.COL_ERR_EXS = 'Y' ") ;
//		strSQL.append("\n         ,A.COL_ERR_DESCN =COL_ERR_DESCN ||  '[컬럼GAP]' ") ;
//		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
//		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
//		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
//		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
//		strSQL.append("\n                               ,MAX(IDX_ERR_EXS) AS IDX_ERR_EXS ") ;
//		strSQL.append("\n                          FROM WAT_DBC_GAP_COL ") ;
//		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
//		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
//		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
//		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
//		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
//		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
//		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
//		strSQL.append("\n                   AND NVL(B.COL_ERR_EXS, '_') = 'Y' ) ") ;
//		strSQL.append("\n        ; ");
//		strSQL.append("\n --인덱스 GAP UPDATE ") ;
//		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
//		strSQL.append("\n    SET A.IDX_ERR_EXS = 'Y' ") ;
//		strSQL.append("\n         ,A.IDX_ERR_DESCN = '[인덱스GAP]' ") ;
//		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
//		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
//		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
//		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
//		strSQL.append("\n                               ,MAX(IDX_ERR_EXS) AS IDX_ERR_EXS ") ;
//		strSQL.append("\n                          FROM WAT_DBC_GAP_IDX ") ;
//		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
//		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
//		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
//		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
//		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
//		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
//		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
//		strSQL.append("\n                   AND NVL(B.IDX_ERR_EXS, '_') = 'Y' ) ") ;
//		strSQL.append("\n        ; ");
		strSQL.append("\n --인덱스 GAP UPDATE ") ;
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.IDX_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.IDX_ERR_DESCN =IDX_ERR_DESCN ||  '[소스인덱스 미존재]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND NVL(A.SRC_TBL_EXTNC_EXS, 'Y') = 'Y' ") ;
		strSQL.append("\n    AND NVL(A.TGT_TBL_EXTNC_EXS, 'Y') = 'Y' ") ;
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(SRC_IDX_EXTNC_EXS) AS SRC_IDX_EXTNC_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_IDX ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.SRC_IDX_EXTNC_EXS, '_') = 'N' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.IDX_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.IDX_ERR_DESCN =IDX_ERR_DESCN ||  '[타겟인덱스 미존재]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND NVL(A.SRC_TBL_EXTNC_EXS, 'Y') = 'Y' ") ;
		strSQL.append("\n    AND NVL(A.TGT_TBL_EXTNC_EXS, 'Y') = 'Y' ") ;
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(TGT_IDX_EXTNC_EXS) AS TGT_IDX_EXTNC_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_IDX ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.TGT_IDX_EXTNC_EXS, '_') = 'N' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.IDX_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.IDX_ERR_DESCN =IDX_ERR_DESCN ||  '[인덱스 테이블스페이스 GAP]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(IDX_SPAC_NM_ERR_EXS) AS IDX_SPAC_NM_ERR_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_IDX ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.IDX_SPAC_NM_ERR_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.IDX_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.IDX_ERR_DESCN =IDX_ERR_DESCN ||  '[인덱스PK여부 GAP]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(PK_YN_ERR_EXS) AS PK_YN_ERR_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_IDX ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.PK_YN_ERR_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.IDX_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.IDX_ERR_DESCN =IDX_ERR_DESCN ||  '[인덱스유니크여부 GAP]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(UQ_YN_ERR_EXS) AS UQ_YN_ERR_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_IDX ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.UQ_YN_ERR_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.IDX_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.IDX_ERR_DESCN =IDX_ERR_DESCN ||  '[인덱스컬럼건수 GAP]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(COL_EACNT_ERR_EXS) AS COL_EACNT_ERR_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_IDX ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.COL_EACNT_ERR_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n -- DB간 인덱스 컬럼 GAP UPDATE ") ;
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.IDX_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.IDX_ERR_DESCN =IDX_ERR_DESCN ||  '[소스인덱스컬럼 미존재]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(SRC_IDX_COL_EXTNC_EXS) AS SRC_IDX_COL_EXTNC_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_IDX_COL ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.SRC_IDX_COL_EXTNC_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.IDX_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.IDX_ERR_DESCN =IDX_ERR_DESCN ||  '[타겟인덱스컬럼 미존재]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(TGT_IDX_COL_EXTNC_EXS) AS TGT_IDX_COL_EXTNC_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_IDX_COL ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.TGT_IDX_COL_EXTNC_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.IDX_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.IDX_ERR_DESCN =IDX_ERR_DESCN ||  '[인덱스컬럼순서 GAP]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(ORD_ERR_EXS) AS ORD_ERR_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_IDX_COL ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.ORD_ERR_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.IDX_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.IDX_ERR_DESCN =IDX_ERR_DESCN ||  '[인덱스컬럼정렬유형 GAP]' ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                  FROM (SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ") ;
		strSQL.append("\n                               ,MAX(SORT_TYPE_ERR_EXS) AS SORT_TYPE_ERR_EXS ") ;
		strSQL.append("\n                          FROM WAT_DBC_GAP_IDX_COL ") ;
		strSQL.append("\n                         WHERE SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n                            AND TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                         GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, TGT_DB_SCH_ID, TGT_TBL_PNM ) B ") ;
		strSQL.append("\n                 WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.SRC_TBL_PNM,'_') = NVL(B.SRC_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                   AND NVL(A.TGT_TBL_PNM,'_') = NVL(B.TGT_TBL_PNM,'_') ") ;
		strSQL.append("\n                   AND NVL(B.SORT_TYPE_ERR_EXS, '_') = 'Y' ) ") ;
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.TBL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.TBL_ERR_DESCN =TBL_ERR_DESCN ||  IDX_ERR_DESCN ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND NVL(A.IDX_ERR_EXS, 'N') = 'Y' ");
		strSQL.append("\n        ; ");
		strSQL.append("\n UPDATE WAT_DBC_GAP_TBL A ") ;
		strSQL.append("\n    SET A.COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.TBL_ERR_DESCN =TBL_ERR_DESCN ||  COL_ERR_DESCN ") ;
		strSQL.append("\n WHERE A.SRC_DB_SCH_ID = '").append(srcDbSchId).append("' ");
		strSQL.append("\n    AND A.TGT_DB_SCH_ID = '").append(tgtDbSchId).append("' ");
		strSQL.append("\n    AND NVL(A.COL_ERR_EXS, 'N') = 'Y' ");
		strSQL.append("\n        ; ");
		strSQL.append("\n    END; ");

		return setExecuteUpdate_Org(strSQL.toString());
	}


	
	/** @return 
	 * @throws Exception */
	private int updateWatDbGapColErr() throws Exception {
		String srcDbSchId = dbgapInfo.get("SRC_DB_SCH_ID");
		String tgtDbSchId = dbgapInfo.get("TGT_DB_SCH_ID");
		
		logger.error("srcDbSchId : "+srcDbSchId + "  tgtDbSchId : "+tgtDbSchId);
		
		StringBuffer strSQL = new StringBuffer();
		strSQL.append("\n  BEGIN ") ;
		strSQL.append("\n  -- DB간 컬럼 GAP 초기화 ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_COL ") ;
		strSQL.append("\n     SET  COL_ERR_EXS = NULL ") ;
		strSQL.append("\n         ,COL_ERR_DESCN = NULL ") ;
		strSQL.append("\n         ,DATA_TYPE_ERR_EXS = NULL ") ;
		strSQL.append("\n         ,DATA_LEN_ERR_EXS = NULL ") ;
		strSQL.append("\n         ,DATA_PNUM_ERR_EXS = NULL ") ;
		strSQL.append("\n         ,DATA_PNT_ERR_EXS = NULL ") ;
		strSQL.append("\n         ,ORD_ERR_EXS = NULL ") ;
		strSQL.append("\n         ,PK_YN_ERR_EXS = NULL ") ;
		strSQL.append("\n         ,PK_ORD_ERR_EXS = NULL ") ;
		strSQL.append("\n         ,NULL_YN_ERR_EXS = NULL ") ;
		strSQL.append("\n         ,DEFLT_ERR_EXS = NULL ") ;;
		strSQL.append("\n         ,CMMT_ERR_EXS = NULL ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  -- GAP UPDATE ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_COL A ") ;
		strSQL.append("\n     SET (A.DATA_TYPE_ERR_EXS ") ;
		strSQL.append("\n         ,A.DATA_LEN_ERR_EXS ") ;
		strSQL.append("\n         ,A.DATA_PNUM_ERR_EXS ") ;
		strSQL.append("\n         ,A.DATA_PNT_ERR_EXS ") ;
		strSQL.append("\n         ,A.ORD_ERR_EXS ") ;
		strSQL.append("\n         ,A.PK_YN_ERR_EXS ") ;
		strSQL.append("\n         ,A.PK_ORD_ERR_EXS ") ;
		strSQL.append("\n         ,A.NULL_YN_ERR_EXS ") ;
		strSQL.append("\n         ,A.DEFLT_ERR_EXS ") ;
		strSQL.append("\n         ,A.CMMT_ERR_EXS) = (SELECT CASE WHEN NVL(SRC_DATA_TYPE, '-') != NVL(TGT_DATA_TYPE, '-') THEN 'Y' ELSE NULL END AS DATA_TYPE_ERR_EXS ") ;
		strSQL.append("\n                                    ,CASE WHEN NVL(SRC_DATA_LEN, '0') != NVL(TGT_DATA_LEN, '0') THEN 'Y' ELSE NULL END AS DATA_LEN_ERR_EXS ") ;
		strSQL.append("\n                                    ,CASE WHEN NVL(SRC_DATA_PNUM, '0') != NVL(TGT_DATA_PNUM, '0') THEN 'Y' ELSE NULL END AS DATA_PNUM_ERR_EXS ") ;
		strSQL.append("\n                                    ,CASE WHEN NVL(SRC_DATA_PNT, '0') != NVL(TGT_DATA_PNT, '0') THEN 'Y' ELSE NULL END AS DATA_PNT_ERR_EXS ") ;
		strSQL.append("\n                                    ,CASE WHEN NVL(SRC_ORD, '0') != NVL(TGT_ORD, '0') THEN 'Y' ELSE NULL END AS ORD_ERR_EXS ") ;
		strSQL.append("\n                                    ,CASE WHEN NVL(SRC_PK_YN, '-') != NVL(TGT_PK_YN, '-') THEN 'Y' ELSE NULL END AS PK_YN_ERR_EXS ") ;
		strSQL.append("\n                                    ,CASE WHEN NVL(SRC_PK_ORD, '0') != NVL(TGT_PK_ORD, '0') THEN 'Y' ELSE NULL END AS PK_ORD_ERR_EXS ") ;
		strSQL.append("\n                                    ,CASE WHEN NVL(SRC_NULL_YN, '-') != NVL(TGT_NULL_YN, '-') THEN 'Y' ELSE NULL END AS NULL_YN_ERR_EXS ") ;
		strSQL.append("\n                                    ,CASE WHEN NVL(SRC_DEFLT_VAL, '-') != NVL(TGT_DEFLT_VAL, '-') THEN 'Y' ELSE NULL END AS DEFLT_ERR_EXS ") ;
		strSQL.append("\n                                    ,CASE WHEN NVL(SRC_COL_DESCN, '-') != NVL(TGT_COL_DESCN, '-') THEN 'Y' ELSE NULL END AS CMMT_ERR_EXS ") ;
		strSQL.append("\n                               FROM WAT_DBC_GAP_COL B ") ;
		strSQL.append("\n                              WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                                AND A.SRC_TBL_PNM = B.SRC_TBL_PNM ") ;
		strSQL.append("\n                                AND A.SRC_COL_PNM = B.SRC_COL_PNM ") ;
		strSQL.append("\n                                AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                                AND A.TGT_TBL_PNM = B.TGT_TBL_PNM ") ;
		strSQL.append("\n                                AND A.TGT_COL_PNM = B.TGT_COL_PNM) ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND SRC_COL_EXTNC_EXS IS NULL ") ;
		strSQL.append("\n      AND TGT_COL_EXTNC_EXS IS NULL ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  --GAP 내용 UPDATE ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_COL ") ;
		strSQL.append("\n     SET  COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,COL_ERR_DESCN = COL_ERR_DESCN || '[소스컬럼 미존재]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(SRC_COL_EXTNC_EXS, '_') = 'N' ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_COL ") ;
		strSQL.append("\n     SET  COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,COL_ERR_DESCN = COL_ERR_DESCN || '[타겟컬럼 미존재]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(TGT_COL_EXTNC_EXS, '_') = 'N' ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_COL ") ;
		strSQL.append("\n     SET  COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,COL_ERR_DESCN = COL_ERR_DESCN || '[데이터타입GAP]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(DATA_TYPE_ERR_EXS, '_') = 'Y' ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_COL ") ;
		strSQL.append("\n     SET  COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,COL_ERR_DESCN = COL_ERR_DESCN || '[데이터길이GAP]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(DATA_LEN_ERR_EXS, '_') = 'Y' ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_COL ") ;
		strSQL.append("\n     SET  COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,COL_ERR_DESCN = COL_ERR_DESCN || '[데이터자리수GAP]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(DATA_PNUM_ERR_EXS, '_') = 'Y' ") ;
		strSQL.append("\n   ; ") ;
		strSQL.append("\n   UPDATE WAT_DBC_GAP_COL ") ;
		strSQL.append("\n     SET  COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,COL_ERR_DESCN = COL_ERR_DESCN || '[데이터소수점GAP]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(DATA_PNT_ERR_EXS, '_') = 'Y' ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n   UPDATE WAT_DBC_GAP_COL ") ;
		strSQL.append("\n     SET  COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,COL_ERR_DESCN = COL_ERR_DESCN || '[컬럼순서GAP]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(ORD_ERR_EXS, '_') = 'Y' ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n   UPDATE WAT_DBC_GAP_COL ") ;
		strSQL.append("\n     SET  COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,COL_ERR_DESCN = COL_ERR_DESCN || '[PK여부GAP]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(PK_YN_ERR_EXS, '_') = 'Y' ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n   UPDATE WAT_DBC_GAP_COL ") ;
		strSQL.append("\n     SET  COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,COL_ERR_DESCN = COL_ERR_DESCN || '[PK순서GAP]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(PK_ORD_ERR_EXS, '_') = 'Y' ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n   UPDATE WAT_DBC_GAP_COL ") ;
		strSQL.append("\n     SET  COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,COL_ERR_DESCN = COL_ERR_DESCN || '[NULL여부GAP]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(NULL_YN_ERR_EXS, '_') = 'Y' ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_COL ") ;
		strSQL.append("\n     SET  COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,COL_ERR_DESCN = COL_ERR_DESCN || '[DEFAULT값 GAP]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(DEFLT_ERR_EXS, '_') = 'Y' ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_COL ") ;
		strSQL.append("\n     SET  COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,COL_ERR_DESCN = COL_ERR_DESCN || '[컬럼설명 GAP]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(CMMT_ERR_EXS, '_') = 'Y' ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  END ; ") ;

		return setExecuteUpdate_Org(strSQL.toString());
	}


	
	
	/** @return 
	 * @throws Exception */
	private int updateWatDbGapIdxErr() throws Exception {
		String srcDbSchId = dbgapInfo.get("SRC_DB_SCH_ID");
		String tgtDbSchId = dbgapInfo.get("TGT_DB_SCH_ID");
		
		logger.error("srcDbSchId : "+srcDbSchId + "  tgtDbSchId : "+tgtDbSchId);

		StringBuffer strSQL = new StringBuffer();
		strSQL.append("\n    BEGIN ");
		strSQL.append("\n  -- DB간 인덱스 GAP 초기화 ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX ") ;
		strSQL.append("\n     SET  IDX_ERR_EXS = NULL ") ;
		strSQL.append("\n           ,IDX_ERR_DESCN = NULL ") ;
		strSQL.append("\n           ,IDX_COL_ERR_EXS = NULL ") ;
		strSQL.append("\n           ,IDX_COL_ERR_DESCN = NULL ") ;
		strSQL.append("\n           ,IDX_SPAC_NM_ERR_EXS = NULL ") ;
		strSQL.append("\n           ,PK_YN_ERR_EXS = NULL ") ;
		strSQL.append("\n           ,UQ_YN_ERR_EXS = NULL ") ;
		strSQL.append("\n           ,COL_EACNT_ERR_EXS = NULL ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  -- 인덱스컬럼 GAP 인덱스 UPDATE ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX A ") ;
		strSQL.append("\n     SET  IDX_ERR_EXS = 'Y' ") ;
		strSQL.append("\n          ,IDX_COL_ERR_EXS ='Y' ") ;
		strSQL.append("\n          ,IDX_COL_ERR_DESCN = IDX_COL_ERR_DESCN|| '[소스인덱스컬럼 미존재]' ") ;
		strSQL.append("\n  WHERE A.SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n     AND A.TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n     AND NVL(A.SRC_IDX_EXTNC_EXS,'_') <> 'N' ") ;
		strSQL.append("\n     AND EXISTS (SELECT * ") ;
		strSQL.append("\n                   FROM ( SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, SRC_IDX_PNM ") ;
		strSQL.append("\n                                 ,TGT_DB_SCH_ID, TGT_TBL_PNM, TGT_IDX_PNM ") ;
		strSQL.append("\n                                 ,MAX(SRC_IDX_COL_EXTNC_EXS) AS SRC_IDX_COL_EXTNC_EXS ") ;
		strSQL.append("\n                            FROM WAT_DBC_GAP_IDX_COL ") ;
		strSQL.append("\n                           WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n                              AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                           GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, SRC_IDX_PNM ") ;
		strSQL.append("\n                                    ,TGT_DB_SCH_ID, TGT_TBL_PNM, TGT_IDX_PNM ) B ") ;
		strSQL.append("\n                  WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                    AND NVL(A.SRC_TBL_PNM, '_') = NVL(B.SRC_TBL_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(A.SRC_IDX_PNM, '_') = NVL(B.SRC_IDX_PNM, '_') ") ;
		strSQL.append("\n                    AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                    AND NVL(A.TGT_TBL_PNM, '_') = NVL(B.TGT_TBL_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(A.TGT_IDX_PNM, '_') = NVL(B.TGT_IDX_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(B.SRC_IDX_COL_EXTNC_EXS,'_') = 'N') ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX A ") ;
		strSQL.append("\n     SET  IDX_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,IDX_COL_ERR_EXS ='Y' ") ;
		strSQL.append("\n         ,IDX_COL_ERR_DESCN = IDX_COL_ERR_DESCN|| '[타겟인덱스컬럼 미존재]' ") ;
		strSQL.append("\n  WHERE A.SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n     AND A.TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n     AND NVL(A.TGT_IDX_EXTNC_EXS,'_') <> 'N' ") ;
		strSQL.append("\n     AND EXISTS (SELECT * ") ;
		strSQL.append("\n                   FROM ( SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, SRC_IDX_PNM ") ;
		strSQL.append("\n                                 ,TGT_DB_SCH_ID, TGT_TBL_PNM, TGT_IDX_PNM ") ;
		strSQL.append("\n                                 ,MAX(TGT_IDX_COL_EXTNC_EXS) AS TGT_IDX_COL_EXTNC_EXS ") ;
		strSQL.append("\n                            FROM WAT_DBC_GAP_IDX_COL ") ;
		strSQL.append("\n                           WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n                              AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                           GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, SRC_IDX_PNM ") ;
		strSQL.append("\n                                    ,TGT_DB_SCH_ID, TGT_TBL_PNM, TGT_IDX_PNM ) B ") ;
		strSQL.append("\n                  WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                    AND NVL(A.SRC_TBL_PNM, '_') = NVL(B.SRC_TBL_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(A.SRC_IDX_PNM, '_') = NVL(B.SRC_IDX_PNM, '_') ") ;
		strSQL.append("\n                    AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                    AND NVL(A.TGT_TBL_PNM, '_') = NVL(B.TGT_TBL_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(A.TGT_IDX_PNM, '_') = NVL(B.TGT_IDX_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(B.TGT_IDX_COL_EXTNC_EXS,'_') = 'N') ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX A ") ;
		strSQL.append("\n     SET  IDX_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,IDX_COL_ERR_EXS ='Y' ") ;
		strSQL.append("\n         ,IDX_COL_ERR_DESCN = IDX_COL_ERR_DESCN|| '[인덱스컬럼순서 GAP]' ") ;
		strSQL.append("\n  WHERE A.SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n     AND A.TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n     AND EXISTS (SELECT * ") ;
		strSQL.append("\n                   FROM ( SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, SRC_IDX_PNM ") ;
		strSQL.append("\n                                 ,TGT_DB_SCH_ID, TGT_TBL_PNM, TGT_IDX_PNM ") ;
		strSQL.append("\n                                 ,MAX(ORD_ERR_EXS) AS ORD_ERR_EXS ") ;
		strSQL.append("\n                            FROM WAT_DBC_GAP_IDX_COL ") ;
		strSQL.append("\n                           WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n                              AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                           GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, SRC_IDX_PNM ") ;
		strSQL.append("\n                                    ,TGT_DB_SCH_ID, TGT_TBL_PNM, TGT_IDX_PNM ) B ") ;
		strSQL.append("\n                  WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                    AND NVL(A.SRC_TBL_PNM, '_') = NVL(B.SRC_TBL_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(A.SRC_IDX_PNM, '_') = NVL(B.SRC_IDX_PNM, '_') ") ;
		strSQL.append("\n                    AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                    AND NVL(A.TGT_TBL_PNM, '_') = NVL(B.TGT_TBL_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(A.TGT_IDX_PNM, '_') = NVL(B.TGT_IDX_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(B.ORD_ERR_EXS,'N') = 'Y') ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX A ") ;
		strSQL.append("\n     SET  IDX_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,IDX_COL_ERR_EXS ='Y' ") ;
		strSQL.append("\n         ,IDX_COL_ERR_DESCN = IDX_COL_ERR_DESCN|| '[인덱스컬럼정렬유형 GAP]' ") ;
		strSQL.append("\n  WHERE A.SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n     AND A.TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n     AND EXISTS (SELECT * ") ;
		strSQL.append("\n                   FROM ( SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, SRC_IDX_PNM ") ;
		strSQL.append("\n                                 ,TGT_DB_SCH_ID, TGT_TBL_PNM, TGT_IDX_PNM ") ;
		strSQL.append("\n                                 ,MAX(SORT_TYPE_ERR_EXS) AS SORT_TYPE_ERR_EXS ") ;
		strSQL.append("\n                            FROM WAT_DBC_GAP_IDX_COL ") ;
		strSQL.append("\n                           WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n                              AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n                           GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, SRC_IDX_PNM ") ;
		strSQL.append("\n                                    ,TGT_DB_SCH_ID, TGT_TBL_PNM, TGT_IDX_PNM ) B ") ;
		strSQL.append("\n                  WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                    AND NVL(A.SRC_TBL_PNM, '_') = NVL(B.SRC_TBL_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(A.SRC_IDX_PNM, '_') = NVL(B.SRC_IDX_PNM, '_') ") ;
		strSQL.append("\n                    AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                    AND NVL(A.TGT_TBL_PNM, '_') = NVL(B.TGT_TBL_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(A.TGT_IDX_PNM, '_') = NVL(B.TGT_IDX_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(B.SORT_TYPE_ERR_EXS,'N') = 'Y') ") ;
		strSQL.append("\n  ; ") ;
//		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX A ") ;
//		strSQL.append("\n     SET  IDX_ERR_EXS = 'Y' ") ;
//		strSQL.append("\n         ,IDX_COL_ERR_EXS ='Y' ") ;
//		strSQL.append("\n         ,IDX_COL_ERR_DESCN = IDX_COL_ERR_DESCN|| '[데이터타입GAP]' ") ;
//		strSQL.append("\n  WHERE A.SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
//		strSQL.append("\n     AND A.TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
//		strSQL.append("\n     AND EXISTS (SELECT * ") ;
//		strSQL.append("\n                   FROM ( SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, SRC_IDX_PNM ") ;
//		strSQL.append("\n                                 ,TGT_DB_SCH_ID, TGT_TBL_PNM, TGT_IDX_PNM ") ;
//		strSQL.append("\n                                 ,MAX(DATA_TYPE_ERR_EXS) AS DATA_TYPE_ERR_EXS ") ;
//		strSQL.append("\n                            FROM WAT_DBC_GAP_IDX_COL ") ;
//		strSQL.append("\n                           WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
//		strSQL.append("\n                              AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
//		strSQL.append("\n                           GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, SRC_IDX_PNM ") ;
//		strSQL.append("\n                                    ,TGT_DB_SCH_ID, TGT_TBL_PNM, TGT_IDX_PNM ) B ") ;
//		strSQL.append("\n                  WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
//		strSQL.append("\n                    AND NVL(A.SRC_TBL_PNM, '_') = NVL(B.SRC_TBL_PNM, '_') ") ;
//		strSQL.append("\n                    AND NVL(A.SRC_IDX_PNM, '_') = NVL(B.SRC_IDX_PNM, '_') ") ;
//		strSQL.append("\n                    AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
//		strSQL.append("\n                    AND NVL(A.TGT_TBL_PNM, '_') = NVL(B.TGT_TBL_PNM, '_') ") ;
//		strSQL.append("\n                    AND NVL(A.TGT_IDX_PNM, '_') = NVL(B.TGT_IDX_PNM, '_') ") ;
//		strSQL.append("\n                    AND NVL(B.DATA_TYPE_ERR_EXS,'N') = 'Y') ") ;
//		strSQL.append("\n  ; ") ;
//		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX A ") ;
//		strSQL.append("\n     SET  IDX_ERR_EXS = 'Y' ") ;
//		strSQL.append("\n         ,IDX_COL_ERR_EXS ='Y' ") ;
//		strSQL.append("\n         ,IDX_COL_ERR_DESCN = IDX_COL_ERR_DESCN|| '[데이터자리수GAP]' ") ;
//		strSQL.append("\n  WHERE A.SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
//		strSQL.append("\n     AND A.TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
//		strSQL.append("\n     AND EXISTS (SELECT * ") ;
//		strSQL.append("\n                   FROM ( SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, SRC_IDX_PNM ") ;
//		strSQL.append("\n                                 ,TGT_DB_SCH_ID, TGT_TBL_PNM, TGT_IDX_PNM ") ;
//		strSQL.append("\n                                 ,MAX(DATA_PNUM_ERR_EXS) AS DATA_PNUM_ERR_EXS ") ;
//		strSQL.append("\n                            FROM WAT_DBC_GAP_IDX_COL ") ;
//		strSQL.append("\n                           WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
//		strSQL.append("\n                              AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
//		strSQL.append("\n                           GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, SRC_IDX_PNM ") ;
//		strSQL.append("\n                                    ,TGT_DB_SCH_ID, TGT_TBL_PNM, TGT_IDX_PNM ) B ") ;
//		strSQL.append("\n                  WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
//		strSQL.append("\n                    AND NVL(A.SRC_TBL_PNM, '_') = NVL(B.SRC_TBL_PNM, '_') ") ;
//		strSQL.append("\n                    AND NVL(A.SRC_IDX_PNM, '_') = NVL(B.SRC_IDX_PNM, '_') ") ;
//		strSQL.append("\n                    AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
//		strSQL.append("\n                    AND NVL(A.TGT_TBL_PNM, '_') = NVL(B.TGT_TBL_PNM, '_') ") ;
//		strSQL.append("\n                    AND NVL(A.TGT_IDX_PNM, '_') = NVL(B.TGT_IDX_PNM, '_') ") ;
//		strSQL.append("\n                    AND NVL(B.DATA_PNUM_ERR_EXS,'N') = 'Y') ") ;
//		strSQL.append("\n  ; ") ;
//		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX A ") ;
//		strSQL.append("\n     SET  IDX_ERR_EXS = 'Y' ") ;
//		strSQL.append("\n         ,IDX_COL_ERR_EXS ='Y' ") ;
//		strSQL.append("\n         ,IDX_COL_ERR_DESCN = IDX_COL_ERR_DESCN|| '[데이터길이GAP]' ") ;
//		strSQL.append("\n  WHERE A.SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
//		strSQL.append("\n     AND A.TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
//		strSQL.append("\n     AND EXISTS (SELECT * ") ;
//		strSQL.append("\n                   FROM ( SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, SRC_IDX_PNM ") ;
//		strSQL.append("\n                                 ,TGT_DB_SCH_ID, TGT_TBL_PNM, TGT_IDX_PNM ") ;
//		strSQL.append("\n                                 ,MAX(DATA_LEN_ERR_EXS) AS DATA_LEN_ERR_EXS ") ;
//		strSQL.append("\n                            FROM WAT_DBC_GAP_IDX_COL ") ;
//		strSQL.append("\n                           WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
//		strSQL.append("\n                              AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
//		strSQL.append("\n                           GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, SRC_IDX_PNM ") ;
//		strSQL.append("\n                                    ,TGT_DB_SCH_ID, TGT_TBL_PNM, TGT_IDX_PNM ) B ") ;
//		strSQL.append("\n                  WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
//		strSQL.append("\n                    AND NVL(A.SRC_TBL_PNM, '_') = NVL(B.SRC_TBL_PNM, '_') ") ;
//		strSQL.append("\n                    AND NVL(A.SRC_IDX_PNM, '_') = NVL(B.SRC_IDX_PNM, '_') ") ;
//		strSQL.append("\n                    AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
//		strSQL.append("\n                    AND NVL(A.TGT_TBL_PNM, '_') = NVL(B.TGT_TBL_PNM, '_') ") ;
//		strSQL.append("\n                    AND NVL(A.TGT_IDX_PNM, '_') = NVL(B.TGT_IDX_PNM, '_') ") ;
//		strSQL.append("\n                    AND NVL(B.DATA_LEN_ERR_EXS,'N') = 'Y') ") ;
//		strSQL.append("\n  ; ") ;
//		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX A ") ;
//		strSQL.append("\n     SET  IDX_ERR_EXS = 'Y' ") ;
//		strSQL.append("\n         ,IDX_COL_ERR_EXS ='Y' ") ;
//		strSQL.append("\n         ,IDX_COL_ERR_DESCN = IDX_COL_ERR_DESCN|| '[데이터소수점GAP]' ") ;
//		strSQL.append("\n  WHERE A.SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
//		strSQL.append("\n     AND A.TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
//		strSQL.append("\n     AND EXISTS (SELECT * ") ;
//		strSQL.append("\n                   FROM ( SELECT SRC_DB_SCH_ID, SRC_TBL_PNM, SRC_IDX_PNM ") ;
//		strSQL.append("\n                                 ,TGT_DB_SCH_ID, TGT_TBL_PNM, TGT_IDX_PNM ") ;
//		strSQL.append("\n                                 ,MAX(DATA_PNT_ERR_EXS) AS DATA_PNT_ERR_EXS ") ;
//		strSQL.append("\n                            FROM WAT_DBC_GAP_IDX_COL ") ;
//		strSQL.append("\n                           WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
//		strSQL.append("\n                              AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
//		strSQL.append("\n                           GROUP BY SRC_DB_SCH_ID, SRC_TBL_PNM, SRC_IDX_PNM ") ;
//		strSQL.append("\n                                    ,TGT_DB_SCH_ID, TGT_TBL_PNM, TGT_IDX_PNM ) B ") ;
//		strSQL.append("\n                  WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
//		strSQL.append("\n                    AND NVL(A.SRC_TBL_PNM, '_') = NVL(B.SRC_TBL_PNM, '_') ") ;
//		strSQL.append("\n                    AND NVL(A.SRC_IDX_PNM, '_') = NVL(B.SRC_IDX_PNM, '_') ") ;
//		strSQL.append("\n                    AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
//		strSQL.append("\n                    AND NVL(A.TGT_TBL_PNM, '_') = NVL(B.TGT_TBL_PNM, '_') ") ;
//		strSQL.append("\n                    AND NVL(A.TGT_IDX_PNM, '_') = NVL(B.TGT_IDX_PNM, '_') ") ;
//		strSQL.append("\n                    AND NVL(B.DATA_PNT_ERR_EXS,'N') = 'Y') ") ;
//		strSQL.append("\n  ; ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX ") ;
		strSQL.append("\n     SET IDX_ERR_EXS ='Y' ") ;
		strSQL.append("\n         ,IDX_ERR_DESCN = IDX_ERR_DESCN || '[소스인덱스 미존재]' ") ;
		strSQL.append("\n  WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n     AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n     AND NVL(SRC_IDX_EXTNC_EXS,'_') = 'N' ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX ") ;
		strSQL.append("\n     SET IDX_ERR_EXS ='Y' ") ;
		strSQL.append("\n         ,IDX_ERR_DESCN = IDX_ERR_DESCN || '[타겟인덱스 미존재]' ") ;
		strSQL.append("\n  WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n     AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n     AND NVL(TGT_IDX_EXTNC_EXS,'_') = 'N' ") ;
		strSQL.append("\n  ; ") ;
//		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX A ") ;
//		strSQL.append("\n     SET  A.IDX_ERR_EXS ='Y' ") ;
//		strSQL.append("\n         ,A.IDX_SPAC_NM_ERR_EXS = 'Y' ") ;
//		strSQL.append("\n         ,A.IDX_ERR_DESCN = A.IDX_ERR_DESCN || '[스페이스명GAP]' ") ;
//		strSQL.append("\n  WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
//		strSQL.append("\n     AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
//		strSQL.append("\n     AND EXISTS (SELECT 1 ") ;
//		strSQL.append("\n                   FROM WAT_DBC_GAP_IDX B ") ;
//		strSQL.append("\n                  WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
//		strSQL.append("\n                    AND NVL(A.SRC_TBL_PNM, '_') = NVL(B.SRC_TBL_PNM, '_') ") ;
//		strSQL.append("\n                    AND NVL(A.SRC_IDX_PNM, '_') = NVL(B.SRC_IDX_PNM, '_') ") ;
//		strSQL.append("\n                    AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
//		strSQL.append("\n                    AND NVL(A.TGT_TBL_PNM, '_') = NVL(B.TGT_TBL_PNM, '_') ") ;
//		strSQL.append("\n                    AND NVL(A.TGT_IDX_PNM, '_') = NVL(B.TGT_IDX_PNM, '_') ") ;
//		strSQL.append("\n                    AND NVL(A.SRC_IDX_SPAC_NM , '_') <> NVL(B.TGT_IDX_SPAC_NM , '_') ) ") ;
//		strSQL.append("\n     AND NVL(SRC_IDX_EXTNC_EXS,'_') <> 'N' ") ;
//		strSQL.append("\n     AND NVL(TGT_IDX_EXTNC_EXS,'_') <> 'N' ") ;
//		strSQL.append("\n  ; ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX A ") ;
		strSQL.append("\n     SET  A.IDX_ERR_EXS ='Y' ") ;
		strSQL.append("\n         ,A.PK_YN_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.IDX_ERR_DESCN = A.IDX_ERR_DESCN || '[PK여부GAP]' ") ;
		strSQL.append("\n  WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n     AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n     AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                   FROM WAT_DBC_GAP_IDX B ") ;
		strSQL.append("\n                  WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                    AND NVL(A.SRC_TBL_PNM, '_') = NVL(B.SRC_TBL_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(A.SRC_IDX_PNM, '_') = NVL(B.SRC_IDX_PNM, '_') ") ;
		strSQL.append("\n                    AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                    AND NVL(A.TGT_TBL_PNM, '_') = NVL(B.TGT_TBL_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(A.TGT_IDX_PNM, '_') = NVL(B.TGT_IDX_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(A.SRC_PK_YN , '_') <> NVL(B.TGT_PK_YN , '_') ) ") ;
		strSQL.append("\n     AND NVL(SRC_IDX_EXTNC_EXS,'_') <> 'N' ") ;
		strSQL.append("\n     AND NVL(TGT_IDX_EXTNC_EXS,'_') <> 'N' ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX A ") ;
		strSQL.append("\n     SET  A.IDX_ERR_EXS ='Y' ") ;
		strSQL.append("\n         ,A.UQ_YN_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.IDX_ERR_DESCN = A.IDX_ERR_DESCN || '[유니크여부GAP]' ") ;
		strSQL.append("\n  WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n     AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n     AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                   FROM WAT_DBC_GAP_IDX B ") ;
		strSQL.append("\n                  WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                    AND NVL(A.SRC_TBL_PNM, '_') = NVL(B.SRC_TBL_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(A.SRC_IDX_PNM, '_') = NVL(B.SRC_IDX_PNM, '_') ") ;
		strSQL.append("\n                    AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                    AND NVL(A.TGT_TBL_PNM, '_') = NVL(B.TGT_TBL_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(A.TGT_IDX_PNM, '_') = NVL(B.TGT_IDX_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(A.SRC_UQ_YN , '_') <> NVL(B.TGT_UQ_YN , '_') ) ") ;
		strSQL.append("\n     AND NVL(SRC_IDX_EXTNC_EXS,'_') <> 'N' ") ;
		strSQL.append("\n     AND NVL(TGT_IDX_EXTNC_EXS,'_') <> 'N' ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX A ") ;
		strSQL.append("\n     SET  A.IDX_ERR_EXS ='Y' ") ;
		strSQL.append("\n         ,A.COL_EACNT_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,A.IDX_ERR_DESCN = A.IDX_ERR_DESCN || '[인덱스컬럼갯수GAP]' ") ;
		strSQL.append("\n  WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n     AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n     AND EXISTS (SELECT 1 ") ;
		strSQL.append("\n                   FROM WAT_DBC_GAP_IDX B ") ;
		strSQL.append("\n                  WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                    AND NVL(A.SRC_TBL_PNM, '_') = NVL(B.SRC_TBL_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(A.SRC_IDX_PNM, '_') = NVL(B.SRC_IDX_PNM, '_') ") ;
		strSQL.append("\n                    AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                    AND NVL(A.TGT_TBL_PNM, '_') = NVL(B.TGT_TBL_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(A.TGT_IDX_PNM, '_') = NVL(B.TGT_IDX_PNM, '_') ") ;
		strSQL.append("\n                    AND NVL(A.SRC_COL_EACNT , '0') <> NVL(B.TGT_COL_EACNT , '0') ) ") ;
		strSQL.append("\n     AND NVL(SRC_IDX_EXTNC_EXS,'_') <> 'N' ") ;
		strSQL.append("\n     AND NVL(TGT_IDX_EXTNC_EXS,'_') <> 'N' ") ;
		strSQL.append("\n  ; ") ;

		strSQL.append("\n    END; ");

		return setExecuteUpdate_Org(strSQL.toString());
	}
	

	
	/** @return 
	 * @throws Exception */
	private int updateWatDbGapIdxColErr() throws Exception {
		String srcDbSchId = dbgapInfo.get("SRC_DB_SCH_ID");
		String tgtDbSchId = dbgapInfo.get("TGT_DB_SCH_ID");
		
		logger.error("srcDbSchId : "+srcDbSchId + "  tgtDbSchId : "+tgtDbSchId);
		
		StringBuffer strSQL = new StringBuffer();
		strSQL.append("\n  BEGIN ") ;
		strSQL.append("\n  -- DB간 인덱스 컬럼 GAP 초기화 ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX_COL ") ;
		strSQL.append("\n     SET  IDX_COL_ERR_EXS = NULL ") ;
		strSQL.append("\n         ,IDX_COL_ERR_DESCN = NULL ") ;
		strSQL.append("\n         ,ORD_ERR_EXS = NULL ") ;
		strSQL.append("\n         ,SORT_TYPE_ERR_EXS = NULL ") ;
		strSQL.append("\n         ,DATA_TYPE_ERR_EXS = NULL ") ;
		strSQL.append("\n         ,DATA_LEN_ERR_EXS = NULL ") ;
		strSQL.append("\n         ,DATA_PNUM_ERR_EXS = NULL ") ;
		strSQL.append("\n         ,DATA_PNT_ERR_EXS = NULL ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  -- GAP UPDATE ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX_COL A ") ;
		strSQL.append("\n     SET (A.ORD_ERR_EXS ") ;
		strSQL.append("\n         ,A.SORT_TYPE_ERR_EXS ") ;
		strSQL.append("\n         ,A.DATA_TYPE_ERR_EXS ") ;
		strSQL.append("\n         ,A.DATA_LEN_ERR_EXS ") ;
		strSQL.append("\n         ,A.DATA_PNUM_ERR_EXS ") ;
		strSQL.append("\n         ,A.DATA_PNT_ERR_EXS ") ;
		strSQL.append("\n         ) = (SELECT CASE WHEN NVL(SRC_ORD, '0') != NVL(TGT_ORD, '0') THEN 'Y' ELSE NULL END AS ORD_ERR_EXS ") ;
		strSQL.append("\n                    ,CASE WHEN NVL(SRC_SORT_TYPE, '-') != NVL(TGT_SORT_TYPE, '-') THEN 'Y' ELSE NULL END AS SORT_TYPE_ERR_EXS ") ;
		strSQL.append("\n                    ,CASE WHEN NVL(SRC_DATA_TYPE, '-') != NVL(TGT_DATA_TYPE, '-') THEN 'Y' ELSE NULL END AS DATA_TYPE_ERR_EXS ") ;
		strSQL.append("\n                    ,CASE WHEN NVL(SRC_DATA_LEN, '0') != NVL(TGT_DATA_LEN, '0') THEN 'Y' ELSE NULL END AS DATA_LEN_ERR_EXS ") ;
		strSQL.append("\n                    ,CASE WHEN NVL(SRC_DATA_PNUM, '0') != NVL(TGT_DATA_PNUM, '0') THEN 'Y' ELSE NULL END AS DATA_PNUM_ERR_EXS ") ;
		strSQL.append("\n                    ,CASE WHEN NVL(SRC_DATA_PNT, '0') != NVL(TGT_DATA_PNT, '0') THEN 'Y' ELSE NULL END AS DATA_PNT_ERR_EXS ") ;
		strSQL.append("\n               FROM WAT_DBC_GAP_IDX_COL B ") ;
		strSQL.append("\n              WHERE A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID ") ;
		strSQL.append("\n                AND A.SRC_TBL_PNM = B.SRC_TBL_PNM ") ;
		strSQL.append("\n                AND A.SRC_IDX_PNM = B.SRC_IDX_PNM ") ;
		strSQL.append("\n                AND A.SRC_IDX_COL_PNM = B.SRC_IDX_COL_PNM ") ;
		strSQL.append("\n                AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID ") ;
		strSQL.append("\n                AND A.TGT_TBL_PNM = B.TGT_TBL_PNM ") ;
		strSQL.append("\n                AND A.TGT_IDX_PNM = B.TGT_IDX_PNM ") ;
		strSQL.append("\n                AND A.TGT_IDX_COL_PNM = B.TGT_IDX_COL_PNM) ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND SRC_IDX_COL_EXTNC_EXS IS NULL ") ;
		strSQL.append("\n      AND TGT_IDX_COL_EXTNC_EXS IS NULL ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  --GAP 내용 UPDATE ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX_COL ") ;
		strSQL.append("\n     SET  IDX_COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,IDX_COL_ERR_DESCN = IDX_COL_ERR_DESCN || '[소스인덱스컬럼 미존재]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(SRC_IDX_COL_EXTNC_EXS, '_') = 'N' ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX_COL ") ;
		strSQL.append("\n     SET  IDX_COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,IDX_COL_ERR_DESCN = IDX_COL_ERR_DESCN || '[타겟인덱스컬럼 미존재]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(TGT_IDX_COL_EXTNC_EXS, '_') = 'N' ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX_COL ") ;
		strSQL.append("\n     SET  IDX_COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,IDX_COL_ERR_DESCN = IDX_COL_ERR_DESCN || '[인덱스컬럼순서GAP]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(ORD_ERR_EXS, '_') = 'Y' ") ;
		strSQL.append("\n  ; ") ;
		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX_COL ") ;
		strSQL.append("\n     SET  IDX_COL_ERR_EXS = 'Y' ") ;
		strSQL.append("\n         ,IDX_COL_ERR_DESCN = IDX_COL_ERR_DESCN || '[인덱스정렬유형GAP]' ") ;
		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
		strSQL.append("\n      AND NVL(SORT_TYPE_ERR_EXS, '_') = 'Y' ") ;
		strSQL.append("\n  ; ") ;
//		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX_COL ") ;
//		strSQL.append("\n     SET  IDX_COL_ERR_EXS = 'Y' ") ;
//		strSQL.append("\n         ,IDX_COL_ERR_DESCN = IDX_COL_ERR_DESCN || '[데이터타입GAP]' ") ;
//		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
//		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
//		strSQL.append("\n      AND NVL(DATA_TYPE_ERR_EXS, '_') = 'Y' ") ;
//		strSQL.append("\n  ; ") ;
//		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX_COL ") ;
//		strSQL.append("\n     SET  IDX_COL_ERR_EXS = 'Y' ") ;
//		strSQL.append("\n         ,IDX_COL_ERR_DESCN =IDX_COL_ERR_DESCN || '[데이터길이GAP]' ") ;
//		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
//		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
//		strSQL.append("\n      AND NVL(DATA_LEN_ERR_EXS, '_') = 'Y' ") ;
//		strSQL.append("\n  ; ") ;
//		strSQL.append("\n  UPDATE WAT_DBC_GAP_IDX_COL ") ;
//		strSQL.append("\n     SET  IDX_COL_ERR_EXS = 'Y' ") ;
//		strSQL.append("\n         ,IDX_COL_ERR_DESCN = IDX_COL_ERR_DESCN || '[데이터자리수GAP]' ") ;
//		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
//		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
//		strSQL.append("\n      AND NVL(DATA_PNUM_ERR_EXS, '_') = 'Y' ") ;
//		strSQL.append("\n   ; ") ;
//		strSQL.append("\n   UPDATE WAT_DBC_GAP_IDX_COL ") ;
//		strSQL.append("\n     SET  IDX_COL_ERR_EXS = 'Y' ") ;
//		strSQL.append("\n         ,IDX_COL_ERR_DESCN = IDX_COL_ERR_DESCN || '[데이터소수점GAP]' ") ;
//		strSQL.append("\n   WHERE SRC_DB_SCH_ID =  '").append(srcDbSchId).append("' ");
//		strSQL.append("\n      AND TGT_DB_SCH_ID =  '").append(tgtDbSchId).append("' ");
//		strSQL.append("\n      AND NVL(DATA_PNT_ERR_EXS, '_') = 'Y' ") ;
//		strSQL.append("\n  ; ") ;
		strSQL.append("\n  END ") ;
		strSQL.append("\n  ; ") ;

		return setExecuteUpdate_Org(strSQL.toString());
	}


	
	/**
	 * 타겟데이터의 SQL을 받아 저장한다.
	 * @param String 저장 SQL
	 * @return boolean 저장결과값
	 * @throws SQLException
	 */
	private int setExecuteUpdate_Org(String query_tgt) throws Exception
	{
		logger.debug(query_tgt);
		pst_org = con.prepareStatement(query_tgt);

		int cnt = pst_org.executeUpdate();

		pst_org.close();

		return cnt;
	}

}
