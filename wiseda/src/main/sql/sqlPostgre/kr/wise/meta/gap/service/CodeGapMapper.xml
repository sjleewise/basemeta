<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="kr.wise.meta.gap.service.CodeGapMapper" >
<resultMap id="BaseResultMap" type="kr.wise.meta.gap.service.CodeGapVO" extends="kr.wise.commons.cmm.service.CommonMapper.BaseResultMap">
	<id column="GAP_STATUS" property="gapStatus" jdbcType="VARCHAR" />
    <result column="DB_CONN_TRG_ID" property="dbConnTrgId" jdbcType="VARCHAR" />
    <result column="DB_CONN_TRG_LNM" property="dbConnTrgLnm" jdbcType="VARCHAR" />
    <result column="DB_SCH_ID" property="dbSchId" jdbcType="VARCHAR" />
    <result column="DB_SCH_LNM" property="dbSchLnm" jdbcType="VARCHAR" />
    <result column="CODE_PNM" property="codePnm" jdbcType="VARCHAR" />
    <result column="CODE_LNM" property="codeLnm" jdbcType="VARCHAR" />
    <result column="CODE_ID" property="codeId" jdbcType="VARCHAR" />
    <result column="CODE_TYP_CD" property="codeTypCd" jdbcType="VARCHAR" />
    <result column="CODE_TBL" property="codeTbl" jdbcType="VARCHAR" />
    <result column="CODE_COL" property="codeCol" jdbcType="VARCHAR" />
    <result column="CODE_DESCN" property="codeDescn" jdbcType="VARCHAR" />
    <result column="CODE_EACNT" property="codeEacnt" jdbcType="VARCHAR" />
    <result column="CODE_ERR_DESCN" property="codeErrDescn" jdbcType="VARCHAR" />
    <result column="CODE_VAL_ERR_DESCN" property="codeValErrDescn" jdbcType="VARCHAR" />
    <result column="DMN_ID" property="dmnId" jdbcType="VARCHAR" />
    <result column="DMN_PNM" property="dmnPnm" jdbcType="VARCHAR" />
    <result column="DMN_LNM" property="dmnLnm" jdbcType="VARCHAR" />
    <result column="CD_VAL_IVW_CD" property="cdValIvwCd" jdbcType="VARCHAR" />
    <result column="LST_ENTY_PNM" property="lstEntyPnm" jdbcType="VARCHAR" />
    <result column="LST_ATTR_PNM" property="lstAttrPnm" jdbcType="VARCHAR" />
    <result column="DMN_ERR_DESCN" property="dmnErrDescn" jdbcType="VARCHAR" />
    <result column="DMN_VAL_ERR_DESCN" property="dmnValErrDescn" jdbcType="VARCHAR" />
    
    <result column="CODE_VAL_PNM" property="codeValPnm" jdbcType="VARCHAR" />
    <result column="CODE_VAL_LNM" property="codeValLnm" jdbcType="VARCHAR" />
    <result column="CODE_VAL" property="codeVal" jdbcType="VARCHAR" />
    <result column="CODE_VAL_ID" property="codeValId" jdbcType="VARCHAR" />
    <result column="CODE_VAL_ORD" property="codeValOrd" jdbcType="VARCHAR" />
    <result column="CODE_VAL_USE_YN" property="codeValUseYn" jdbcType="VARCHAR" />
    <result column="CODE_VAL_DESCN" property="codeValDescn" jdbcType="VARCHAR" />
    
    
    <result column="CD_VAL_ID" property="cdValId" jdbcType="VARCHAR" />
    <result column="CD_VAL" property="cdVal" jdbcType="VARCHAR" />
    <result column="CD_VAL_NM" property="cdValNm" jdbcType="VARCHAR" />
    <result column="DISP_ORD" property="dispOrd" jdbcType="VARCHAR" />
    <result column="DB_CONN_TRG_PNM" property="dbConnTrgPnm" jdbcType="VARCHAR" />
    <result column="DB_SCH_PNM" property="dbSchPnm"	jdbcType="VARCHAR" />
    <result column="TGT_DB_CONN_TRG_PNM" property="tgtDbConnTrgPnm" jdbcType="VARCHAR" />
    <result column="TGT_DB_SCH_PNM" property="tgtDbSchPnm"	jdbcType="VARCHAR" />        
    <result column="SMPL_LCCD" property="lccd"  jdbcType="VARCHAR" />    
    <result column="SMPL_MCCD" property="mccd"  jdbcType="VARCHAR" />  
    <result column="SMPL_SCCD" property="sccd"  jdbcType="VARCHAR" />  
    <result column="SMPL_LCCD_NM" property="lclsNm"  jdbcType="VARCHAR" />   
    <result column="SMPL_MCCD_NM" property="mdcdNm"  jdbcType="VARCHAR" />   
    <result column="SMPL_SCCD_NM" property="sclsNm"  jdbcType="VARCHAR" />   
    <result column="USE_YN" property="useYn"  jdbcType="VARCHAR" />   
    <result column="ETC_CD1" property="etc1"  jdbcType="VARCHAR" />      
    <result column="ETC_CD2" property="etcNm1"  jdbcType="VARCHAR" />      
    <result column="ETC_CD3" property="etc2"  jdbcType="VARCHAR" />      
    <result column="ETC_CD4" property="etcNm2"  jdbcType="VARCHAR" />      
    <result column="ETC_CD5" property="etc3"  jdbcType="VARCHAR" />      
    <result column="ETC_CD_NM1" property="etcNm3"  jdbcType="VARCHAR" />      
    <result column="ETC_CD_NM2" property="etc4"  jdbcType="VARCHAR" />      
    <result column="ETC_CD_NM3" property="etcNm4"  jdbcType="VARCHAR" />     
    <result column="ETC_CD_NM4" property="etc5"  jdbcType="VARCHAR" />     
    <result column="ETC_CD_NM5" property="etcNm5"  jdbcType="VARCHAR" />     
    <result column="RMRK_CNTN" property="rmrkCntn"  jdbcType="VARCHAR" />     
    <result column="CD_OUTL_CNTN1" property="outlCntn1"  jdbcType="VARCHAR" />     
    <result column="CD_OUTL_CNTN2" property="outlCntn2"  jdbcType="VARCHAR" />                      
    <result column="TGT_SMPL_LCCD" property="tgtLccd"  jdbcType="VARCHAR" />     
    <result column="TGT_SMPL_MCCD" property="tgtMccd"  jdbcType="VARCHAR" />     
    <result column="TGT_SMPL_SCCD" property="tgtSccd"  jdbcType="VARCHAR" />     
    <result column="TGT_SMPL_LCCD_NM" property="tgtLclsNm"  jdbcType="VARCHAR" />     
    <result column="TGT_SMPL_MCCD_NM" property="tgtMdcdNm"  jdbcType="VARCHAR" />     
    <result column="TGT_SMPL_SCCD_NM" property="tgtSclsNm"  jdbcType="VARCHAR" />     
    <result column="TGT_USE_YN" property="tgtUseYn"  jdbcType="VARCHAR" />     
    <result column="TGT_DISP_ORD" property="tgtDispOrd"  jdbcType="VARCHAR" />     
    <result column="TGT_ETC_CD1" property="tgtEtc1"  jdbcType="VARCHAR" />     
    <result column="TGT_ETC_CD2" property="tgtEtcNm1" jdbcType="VARCHAR" />     
    <result column="TGT_ETC_CD3" property="tgtEtc2" jdbcType="VARCHAR" />     
    <result column="TGT_ETC_CD4" property="tgtEtcNm2" jdbcType="VARCHAR" />     
    <result column="TGT_ETC_CD5" property="tgtEtc3" jdbcType="VARCHAR" />     
    <result column="TGT_ETC_CD_NM1" property="tgtEtcNm3" jdbcType="VARCHAR" />     
    <result column="TGT_ETC_CD_NM2" property="tgtEtc4" jdbcType="VARCHAR" />     
    <result column="TGT_ETC_CD_NM3" property="tgtEtcNm4" jdbcType="VARCHAR" />     
    <result column="TGT_ETC_CD_NM4" property="tgtEtc5" jdbcType="VARCHAR" />     
    <result column="TGT_ETC_CD_NM5" property="tgtEtcNm5" jdbcType="VARCHAR" />     
    <result column="TGT_RMRK_CNTN" property="tgtRmrkCntn" jdbcType="VARCHAR" />     
    <result column="TGT_CD_OUTL_CNTN1" property="tgtOutlCntn1" jdbcType="VARCHAR" />    
    <result column="TGT_CD_OUTL_CNTN2" property="tgtOutlCntn2" jdbcType="VARCHAR" />    
    <result column="TGT_CD_VAL_ID"  property="tgtCdValId"   jdbcType="VARCHAR" />    
    <result column="UPP_CD_VAL"  property="uppCdVal"   jdbcType="VARCHAR" />
    <result column="CODE_LEVEL"  property="codeLevel"   jdbcType="VARCHAR" />
    <result column="TGT_CD_VAL"  property="tgtCdVal"   jdbcType="VARCHAR" />
    <result column="TGT_UPP_CD_VAL"  property="tgtUppCdVal"   jdbcType="VARCHAR" />
    <result column="TGT_CD_VAL_NM"  property="tgtCdValNm"   jdbcType="VARCHAR" />
    <result column="TGT_CODE_LEVEL"  property="tgtCodeLevel"   jdbcType="VARCHAR" />
</resultMap>
	<select id="getCodeGapAnalyze" parameterType="kr.wise.meta.gap.service.CodeGapVO" resultMap="BaseResultMap">
		SELECT A.*
		     , CASE WHEN A.GAP_STATUS = 'GAP' THEN '#FF0000' END AS FontColor
		  FROM (
		        SELECT A.*
		             , DB.DB_CONN_TRG_LNM
		             , S.DB_SCH_LNM
		             , B.DMN_PNM
		             , B.DMN_LNM
		             , B.CD_VAL_IVW_CD
		             , B.LST_ENTY_PNM
		             , B.LST_ATTR_PNM
		             , CASE WHEN A.CODE_ERR_EXS = 'Y' THEN 'GAP'
		               ELSE CASE WHEN A.DMN_ERR_EXS = 'Y' THEN 'GAP'
		               ELSE CASE WHEN A.CODE_VAL_ERR_EXS = 'Y' THEN 'GAP'
		               ELSE CASE WHEN A.DMN_VAL_ERR_EXS = 'Y' THEN 'GAP'
		               ELSE 'NML' END END END END AS GAP_STATUS
		               
		          FROM WAT_CODE A
		          LEFT OUTER JOIN WAM_DMN B
		            ON A.DMN_ID = B.DMN_ID
		           AND B.REG_TYP_CD IN ('C', 'U')
		          LEFT OUTER JOIN WAA_DB_CONN_TRG DB
		            ON A.DB_CONN_TRG_ID = DB.DB_CONN_TRG_ID
		           AND DB.REG_TYP_CD IN ('C', 'U')
		           AND DB.EXP_DTM = TO_DATE('9999-12-31', 'YYYY-MM-DD')
		          LEFT OUTER JOIN WAA_DB_SCH S
		            ON A.DB_SCH_ID = S.DB_SCH_ID
		           AND S.EXP_DTM = TO_DATE('9999-12-31', 'YYYY-MM-DD')
		           AND S.REG_TYP_CD IN ('C', 'U')
		        ) A
		        
		 <where>
		   <if test="gapStatus != null">
		   AND A.GAP_STATUS = #{gapStatus,jdbcType=VARCHAR}
		   </if>
		   <if test="dbConnTrgId != null">
		   AND A.DB_CONN_TRG_ID = #{dbConnTrgId,jdbcType=VARCHAR}
		   </if>
		   <if test="dbSchId != null">
		   AND A.DB_SCH_ID = #{dbSchId,jdbcType=VARCHAR}
		   </if>
		   <if test="codePnm != null">
		   AND (A.CODE_LNM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.CODE_PNM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%')
		   </if>
		   <if test="codeVal != null">
		   AND EXISTS ( SELECT 1
		   				  FROM WAT_CODE_VAL B
		   				 WHERE B.CODE_PNM = A.CODE_PNM
		   				   AND B.DB_CONN_TRG_ID = A.DB_CONN_TRG_ID
		   				   AND B.DB_SCH_ID = A.DB_SCH_ID
		   				   AND (B.CODE_VAL = #{codeVal,jdbcType=VARCHAR}
		   				   		OR B.CODE_VAL_LNM = #{codeVal,jdbcType=VARCHAR} )
		   			  )
		   
		   </if>
		 </where>
		 ORDER BY A.CODE_PNM
	</select>
	
	<select id="getCodeValList" parameterType="kr.wise.meta.gap.service.CodeGapVO" resultMap="BaseResultMap">
	SELECT A.*
	     , DB.DB_CONN_TRG_LNM
	     , S.DB_SCH_LNM
	     , CASE WHEN CD.CD_VAL IS NULL THEN '#FF0000' END AS FontColor
	  FROM WAT_CODE_VAL A
	 INNER JOIN WAT_CODE B
	    ON A.DB_CONN_TRG_ID = B.DB_CONN_TRG_ID
	   AND A.DB_SCH_ID = B.DB_SCH_ID
	   AND A.CODE_PNM = B.CODE_PNM
	 INNER JOIN WAA_DB_CONN_TRG DB
	    ON A.DB_CONN_TRG_ID = DB.DB_CONN_TRG_ID
	   AND DB.REG_TYP_CD IN ('C', 'U')
	   AND DB.EXP_DTM = TO_DATE('9999-12-31', 'YYYY-MM-DD')
	 INNER JOIN WAA_DB_SCH S
	    ON A.DB_SCH_ID = S.DB_SCH_ID
	   AND S.REG_TYP_CD IN ('C', 'U')
	   AND S.EXP_DTM = TO_DATE('9999-12-31', 'YYYY-MM-DD')
	  LEFT OUTER JOIN WAM_CD_VAL CD
	    ON A.CODE_VAL = CD.CD_VAL
	   AND CD.REG_TYP_CD IN ('C', 'U')
	   AND A.DMN_ID = CD.DMN_ID
	 
	 <where>
	 	AND A.DB_CONN_TRG_ID = #{dbConnTrgId,jdbcType=VARCHAR}
	 	AND A.DB_SCH_ID = #{dbSchId,jdbcType=VARCHAR}
	 	AND A.CODE_PNM = #{codePnm,jdbcType=VARCHAR}
	 </where>
	 ORDER BY A.CODE_VAL_ORD
	</select>
	
	<select id="getDmnValList" parameterType="kr.wise.meta.gap.service.CodeGapVO" resultMap="BaseResultMap">
	SELECT A.*
		 , B.DMN_LNM
		 , B.DMN_PNM
	     , CASE WHEN C.CODE_VAL IS NULL THEN '#FF0000' END AS FontColor
	  FROM WAM_CD_VAL A
	 INNER JOIN WAM_DMN B
	    ON A.DMN_ID = B.DMN_ID
	   AND B.REG_TYP_CD IN ('C', 'U')
	  LEFT OUTER JOIN WAT_CODE_VAL C
	    ON A.CD_VAL = C.CODE_VAL
	   AND A.DMN_ID = C.DMN_ID
	<where>
	   AND A.DMN_ID = #{dmnId,jdbcType=VARCHAR}
	   AND A.REG_TYP_CD IN ('C', 'U')
	</where>
	ORDER BY A.DISP_ORD
	</select>
	
<select id="selectCodeGapMetaDev" parameterType="kr.wise.meta.gap.service.CodeGapVO" resultMap="BaseResultMap">
SELECT B.DMN_ID
       ,B.DMN_LNM
       ,B.DMN_PNM
       ,T.DB_CONN_TRG_PNM AS TGT_DB_CONN_TRG_PNM
       ,T.DB_CONN_TRG_ID
       ,S.DB_SCH_PNM      AS TGT_DB_SCH_PNM
       ,S.DB_SCH_ID
       ,A.*
		     , CASE WHEN A.GAP_STATUS = 'GAP' THEN '#FF0000' END AS FontColor
		  FROM (
		        SELECT CASE WHEN    COALESCE(A.SMPL_LCCD_NM  ,'-')   != COALESCE(B.SMPL_LCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_MCCD_NM  ,'-')   != COALESCE(B.SMPL_MCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_SCCD_NM  ,'-')   != COALESCE(B.SMPL_SCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_CD_STS_YN,'N')   != COALESCE(B.SMPL_CD_STS_YN  ,'N')         
                                 OR COALESCE(A.ETC_CD1       ,'-')   != COALESCE(B.ETC_CD1         ,'-')         
                                 OR COALESCE(A.ETC_CD2       ,'-')   != COALESCE(B.ETC_CD2         ,'-')         
                                 OR COALESCE(A.ETC_CD3       ,'-')   != COALESCE(B.ETC_CD3         ,'-')         
                                 OR COALESCE(A.ETC_CD4       ,'-')   != COALESCE(B.ETC_CD4         ,'-')         
                                 OR COALESCE(A.ETC_CD5       ,'-')   != COALESCE(B.ETC_CD5         ,'-')         
                                 OR COALESCE(A.ETC_CD_NM1    ,'-')   != COALESCE(B.ETC_CD_NM1      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM2    ,'-')   != COALESCE(B.ETC_CD_NM2      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM3    ,'-')   != COALESCE(B.ETC_CD_NM3      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM4    ,'-')   != COALESCE(B.ETC_CD_NM4      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM5    ,'-')   != COALESCE(B.ETC_CD_NM5      ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN1 ,'-')   != COALESCE(B.CD_OUTL_CNTN1   ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN2 ,'-')   != COALESCE(B.CD_OUTL_CNTN2   ,'-')         
                                 OR COALESCE(A.ARY_SQNC_NO   ,0  )   != COALESCE(B.ARY_SQNC_NO     ,0  )         
                                 OR COALESCE(A.RMRK_CNTN     ,'-')   != COALESCE(B.RMRK_CNTN       ,'-')  THEN 'GAP'  
		                 ELSE 'NML' END AS GAP_STATUS
		                 ,CASE WHEN A.SMPL_LCCD IS NULL THEN '[메타단순코드미존재]'
                               WHEN B.SMPL_LCCD IS NULL THEN '[개발단순코드미존재]'
                               WHEN    COALESCE(A.SMPL_LCCD_NM  ,'-')   != COALESCE(B.SMPL_LCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_MCCD_NM  ,'-')   != COALESCE(B.SMPL_MCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_SCCD_NM  ,'-')   != COALESCE(B.SMPL_SCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_CD_STS_YN,'N')   != COALESCE(B.SMPL_CD_STS_YN  ,'N')         
                                 OR COALESCE(A.ETC_CD1       ,'-')   != COALESCE(B.ETC_CD1         ,'-')         
                                 OR COALESCE(A.ETC_CD2       ,'-')   != COALESCE(B.ETC_CD2         ,'-')         
                                 OR COALESCE(A.ETC_CD3       ,'-')   != COALESCE(B.ETC_CD3         ,'-')         
                                 OR COALESCE(A.ETC_CD4       ,'-')   != COALESCE(B.ETC_CD4         ,'-')         
                                 OR COALESCE(A.ETC_CD5       ,'-')   != COALESCE(B.ETC_CD5         ,'-')         
                                 OR COALESCE(A.ETC_CD_NM1    ,'-')   != COALESCE(B.ETC_CD_NM1      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM2    ,'-')   != COALESCE(B.ETC_CD_NM2      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM3    ,'-')   != COALESCE(B.ETC_CD_NM3      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM4    ,'-')   != COALESCE(B.ETC_CD_NM4      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM5    ,'-')   != COALESCE(B.ETC_CD_NM5      ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN1 ,'-')   != COALESCE(B.CD_OUTL_CNTN1   ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN2 ,'-')   != COALESCE(B.CD_OUTL_CNTN2   ,'-')         
                                 OR COALESCE(A.ARY_SQNC_NO   ,0  )   != COALESCE(B.ARY_SQNC_NO     ,0  )         
                                 OR COALESCE(A.RMRK_CNTN     ,'-')   != COALESCE(B.RMRK_CNTN       ,'-')  THEN '[코드GAP존재]'
		                 ELSE NULL END AS GAP_CONTS  
		               ,COALESCE(A.SMPL_LCCD, B.SMPL_LCCD) SMPL_LCCD                          
                       , A.SMPL_MCCD                           
                       , A.SMPL_SCCD                           
                       , A.SMPL_LCCD_NM                        
                       , A.SMPL_MCCD_NM                        
                       , A.SMPL_SCCD_NM                        
                       , A.SMPL_CD_STS_YN AS USE_YN                     
                       , A.ETC_CD1                             
                       , A.ETC_CD2                             
                       , A.ETC_CD3                             
                       , A.ETC_CD4                             
                       , A.ETC_CD5                             
                       , A.ETC_CD_NM1                          
                       , A.ETC_CD_NM2                          
                       , A.ETC_CD_NM3                          
                       , A.ETC_CD_NM4                          
                       , A.ETC_CD_NM5                          
                       , A.CD_OUTL_CNTN1                       
                       , A.CD_OUTL_CNTN2                       
                       , A.ARY_SQNC_NO     AS DISP_ORD                      
                       , A.RMRK_CNTN       
                       , B.SMPL_LCCD       TGT_SMPL_LCCD       
                       , B.SMPL_MCCD       TGT_SMPL_MCCD       
                       , B.SMPL_SCCD       TGT_SMPL_SCCD       
                       , B.SMPL_LCCD_NM    TGT_SMPL_LCCD_NM    
                       , B.SMPL_MCCD_NM    TGT_SMPL_MCCD_NM    
                       , B.SMPL_SCCD_NM    TGT_SMPL_SCCD_NM    
                       , B.SMPL_CD_STS_YN  TGT_USE_YN
                       , B.ETC_CD1         TGT_ETC_CD1         
                       , B.ETC_CD2         TGT_ETC_CD2         
                       , B.ETC_CD3         TGT_ETC_CD3         
                       , B.ETC_CD4         TGT_ETC_CD4         
                       , B.ETC_CD5         TGT_ETC_CD5         
                       , B.ETC_CD_NM1      TGT_ETC_CD_NM1      
                       , B.ETC_CD_NM2      TGT_ETC_CD_NM2      
                       , B.ETC_CD_NM3      TGT_ETC_CD_NM3      
                       , B.ETC_CD_NM4      TGT_ETC_CD_NM4      
                       , B.ETC_CD_NM5      TGT_ETC_CD_NM5      
                       , B.CD_OUTL_CNTN1   TGT_CD_OUTL_CNTN1   
                       , B.CD_OUTL_CNTN2   TGT_CD_OUTL_CNTN2   
                       , B.ARY_SQNC_NO     TGT_DISP_ORD     
                       , B.RMRK_CNTN       TGT_RMRK_CNTN   
                       ,'MRSDBD' AS DB_CONN_TRG_PNM
                       ,'MRS_OWN' AS DB_SCH_PNM
                       FROM V_SIMPLE_CD_LIST A
                       FULL OUTER JOIN WAT_SMP_CD B
                       ON A.SMPL_LCCD = B.SMPL_LCCD
                       AND COALESCE(A.SMPL_MCCD,'-') =COALESCE(B.SMPL_MCCD,'-')
                       AND A.SMPL_SCCD = B.SMPL_SCCD
		        ) A
                LEFT OUTER JOIN WAM_DMN B
                ON A.SMPL_LCCD = B.DMN_DSCD
                LEFT OUTER JOIN WAA_DB_SCH S
                ON A.DB_SCH_PNM =S.DB_SCH_PNM
                AND S.REG_TYP_CD IN ('C', 'U')
                AND S.EXP_DTM = TO_DATE('99991231', 'YYYYMMDD')
                AND S.DDL_TRG_DCD ='D'
                LEFT OUTER JOIN WAA_DB_CONN_TRG T
                ON A.DB_CONN_TRG_PNM =T.DB_CONN_TRG_PNM
                AND T.DB_CONN_TRG_ID = S.DB_CONN_TRG_ID
                AND T.REG_TYP_CD IN ('C', 'U')
                AND T.EXP_DTM = TO_DATE('99991231', 'YYYYMMDD')
		 <where>
		   <if test="gapStatus != null">
		   AND A.GAP_STATUS = #{gapStatus,jdbcType=VARCHAR}
		   </if>
		   <if test="dbConnTrgId != null">
		   AND T.DB_CONN_TRG_ID = #{dbConnTrgId,jdbcType=VARCHAR}
		   </if>
		   <if test="dbSchId != null">
		   AND S.DB_SCH_ID = #{dbSchId,jdbcType=VARCHAR}
		   </if>
		   <if test="codePnm != null">
		   AND (   A.SMPL_LCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_MCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_SCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_LCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_MCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_SCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_LCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_MCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_SCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_LCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_MCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_SCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		)
		   </if>
		   <if test="dmnLnm!=null">
		   AND (B.DMN_LNM LIKE  '%' || #{dmnLnm,jdbcType=VARCHAR} || '%'
		        OR B.DMN_LNM LIKE  '%' || #{dmnLnm,jdbcType=VARCHAR} || '%')
		   </if>
		   
		 </where>
		 ORDER BY GAP_STATUS, DMN_LNM, SMPL_LCCD
	</select>
<select id="selectCodeGapMetaReal" parameterType="kr.wise.meta.gap.service.CodeGapVO" resultMap="BaseResultMap">
SELECT B.DMN_ID
       ,B.DMN_LNM
       ,B.DMN_PNM
       ,T.DB_CONN_TRG_PNM AS TGT_DB_CONN_TRG_PNM
       ,T.DB_CONN_TRG_ID
       ,S.DB_SCH_PNM      AS TGT_DB_SCH_PNM
       ,S.DB_SCH_ID
       ,A.*
		     , CASE WHEN A.GAP_STATUS = 'GAP' THEN '#FF0000' END AS FontColor
		  FROM (
		        SELECT CASE WHEN    COALESCE(A.SMPL_LCCD_NM  ,'-')   != COALESCE(B.SMPL_LCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_MCCD_NM  ,'-')   != COALESCE(B.SMPL_MCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_SCCD_NM  ,'-')   != COALESCE(B.SMPL_SCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_CD_STS_YN,'N')   != COALESCE(B.SMPL_CD_STS_YN  ,'N')         
                                 OR COALESCE(A.ETC_CD1       ,'-')   != COALESCE(B.ETC_CD1         ,'-')         
                                 OR COALESCE(A.ETC_CD2       ,'-')   != COALESCE(B.ETC_CD2         ,'-')         
                                 OR COALESCE(A.ETC_CD3       ,'-')   != COALESCE(B.ETC_CD3         ,'-')         
                                 OR COALESCE(A.ETC_CD4       ,'-')   != COALESCE(B.ETC_CD4         ,'-')         
                                 OR COALESCE(A.ETC_CD5       ,'-')   != COALESCE(B.ETC_CD5         ,'-')         
                                 OR COALESCE(A.ETC_CD_NM1    ,'-')   != COALESCE(B.ETC_CD_NM1      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM2    ,'-')   != COALESCE(B.ETC_CD_NM2      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM3    ,'-')   != COALESCE(B.ETC_CD_NM3      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM4    ,'-')   != COALESCE(B.ETC_CD_NM4      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM5    ,'-')   != COALESCE(B.ETC_CD_NM5      ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN1 ,'-')   != COALESCE(B.CD_OUTL_CNTN1   ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN2 ,'-')   != COALESCE(B.CD_OUTL_CNTN2   ,'-')         
                                 OR COALESCE(A.ARY_SQNC_NO   ,0  )   != COALESCE(B.ARY_SQNC_NO     ,0  )         
                                 OR COALESCE(A.RMRK_CNTN     ,'-')   != COALESCE(B.RMRK_CNTN       ,'-')  THEN 'GAP'  
		                 ELSE 'NML' END AS GAP_STATUS
   		                 ,CASE WHEN A.SMPL_LCCD IS NULL THEN '[메타이관단순코드미존재]'
                               WHEN B.SMPL_LCCD IS NULL THEN '[운영단순코드미존재]'
                               WHEN    COALESCE(A.SMPL_LCCD_NM  ,'-')   != COALESCE(B.SMPL_LCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_MCCD_NM  ,'-')   != COALESCE(B.SMPL_MCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_SCCD_NM  ,'-')   != COALESCE(B.SMPL_SCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_CD_STS_YN,'N')   != COALESCE(B.SMPL_CD_STS_YN  ,'N')         
                                 OR COALESCE(A.ETC_CD1       ,'-')   != COALESCE(B.ETC_CD1         ,'-')         
                                 OR COALESCE(A.ETC_CD2       ,'-')   != COALESCE(B.ETC_CD2         ,'-')         
                                 OR COALESCE(A.ETC_CD3       ,'-')   != COALESCE(B.ETC_CD3         ,'-')         
                                 OR COALESCE(A.ETC_CD4       ,'-')   != COALESCE(B.ETC_CD4         ,'-')         
                                 OR COALESCE(A.ETC_CD5       ,'-')   != COALESCE(B.ETC_CD5         ,'-')         
                                 OR COALESCE(A.ETC_CD_NM1    ,'-')   != COALESCE(B.ETC_CD_NM1      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM2    ,'-')   != COALESCE(B.ETC_CD_NM2      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM3    ,'-')   != COALESCE(B.ETC_CD_NM3      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM4    ,'-')   != COALESCE(B.ETC_CD_NM4      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM5    ,'-')   != COALESCE(B.ETC_CD_NM5      ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN1 ,'-')   != COALESCE(B.CD_OUTL_CNTN1   ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN2 ,'-')   != COALESCE(B.CD_OUTL_CNTN2   ,'-')         
                                 OR COALESCE(A.ARY_SQNC_NO   ,0  )   != COALESCE(B.ARY_SQNC_NO     ,0  )         
                                 OR COALESCE(A.RMRK_CNTN     ,'-')   != COALESCE(B.RMRK_CNTN       ,'-')  THEN '[코드GAP존재]'
		                 ELSE NULL END AS GAP_CONTS  
		               ,COALESCE(A.SMPL_LCCD, B.SMPL_LCCD) SMPL_LCCD                          
                       , A.SMPL_MCCD                           
                       , A.SMPL_SCCD                           
                       , A.SMPL_LCCD_NM                        
                       , A.SMPL_MCCD_NM                        
                       , A.SMPL_SCCD_NM                        
                       , A.SMPL_CD_STS_YN  AS  USE_YN                
                       , A.ETC_CD1                             
                       , A.ETC_CD2                             
                       , A.ETC_CD3                             
                       , A.ETC_CD4                             
                       , A.ETC_CD5                             
                       , A.ETC_CD_NM1                          
                       , A.ETC_CD_NM2                          
                       , A.ETC_CD_NM3                          
                       , A.ETC_CD_NM4                          
                       , A.ETC_CD_NM5                          
                       , A.CD_OUTL_CNTN1                       
                       , A.CD_OUTL_CNTN2                       
                       , A.ARY_SQNC_NO     DISP_ORD                    
                       , A.RMRK_CNTN       
                       , B.SMPL_LCCD       TGT_SMPL_LCCD       
                       , B.SMPL_MCCD       TGT_SMPL_MCCD       
                       , B.SMPL_SCCD       TGT_SMPL_SCCD       
                       , B.SMPL_LCCD_NM    TGT_SMPL_LCCD_NM    
                       , B.SMPL_MCCD_NM    TGT_SMPL_MCCD_NM    
                       , B.SMPL_SCCD_NM    TGT_SMPL_SCCD_NM    
                       , B.SMPL_CD_STS_YN  TGT_USE_YN
                       , B.ETC_CD1         TGT_ETC_CD1         
                       , B.ETC_CD2         TGT_ETC_CD2         
                       , B.ETC_CD3         TGT_ETC_CD3         
                       , B.ETC_CD4         TGT_ETC_CD4         
                       , B.ETC_CD5         TGT_ETC_CD5         
                       , B.ETC_CD_NM1      TGT_ETC_CD_NM1      
                       , B.ETC_CD_NM2      TGT_ETC_CD_NM2      
                       , B.ETC_CD_NM3      TGT_ETC_CD_NM3      
                       , B.ETC_CD_NM4      TGT_ETC_CD_NM4      
                       , B.ETC_CD_NM5      TGT_ETC_CD_NM5      
                       , B.CD_OUTL_CNTN1   TGT_CD_OUTL_CNTN1   
                       , B.CD_OUTL_CNTN2   TGT_CD_OUTL_CNTN2   
                       , B.ARY_SQNC_NO     TGT_DISP_ORD
                       , B.RMRK_CNTN       TGT_RMRK_CNTN   
                       , A.DB_CONN_TRG_ID
                       , A.DB_SCH_ID
                       FROM V_TSF_SIMPLE_CD_LIST A
                       FULL OUTER JOIN WAT_TSF_SMP_CD B
                       ON A.SMPL_LCCD = B.SMPL_LCCD
                       AND COALESCE(A.SMPL_MCCD,'-') =COALESCE(B.SMPL_MCCD,'-')
                       AND A.SMPL_SCCD = B.SMPL_SCCD
                       AND A.DB_CONN_TRG_ID = A.DB_CONN_TRG_ID
                       AND A.DB_SCH_ID      = B.DB_SCH_ID
		        ) A
                LEFT OUTER JOIN WAM_DMN B
                ON A.SMPL_LCCD = B.DMN_DSCD
                LEFT OUTER JOIN WAA_DB_SCH S
                ON A.DB_SCH_ID =S.DB_SCH_ID
                AND S.REG_TYP_CD IN ('C', 'U')
                AND S.EXP_DTM = TO_DATE('99991231', 'YYYYMMDD')
                AND S.DDL_TRG_DCD ='R'
                LEFT OUTER JOIN WAA_DB_CONN_TRG T
                ON A.DB_CONN_TRG_ID =T.DB_CONN_TRG_ID
                AND T.DB_CONN_TRG_ID = S.DB_CONN_TRG_ID
                AND T.REG_TYP_CD IN ('C', 'U')
                AND T.EXP_DTM = TO_DATE('99991231', 'YYYYMMDD')
		 <where>
		   <if test="gapStatus != null">
		   AND A.GAP_STATUS = #{gapStatus,jdbcType=VARCHAR}
		   </if>
		   <if test="dbConnTrgId != null">
		   AND T.DB_CONN_TRG_ID = #{dbConnTrgId,jdbcType=VARCHAR}
		   </if>
		   <if test="dbSchId != null">
		   AND S.DB_SCH_ID = #{dbSchId,jdbcType=VARCHAR}
		   </if>
		   <if test="codePnm != null">
		   AND (   A.SMPL_LCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_MCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_SCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_LCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_MCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_SCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_LCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_MCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_SCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_LCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_MCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_SCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		)
		   </if>
		   <if test="dmnLnm!=null">
		   AND (B.DMN_LNM LIKE  '%' || #{dmnLnm,jdbcType=VARCHAR} || '%'
		        OR B.DMN_LNM LIKE  '%' || #{dmnLnm,jdbcType=VARCHAR} || '%')
		   </if>
		 </where>
		 ORDER BY GAP_STATUS, DMN_LNM, SMPL_LCCD
	</select>
<select id="selectCodeGapMetaTsf" parameterType="kr.wise.meta.gap.service.CodeGapVO" resultMap="BaseResultMap">
SELECT B.DMN_ID
       ,B.DMN_LNM
       ,B.DMN_PNM
       ,T.DB_CONN_TRG_PNM AS TGT_DB_CONN_TRG_PNM
       ,T.DB_CONN_TRG_ID 
       ,S.DB_SCH_PNM      AS TGT_DB_SCH_PNM
       ,S.DB_SCH_ID
       ,A.*
		     , CASE WHEN A.GAP_STATUS = 'GAP' THEN '#FF0000' END AS FontColor
		  FROM (
		        SELECT CASE WHEN    COALESCE(A.SMPL_LCCD_NM  ,'-')   != COALESCE(B.SMPL_LCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_MCCD_NM  ,'-')   != COALESCE(B.SMPL_MCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_SCCD_NM  ,'-')   != COALESCE(B.SMPL_SCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_CD_STS_YN,'N')   != COALESCE(B.SMPL_CD_STS_YN  ,'N')         
                                 OR COALESCE(A.ETC_CD1       ,'-')   != COALESCE(B.ETC_CD1         ,'-')         
                                 OR COALESCE(A.ETC_CD2       ,'-')   != COALESCE(B.ETC_CD2         ,'-')         
                                 OR COALESCE(A.ETC_CD3       ,'-')   != COALESCE(B.ETC_CD3         ,'-')         
                                 OR COALESCE(A.ETC_CD4       ,'-')   != COALESCE(B.ETC_CD4         ,'-')         
                                 OR COALESCE(A.ETC_CD5       ,'-')   != COALESCE(B.ETC_CD5         ,'-')         
                                 OR COALESCE(A.ETC_CD_NM1    ,'-')   != COALESCE(B.ETC_CD_NM1      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM2    ,'-')   != COALESCE(B.ETC_CD_NM2      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM3    ,'-')   != COALESCE(B.ETC_CD_NM3      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM4    ,'-')   != COALESCE(B.ETC_CD_NM4      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM5    ,'-')   != COALESCE(B.ETC_CD_NM5      ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN1 ,'-')   != COALESCE(B.CD_OUTL_CNTN1   ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN2 ,'-')   != COALESCE(B.CD_OUTL_CNTN2   ,'-')         
                                 OR COALESCE(A.ARY_SQNC_NO   ,0  )   != COALESCE(B.ARY_SQNC_NO     ,0  )         
                                 OR COALESCE(A.RMRK_CNTN     ,'-')   != COALESCE(B.RMRK_CNTN       ,'-')  THEN 'GAP'  
		                 ELSE 'NML' END AS GAP_STATUS
   		                 ,CASE WHEN A.SMPL_LCCD IS NULL THEN '[메타단순코드미존재]'
                               WHEN B.SMPL_LCCD IS NULL THEN '[메타이관단순코드미존재]'
                               WHEN    COALESCE(A.SMPL_LCCD_NM  ,'-')   != COALESCE(B.SMPL_LCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_MCCD_NM  ,'-')   != COALESCE(B.SMPL_MCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_SCCD_NM  ,'-')   != COALESCE(B.SMPL_SCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_CD_STS_YN,'N')   != COALESCE(B.SMPL_CD_STS_YN  ,'N')         
                                 OR COALESCE(A.ETC_CD1       ,'-')   != COALESCE(B.ETC_CD1         ,'-')         
                                 OR COALESCE(A.ETC_CD2       ,'-')   != COALESCE(B.ETC_CD2         ,'-')         
                                 OR COALESCE(A.ETC_CD3       ,'-')   != COALESCE(B.ETC_CD3         ,'-')         
                                 OR COALESCE(A.ETC_CD4       ,'-')   != COALESCE(B.ETC_CD4         ,'-')         
                                 OR COALESCE(A.ETC_CD5       ,'-')   != COALESCE(B.ETC_CD5         ,'-')         
                                 OR COALESCE(A.ETC_CD_NM1    ,'-')   != COALESCE(B.ETC_CD_NM1      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM2    ,'-')   != COALESCE(B.ETC_CD_NM2      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM3    ,'-')   != COALESCE(B.ETC_CD_NM3      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM4    ,'-')   != COALESCE(B.ETC_CD_NM4      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM5    ,'-')   != COALESCE(B.ETC_CD_NM5      ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN1 ,'-')   != COALESCE(B.CD_OUTL_CNTN1   ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN2 ,'-')   != COALESCE(B.CD_OUTL_CNTN2   ,'-')         
                                 OR COALESCE(A.ARY_SQNC_NO   ,0  )   != COALESCE(B.ARY_SQNC_NO     ,0  )         
                                 OR COALESCE(A.RMRK_CNTN     ,'-')   != COALESCE(B.RMRK_CNTN       ,'-')  THEN '[코드GAP존재]'
		                 ELSE NULL END AS GAP_CONTS  
		               ,COALESCE(A.SMPL_LCCD, B.SMPL_LCCD) SMPL_LCCD                          
                       , A.SMPL_MCCD                           
                       , A.SMPL_SCCD                           
                       , A.SMPL_LCCD_NM                        
                       , A.SMPL_MCCD_NM                        
                       , A.SMPL_SCCD_NM                        
                       , A.SMPL_CD_STS_YN AS USE_YN                     
                       , A.ETC_CD1                             
                       , A.ETC_CD2                             
                       , A.ETC_CD3                             
                       , A.ETC_CD4                             
                       , A.ETC_CD5                             
                       , A.ETC_CD_NM1                          
                       , A.ETC_CD_NM2                          
                       , A.ETC_CD_NM3                          
                       , A.ETC_CD_NM4                          
                       , A.ETC_CD_NM5                          
                       , A.CD_OUTL_CNTN1                       
                       , A.CD_OUTL_CNTN2                       
                       , A.ARY_SQNC_NO     DISP_ORD                     
                       , A.RMRK_CNTN       
                       , B.SMPL_LCCD       TGT_SMPL_LCCD       
                       , B.SMPL_MCCD       TGT_SMPL_MCCD       
                       , B.SMPL_SCCD       TGT_SMPL_SCCD       
                       , B.SMPL_LCCD_NM    TGT_SMPL_LCCD_NM    
                       , B.SMPL_MCCD_NM    TGT_SMPL_MCCD_NM    
                       , B.SMPL_SCCD_NM    TGT_SMPL_SCCD_NM    
                       , B.SMPL_CD_STS_YN  TGT_USE_YN  
                       , B.ETC_CD1         TGT_ETC_CD1         
                       , B.ETC_CD2         TGT_ETC_CD2         
                       , B.ETC_CD3         TGT_ETC_CD3         
                       , B.ETC_CD4         TGT_ETC_CD4         
                       , B.ETC_CD5         TGT_ETC_CD5         
                       , B.ETC_CD_NM1      TGT_ETC_CD_NM1      
                       , B.ETC_CD_NM2      TGT_ETC_CD_NM2      
                       , B.ETC_CD_NM3      TGT_ETC_CD_NM3      
                       , B.ETC_CD_NM4      TGT_ETC_CD_NM4      
                       , B.ETC_CD_NM5      TGT_ETC_CD_NM5      
                       , B.CD_OUTL_CNTN1   TGT_CD_OUTL_CNTN1   
                       , B.CD_OUTL_CNTN2   TGT_CD_OUTL_CNTN2   
                       , B.ARY_SQNC_NO     TGT_DISP_ORD
                       , B.RMRK_CNTN       TGT_RMRK_CNTN   
                       , B.DB_CONN_TRG_ID
                       , B.DB_SCH_ID
                       FROM V_SIMPLE_CD_LIST A
                       FULL OUTER JOIN V_TSF_SIMPLE_CD_LIST B
                       ON A.SMPL_LCCD = B.SMPL_LCCD
                       AND COALESCE(A.SMPL_MCCD,'-') =COALESCE(B.SMPL_MCCD,'-')
                       AND A.SMPL_SCCD = B.SMPL_SCCD
                       --AND A.DB_CONN_TRG_ID = A.DB_CONN_TRG_ID
                       --AND A.DB_SCH_ID      = B.DB_SCH_ID
		        ) A
                LEFT OUTER JOIN WAM_DMN B
                ON A.SMPL_LCCD = B.DMN_DSCD
                LEFT OUTER JOIN WAA_DB_SCH S
                ON A.DB_SCH_ID =S.DB_SCH_ID
                AND S.REG_TYP_CD IN ('C', 'U')
                AND S.EXP_DTM = TO_DATE('99991231', 'YYYYMMDD')
                AND S.DDL_TRG_DCD ='R'
                LEFT OUTER JOIN WAA_DB_CONN_TRG T
                ON A.DB_CONN_TRG_ID =T.DB_CONN_TRG_ID
                AND T.DB_CONN_TRG_ID = S.DB_CONN_TRG_ID
                AND T.REG_TYP_CD IN ('C', 'U')
                AND T.EXP_DTM = TO_DATE('99991231', 'YYYYMMDD')
		 <where>
		   <if test="gapStatus != null">
		   AND A.GAP_STATUS = #{gapStatus,jdbcType=VARCHAR}
		   </if>
		   <if test="dbConnTrgId != null">
		   AND T.DB_CONN_TRG_ID = #{dbConnTrgId,jdbcType=VARCHAR}
		   </if>
		   <if test="dbSchId != null">
		   AND S.DB_SCH_ID = #{dbSchId,jdbcType=VARCHAR}
		   </if>
		   <if test="codePnm != null">
		   AND (   A.SMPL_LCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_MCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_SCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_LCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_MCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_SCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_LCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_MCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_SCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_LCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_MCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_SCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		)
		   </if>
		   <if test="dmnLnm!=null">
		   AND (B.DMN_LNM LIKE  '%' || #{dmnLnm,jdbcType=VARCHAR} || '%'
		        OR B.DMN_LNM LIKE  '%' || #{dmnLnm,jdbcType=VARCHAR} || '%')
		   </if>
		 </where>
		 ORDER BY GAP_STATUS, DMN_LNM, SMPL_LCCD
	</select>
<select id="selectCodeGapDevReal" parameterType="kr.wise.meta.gap.service.CodeGapVO" resultMap="BaseResultMap">
SELECT B.DMN_ID
       ,B.DMN_LNM
       ,B.DMN_PNM
       ,T.DB_CONN_TRG_PNM AS TGT_DB_CONN_TRG_PNM
       ,T.DB_CONN_TRG_ID 
       ,S.DB_SCH_PNM      AS TGT_DB_SCH_PNM
       ,S.DB_SCH_ID
       ,'MSRDBD' AS DB_CONN_TRG_PNM
       ,'MRS_OWN' AS DB_SCH_PNM
       ,A.*
		     , CASE WHEN A.GAP_STATUS = 'GAP' THEN '#FF0000' END AS FontColor
		  FROM (
		        SELECT CASE WHEN    COALESCE(A.SMPL_LCCD_NM  ,'-')   != COALESCE(B.SMPL_LCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_MCCD_NM  ,'-')   != COALESCE(B.SMPL_MCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_SCCD_NM  ,'-')   != COALESCE(B.SMPL_SCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_CD_STS_YN,'N')   != COALESCE(B.SMPL_CD_STS_YN  ,'N')         
                                 OR COALESCE(A.ETC_CD1       ,'-')   != COALESCE(B.ETC_CD1         ,'-')         
                                 OR COALESCE(A.ETC_CD2       ,'-')   != COALESCE(B.ETC_CD2         ,'-')         
                                 OR COALESCE(A.ETC_CD3       ,'-')   != COALESCE(B.ETC_CD3         ,'-')         
                                 OR COALESCE(A.ETC_CD4       ,'-')   != COALESCE(B.ETC_CD4         ,'-')         
                                 OR COALESCE(A.ETC_CD5       ,'-')   != COALESCE(B.ETC_CD5         ,'-')         
                                 OR COALESCE(A.ETC_CD_NM1    ,'-')   != COALESCE(B.ETC_CD_NM1      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM2    ,'-')   != COALESCE(B.ETC_CD_NM2      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM3    ,'-')   != COALESCE(B.ETC_CD_NM3      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM4    ,'-')   != COALESCE(B.ETC_CD_NM4      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM5    ,'-')   != COALESCE(B.ETC_CD_NM5      ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN1 ,'-')   != COALESCE(B.CD_OUTL_CNTN1   ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN2 ,'-')   != COALESCE(B.CD_OUTL_CNTN2   ,'-')         
                                 OR COALESCE(A.ARY_SQNC_NO   ,0  )   != COALESCE(B.ARY_SQNC_NO     ,0  )         
                                 OR COALESCE(A.RMRK_CNTN     ,'-')   != COALESCE(B.RMRK_CNTN       ,'-')  THEN 'GAP'  
		                 ELSE 'NML' END AS GAP_STATUS
   		                 ,CASE WHEN A.SMPL_LCCD IS NULL THEN '[메타이관단순코드미존재]'
                               WHEN B.SMPL_LCCD IS NULL THEN '[운영단순코드미존재]'
                               WHEN    COALESCE(A.SMPL_LCCD_NM  ,'-')   != COALESCE(B.SMPL_LCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_MCCD_NM  ,'-')   != COALESCE(B.SMPL_MCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_SCCD_NM  ,'-')   != COALESCE(B.SMPL_SCCD_NM    ,'-')         
                                 OR COALESCE(A.SMPL_CD_STS_YN,'N')   != COALESCE(B.SMPL_CD_STS_YN  ,'N')         
                                 OR COALESCE(A.ETC_CD1       ,'-')   != COALESCE(B.ETC_CD1         ,'-')         
                                 OR COALESCE(A.ETC_CD2       ,'-')   != COALESCE(B.ETC_CD2         ,'-')         
                                 OR COALESCE(A.ETC_CD3       ,'-')   != COALESCE(B.ETC_CD3         ,'-')         
                                 OR COALESCE(A.ETC_CD4       ,'-')   != COALESCE(B.ETC_CD4         ,'-')         
                                 OR COALESCE(A.ETC_CD5       ,'-')   != COALESCE(B.ETC_CD5         ,'-')         
                                 OR COALESCE(A.ETC_CD_NM1    ,'-')   != COALESCE(B.ETC_CD_NM1      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM2    ,'-')   != COALESCE(B.ETC_CD_NM2      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM3    ,'-')   != COALESCE(B.ETC_CD_NM3      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM4    ,'-')   != COALESCE(B.ETC_CD_NM4      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM5    ,'-')   != COALESCE(B.ETC_CD_NM5      ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN1 ,'-')   != COALESCE(B.CD_OUTL_CNTN1   ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN2 ,'-')   != COALESCE(B.CD_OUTL_CNTN2   ,'-')         
                                 OR COALESCE(A.ARY_SQNC_NO   ,0  )   != COALESCE(B.ARY_SQNC_NO     ,0  )         
                                 OR COALESCE(A.RMRK_CNTN     ,'-')   != COALESCE(B.RMRK_CNTN       ,'-')  THEN '[코드GAP존재]'
		                 ELSE NULL END AS GAP_CONTS  
		               ,COALESCE(A.SMPL_LCCD, B.SMPL_LCCD) SMPL_LCCD                          
                       , A.SMPL_MCCD                           
                       , A.SMPL_SCCD                           
                       , A.SMPL_LCCD_NM                        
                       , A.SMPL_MCCD_NM                        
                       , A.SMPL_SCCD_NM                        
                       , A.SMPL_CD_STS_YN  AS USE_YN
                       , A.ETC_CD1                             
                       , A.ETC_CD2                             
                       , A.ETC_CD3                             
                       , A.ETC_CD4                             
                       , A.ETC_CD5                             
                       , A.ETC_CD_NM1                          
                       , A.ETC_CD_NM2                          
                       , A.ETC_CD_NM3                          
                       , A.ETC_CD_NM4                          
                       , A.ETC_CD_NM5                          
                       , A.CD_OUTL_CNTN1                       
                       , A.CD_OUTL_CNTN2                       
                       , A.ARY_SQNC_NO      DISP_ORD                   
                       , A.RMRK_CNTN       
                       , B.SMPL_LCCD       TGT_SMPL_LCCD       
                       , B.SMPL_MCCD       TGT_SMPL_MCCD       
                       , B.SMPL_SCCD       TGT_SMPL_SCCD       
                       , B.SMPL_LCCD_NM    TGT_SMPL_LCCD_NM    
                       , B.SMPL_MCCD_NM    TGT_SMPL_MCCD_NM    
                       , B.SMPL_SCCD_NM    TGT_SMPL_SCCD_NM    
                       , B.SMPL_CD_STS_YN  TGT_USE_YN  
                       , B.ETC_CD1         TGT_ETC_CD1         
                       , B.ETC_CD2         TGT_ETC_CD2         
                       , B.ETC_CD3         TGT_ETC_CD3         
                       , B.ETC_CD4         TGT_ETC_CD4         
                       , B.ETC_CD5         TGT_ETC_CD5         
                       , B.ETC_CD_NM1      TGT_ETC_CD_NM1      
                       , B.ETC_CD_NM2      TGT_ETC_CD_NM2      
                       , B.ETC_CD_NM3      TGT_ETC_CD_NM3      
                       , B.ETC_CD_NM4      TGT_ETC_CD_NM4      
                       , B.ETC_CD_NM5      TGT_ETC_CD_NM5      
                       , B.CD_OUTL_CNTN1   TGT_CD_OUTL_CNTN1   
                       , B.CD_OUTL_CNTN2   TGT_CD_OUTL_CNTN2   
                       , B.ARY_SQNC_NO     TGT_DISP_ORD
                       , B.RMRK_CNTN       TGT_RMRK_CNTN   
                       , B.DB_CONN_TRG_ID
                       , B.DB_SCH_ID
                       FROM WAT_SMP_CD A
                       FULL OUTER JOIN WAT_TSF_SMP_CD B
                       ON A.SMPL_LCCD = B.SMPL_LCCD
                       AND COALESCE(A.SMPL_MCCD,'-') =COALESCE(B.SMPL_MCCD,'-')
                       AND A.SMPL_SCCD = B.SMPL_SCCD
                       --AND A.DB_CONN_TRG_ID = A.DB_CONN_TRG_ID
                       --AND A.DB_SCH_ID      = B.DB_SCH_ID
		        ) A
                LEFT OUTER JOIN WAM_DMN B
                ON A.SMPL_LCCD = B.DMN_DSCD
                LEFT OUTER JOIN WAA_DB_SCH S
                ON A.DB_SCH_ID =S.DB_SCH_ID
                AND S.REG_TYP_CD IN ('C', 'U')
                AND S.EXP_DTM = TO_DATE('99991231', 'YYYYMMDD')
                AND S.DDL_TRG_DCD ='R'
                LEFT OUTER JOIN WAA_DB_CONN_TRG T
                ON A.DB_CONN_TRG_ID =T.DB_CONN_TRG_ID
                AND T.DB_CONN_TRG_ID = S.DB_CONN_TRG_ID
                AND T.REG_TYP_CD IN ('C', 'U')
                AND T.EXP_DTM = TO_DATE('99991231', 'YYYYMMDD')
		 <where>
		   <if test="gapStatus != null">
		   AND A.GAP_STATUS = #{gapStatus,jdbcType=VARCHAR}
		   </if>
		   <if test="dbConnTrgId != null">
		   AND T.DB_CONN_TRG_ID = #{dbConnTrgId,jdbcType=VARCHAR}
		   </if>
		   <if test="dbSchId != null">
		   AND S.DB_SCH_ID = #{dbSchId,jdbcType=VARCHAR}
		   </if>
		   <if test="codePnm != null">
		   AND (   A.SMPL_LCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_MCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_SCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_LCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_MCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.SMPL_SCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_LCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_MCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_SCCD LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_LCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_MCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_SMPL_SCCD_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		)
		   </if>
		   <if test="dmnLnm!=null">
		   AND (B.DMN_LNM LIKE  '%' || #{dmnLnm,jdbcType=VARCHAR} || '%'
		        OR B.DMN_LNM LIKE  '%' || #{dmnLnm,jdbcType=VARCHAR} || '%')
		   </if>
		 </where>
		 ORDER BY GAP_STATUS, DMN_LNM, SMPL_LCCD
	</select>
<select id="selectCmpCodeGapMetaDev" parameterType="kr.wise.meta.gap.service.CodeGapVO" resultMap="BaseResultMap">
SELECT B.DMN_ID
       ,B.DMN_LNM
       ,B.DMN_PNM
       ,T.DB_CONN_TRG_PNM AS TGT_DB_CONN_TRG_PNM
       ,T.DB_CONN_TRG_ID
       ,S.DB_SCH_PNM      AS TGT_DB_SCH_PNM
       ,S.DB_SCH_ID
       ,A.*
		     , CASE WHEN A.GAP_STATUS = 'GAP' THEN '#FF0000' END AS FontColor
		  FROM (
		        SELECT CASE WHEN    COALESCE(A.COEX_LVL_NO  ,0)   != COALESCE(B.COEX_LVL_NO    ,0)         
                                 OR COALESCE(A.COEX_CD_NM  ,'-')   != COALESCE(B.COEX_CD_NM    ,'-')         
                                 OR COALESCE(A.COEX_CD_STS_YN,'N')   != COALESCE(B.COEX_CD_STS_YN  ,'N')         
                                 OR COALESCE(A.ETC_CD1       ,'-')   != COALESCE(B.ETC_CD1         ,'-')         
                                 OR COALESCE(A.ETC_CD2       ,'-')   != COALESCE(B.ETC_CD2         ,'-')         
                                 OR COALESCE(A.ETC_CD3       ,'-')   != COALESCE(B.ETC_CD3         ,'-')         
                                 OR COALESCE(A.ETC_CD4       ,'-')   != COALESCE(B.ETC_CD4         ,'-')         
                                 OR COALESCE(A.ETC_CD5       ,'-')   != COALESCE(B.ETC_CD5         ,'-')         
                                 OR COALESCE(A.ETC_CD_NM1    ,'-')   != COALESCE(B.ETC_CD_NM1      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM2    ,'-')   != COALESCE(B.ETC_CD_NM2      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM3    ,'-')   != COALESCE(B.ETC_CD_NM3      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM4    ,'-')   != COALESCE(B.ETC_CD_NM4      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM5    ,'-')   != COALESCE(B.ETC_CD_NM5      ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN1 ,'-')   != COALESCE(B.CD_OUTL_CNTN1   ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN2 ,'-')   != COALESCE(B.CD_OUTL_CNTN2   ,'-')         
                                 OR COALESCE(A.ARY_SQNC_NO   ,0  )   != COALESCE(B.ARY_SQNC_NO     ,0  )         
                                 OR COALESCE(A.RMRK_CNTN     ,'-')   != COALESCE(B.RMRK_CNTN       ,'-')  THEN 'GAP'  
		                 ELSE 'NML' END AS GAP_STATUS
		                 ,CASE WHEN A.COEX_DTL_CD IS NULL THEN '[메타복잡코드미존재]'
                               WHEN B.COEX_DTL_CD IS NULL THEN '[개발복잡코드미존재]'
                               WHEN      COALESCE(A.COEX_LVL_NO  ,0)   != COALESCE(B.COEX_LVL_NO    ,0)         
                                 OR COALESCE(A.COEX_CD_NM  ,'-')   != COALESCE(B.COEX_CD_NM    ,'-')         
                                 OR COALESCE(A.COEX_CD_STS_YN,'N')   != COALESCE(B.COEX_CD_STS_YN  ,'N')         
                                 OR COALESCE(A.ETC_CD1       ,'-')   != COALESCE(B.ETC_CD1         ,'-')         
                                 OR COALESCE(A.ETC_CD2       ,'-')   != COALESCE(B.ETC_CD2         ,'-')         
                                 OR COALESCE(A.ETC_CD3       ,'-')   != COALESCE(B.ETC_CD3         ,'-')         
                                 OR COALESCE(A.ETC_CD4       ,'-')   != COALESCE(B.ETC_CD4         ,'-')         
                                 OR COALESCE(A.ETC_CD5       ,'-')   != COALESCE(B.ETC_CD5         ,'-')         
                                 OR COALESCE(A.ETC_CD_NM1    ,'-')   != COALESCE(B.ETC_CD_NM1      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM2    ,'-')   != COALESCE(B.ETC_CD_NM2      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM3    ,'-')   != COALESCE(B.ETC_CD_NM3      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM4    ,'-')   != COALESCE(B.ETC_CD_NM4      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM5    ,'-')   != COALESCE(B.ETC_CD_NM5      ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN1 ,'-')   != COALESCE(B.CD_OUTL_CNTN1   ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN2 ,'-')   != COALESCE(B.CD_OUTL_CNTN2   ,'-')         
                                 OR COALESCE(A.ARY_SQNC_NO   ,0  )   != COALESCE(B.ARY_SQNC_NO     ,0  )         
                                 OR COALESCE(A.RMRK_CNTN     ,'-')   != COALESCE(B.RMRK_CNTN       ,'-')  THEN '[코드GAP존재]'
		                 ELSE NULL END AS GAP_CONTS  
		               , COALESCE(A.COEX_DTL_CD,B.COEX_DTL_CD) AS CD_VAL
                       , A.COEX_UPRN_CD   AS UPP_CD_VAL
                       , A.COEX_LVL_NO    AS CODE_LEVEL
                       , A.COEX_CD_NM     AS CD_VAL_NM
                       , A.COEX_CD_STS_YN AS USE_YN
                       , A.ETC_CD1                             
                       , A.ETC_CD2                             
                       , A.ETC_CD3                             
                       , A.ETC_CD4                             
                       , A.ETC_CD5                             
                       , A.ETC_CD_NM1                          
                       , A.ETC_CD_NM2                          
                       , A.ETC_CD_NM3                          
                       , A.ETC_CD_NM4                          
                       , A.ETC_CD_NM5                          
                       , A.CD_OUTL_CNTN1                       
                       , A.CD_OUTL_CNTN2                       
                       , A.ARY_SQNC_NO    DISP_ORD                     
                       , A.RMRK_CNTN       
                       , B.COEX_DTL_CD    AS TGT_CD_VAL
                       , B.COEX_UPRN_CD   AS TGT_UPP_CD_VAL
                       , B.COEX_LVL_NO    AS TGT_CODE_LEVEL
                       , B.COEX_CD_NM     AS TGT_CD_VAL_NM
                       , B.COEX_CD_STS_YN AS TGT_USE_YN
                       , B.ETC_CD1         TGT_ETC_CD1         
                       , B.ETC_CD2         TGT_ETC_CD2         
                       , B.ETC_CD3         TGT_ETC_CD3         
                       , B.ETC_CD4         TGT_ETC_CD4         
                       , B.ETC_CD5         TGT_ETC_CD5         
                       , B.ETC_CD_NM1      TGT_ETC_CD_NM1      
                       , B.ETC_CD_NM2      TGT_ETC_CD_NM2      
                       , B.ETC_CD_NM3      TGT_ETC_CD_NM3      
                       , B.ETC_CD_NM4      TGT_ETC_CD_NM4      
                       , B.ETC_CD_NM5      TGT_ETC_CD_NM5      
                       , B.CD_OUTL_CNTN1   TGT_CD_OUTL_CNTN1   
                       , B.CD_OUTL_CNTN2   TGT_CD_OUTL_CNTN2   
                       , B.ARY_SQNC_NO     TGT_DISP_ORD
                       , B.RMRK_CNTN       TGT_RMRK_CNTN   
                       ,'MRSDBD' AS DB_CONN_TRG_PNM
                       ,'MRS_OWN' AS DB_SCH_PNM
                       FROM V_COMPLEX_CD_LIST A
                       FULL OUTER JOIN WAT_CMP_CD B
                       ON A.COEX_DTL_CD = B.COEX_DTL_CD
                       AND A.COEX_UPRN_CD = B.COEX_UPRN_CD
		        ) A 
                LEFT OUTER JOIN WAM_CD_VAL V
                ON A.CD_VAL = V.CD_VAL
                LEFT OUTER JOIN WAM_DMN B
                ON V.DMN_ID = B.DMN_ID
                OR A.CD_VAL_NM = B.DMN_LNM
                LEFT OUTER JOIN WAA_DB_SCH S
                ON A.DB_SCH_PNM =S.DB_SCH_PNM
                AND S.REG_TYP_CD IN ('C', 'U')
                AND S.EXP_DTM = TO_DATE('99991231', 'YYYYMMDD')
                AND S.DDL_TRG_DCD ='D'
                LEFT OUTER JOIN WAA_DB_CONN_TRG T
                ON A.DB_CONN_TRG_PNM =T.DB_CONN_TRG_PNM
                AND T.DB_CONN_TRG_ID = S.DB_CONN_TRG_ID
                AND T.REG_TYP_CD IN ('C', 'U')
                AND T.EXP_DTM = TO_DATE('99991231', 'YYYYMMDD')
		 <where>
		   <if test="gapStatus != null">
		   AND A.GAP_STATUS = #{gapStatus,jdbcType=VARCHAR}
		   </if>
		   <if test="dbConnTrgId != null">
		   AND T.DB_CONN_TRG_ID = #{dbConnTrgId,jdbcType=VARCHAR}
		   </if>
		   <if test="dbSchId != null">
		   AND S.DB_SCH_ID = #{dbSchId,jdbcType=VARCHAR}
		   </if>
		   <if test="codePnm != null">
		   AND (   A.CD_VAL LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.CD_VAL_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_CD_VAL LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_CD_VAL_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		)
		   </if>
		   <if test="dmnLnm!=null">
		   AND (B.DMN_LNM LIKE  '%' || #{dmnLnm,jdbcType=VARCHAR} || '%'
		        OR B.DMN_LNM LIKE  '%' || #{dmnLnm,jdbcType=VARCHAR} || '%')
		   </if>
		 </where>
		 ORDER BY GAP_STATUS, DMN_LNM, A.CD_VAL
	</select>
<select id="selectCmpCodeGapMetaReal" parameterType="kr.wise.meta.gap.service.CodeGapVO" resultMap="BaseResultMap">
SELECT B.DMN_ID
       ,B.DMN_LNM
       ,B.DMN_PNM
       ,T.DB_CONN_TRG_PNM AS TGT_DB_CONN_TRG_PNM
       ,T.DB_CONN_TRG_ID
       ,S.DB_SCH_PNM      AS TGT_DB_SCH_PNM
       ,S.DB_SCH_ID
       ,A.*
		     , CASE WHEN A.GAP_STATUS = 'GAP' THEN '#FF0000' END AS FontColor
		  FROM (
		        SELECT CASE WHEN    COALESCE(A.COEX_LVL_NO  ,0)   != COALESCE(B.COEX_LVL_NO    ,0)         
                                 OR COALESCE(A.COEX_CD_NM  ,'-')   != COALESCE(B.COEX_CD_NM    ,'-')         
                                 OR COALESCE(A.COEX_CD_STS_YN,'N')   != COALESCE(B.COEX_CD_STS_YN  ,'N')         
                                 OR COALESCE(A.ETC_CD1       ,'-')   != COALESCE(B.ETC_CD1         ,'-')         
                                 OR COALESCE(A.ETC_CD2       ,'-')   != COALESCE(B.ETC_CD2         ,'-')         
                                 OR COALESCE(A.ETC_CD3       ,'-')   != COALESCE(B.ETC_CD3         ,'-')         
                                 OR COALESCE(A.ETC_CD4       ,'-')   != COALESCE(B.ETC_CD4         ,'-')         
                                 OR COALESCE(A.ETC_CD5       ,'-')   != COALESCE(B.ETC_CD5         ,'-')         
                                 OR COALESCE(A.ETC_CD_NM1    ,'-')   != COALESCE(B.ETC_CD_NM1      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM2    ,'-')   != COALESCE(B.ETC_CD_NM2      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM3    ,'-')   != COALESCE(B.ETC_CD_NM3      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM4    ,'-')   != COALESCE(B.ETC_CD_NM4      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM5    ,'-')   != COALESCE(B.ETC_CD_NM5      ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN1 ,'-')   != COALESCE(B.CD_OUTL_CNTN1   ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN2 ,'-')   != COALESCE(B.CD_OUTL_CNTN2   ,'-')         
                                 OR COALESCE(A.ARY_SQNC_NO   ,0  )   != COALESCE(B.ARY_SQNC_NO     ,0  )         
                                 OR COALESCE(A.RMRK_CNTN     ,'-')   != COALESCE(B.RMRK_CNTN       ,'-')  THEN 'GAP'  
		                 ELSE 'NML' END AS GAP_STATUS
		                 ,CASE WHEN A.COEX_DTL_CD IS NULL THEN '[메타복잡코드미존재]'
                               WHEN B.COEX_DTL_CD IS NULL THEN '[개발복잡코드미존재]'
                               WHEN      COALESCE(A.COEX_LVL_NO  ,0)   != COALESCE(B.COEX_LVL_NO    ,0)         
                                 OR COALESCE(A.COEX_CD_NM  ,'-')   != COALESCE(B.COEX_CD_NM    ,'-')         
                                 OR COALESCE(A.COEX_CD_STS_YN,'N')   != COALESCE(B.COEX_CD_STS_YN  ,'N')         
                                 OR COALESCE(A.ETC_CD1       ,'-')   != COALESCE(B.ETC_CD1         ,'-')         
                                 OR COALESCE(A.ETC_CD2       ,'-')   != COALESCE(B.ETC_CD2         ,'-')         
                                 OR COALESCE(A.ETC_CD3       ,'-')   != COALESCE(B.ETC_CD3         ,'-')         
                                 OR COALESCE(A.ETC_CD4       ,'-')   != COALESCE(B.ETC_CD4         ,'-')         
                                 OR COALESCE(A.ETC_CD5       ,'-')   != COALESCE(B.ETC_CD5         ,'-')         
                                 OR COALESCE(A.ETC_CD_NM1    ,'-')   != COALESCE(B.ETC_CD_NM1      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM2    ,'-')   != COALESCE(B.ETC_CD_NM2      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM3    ,'-')   != COALESCE(B.ETC_CD_NM3      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM4    ,'-')   != COALESCE(B.ETC_CD_NM4      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM5    ,'-')   != COALESCE(B.ETC_CD_NM5      ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN1 ,'-')   != COALESCE(B.CD_OUTL_CNTN1   ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN2 ,'-')   != COALESCE(B.CD_OUTL_CNTN2   ,'-')         
                                 OR COALESCE(A.ARY_SQNC_NO   ,0  )   != COALESCE(B.ARY_SQNC_NO     ,0  )         
                                 OR COALESCE(A.RMRK_CNTN     ,'-')   != COALESCE(B.RMRK_CNTN       ,'-')  THEN '[코드GAP존재]'
		                 ELSE NULL END AS GAP_CONTS  
		               , COALESCE(A.COEX_DTL_CD,B.COEX_DTL_CD) AS CD_VAL
                       , A.COEX_UPRN_CD   AS UPP_CD_VAL
                       , A.COEX_LVL_NO    AS CODE_LEVEL
                       , A.COEX_CD_NM     AS CD_VAL_NM
                       , A.COEX_CD_STS_YN AS USE_YN
                       , A.ETC_CD1                             
                       , A.ETC_CD2                             
                       , A.ETC_CD3                             
                       , A.ETC_CD4                             
                       , A.ETC_CD5                             
                       , A.ETC_CD_NM1                          
                       , A.ETC_CD_NM2                          
                       , A.ETC_CD_NM3                          
                       , A.ETC_CD_NM4                          
                       , A.ETC_CD_NM5                          
                       , A.CD_OUTL_CNTN1                       
                       , A.CD_OUTL_CNTN2                       
                       , A.ARY_SQNC_NO    DISP_ORD                     
                       , A.RMRK_CNTN       
                       , B.COEX_DTL_CD    AS TGT_CD_VAL
                       , B.COEX_UPRN_CD   AS TGT_UPP_CD_VAL
                       , B.COEX_LVL_NO    AS TGT_CODE_LEVEL
                       , B.COEX_CD_NM     AS TGT_CD_VAL_NM
                       , B.COEX_CD_STS_YN AS TGT_USE_YN
                       , B.ETC_CD1         TGT_ETC_CD1         
                       , B.ETC_CD2         TGT_ETC_CD2         
                       , B.ETC_CD3         TGT_ETC_CD3         
                       , B.ETC_CD4         TGT_ETC_CD4         
                       , B.ETC_CD5         TGT_ETC_CD5         
                       , B.ETC_CD_NM1      TGT_ETC_CD_NM1      
                       , B.ETC_CD_NM2      TGT_ETC_CD_NM2      
                       , B.ETC_CD_NM3      TGT_ETC_CD_NM3      
                       , B.ETC_CD_NM4      TGT_ETC_CD_NM4      
                       , B.ETC_CD_NM5      TGT_ETC_CD_NM5      
                       , B.CD_OUTL_CNTN1   TGT_CD_OUTL_CNTN1   
                       , B.CD_OUTL_CNTN2   TGT_CD_OUTL_CNTN2   
                       , B.ARY_SQNC_NO     TGT_DISP_ORD
                       , B.RMRK_CNTN       TGT_RMRK_CNTN   
                       , B.DB_CONN_TRG_ID
                       , B.DB_SCH_ID
                       FROM V_TSF_COMPLEX_CD_LIST A
                       FULL OUTER JOIN WAT_TSF_CMP_CD B
                       ON A.COEX_DTL_CD = B.COEX_DTL_CD
                       AND A.COEX_UPRN_CD = B.COEX_UPRN_CD
                       AND A.DB_CONN_TRG_ID = A.DB_CONN_TRG_ID
                       AND A.DB_SCH_ID      = B.DB_SCH_ID
		        ) A 
                LEFT OUTER JOIN WAM_CD_VAL V
                ON A.CD_VAL = V.CD_VAL
                LEFT OUTER JOIN WAM_DMN B
                ON V.DMN_ID = B.DMN_ID
                OR A.CD_VAL_NM = B.DMN_LNM
                LEFT OUTER JOIN WAA_DB_SCH S
                ON A.DB_SCH_ID =S.DB_SCH_ID
                AND S.REG_TYP_CD IN ('C', 'U')
                AND S.EXP_DTM = TO_DATE('99991231', 'YYYYMMDD')
                AND S.DDL_TRG_DCD ='R'
                LEFT OUTER JOIN WAA_DB_CONN_TRG T
                ON A.DB_CONN_TRG_ID =T.DB_CONN_TRG_ID
                AND T.DB_CONN_TRG_ID = S.DB_CONN_TRG_ID
                AND T.REG_TYP_CD IN ('C', 'U')
                AND T.EXP_DTM = TO_DATE('99991231', 'YYYYMMDD')
		 <where>
		   <if test="gapStatus != null">
		   AND A.GAP_STATUS = #{gapStatus,jdbcType=VARCHAR}
		   </if>
		   <if test="dbConnTrgId != null">
		   AND T.DB_CONN_TRG_ID = #{dbConnTrgId,jdbcType=VARCHAR}
		   </if>
		   <if test="dbSchId != null">
		   AND S.DB_SCH_ID = #{dbSchId,jdbcType=VARCHAR}
		   </if>
		   <if test="codePnm != null">
		   AND (   A.CD_VAL LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.CD_VAL_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_CD_VAL LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_CD_VAL_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		)
		   </if>
		   <if test="dmnLnm!=null">
		   AND (B.DMN_LNM LIKE  '%' || #{dmnLnm,jdbcType=VARCHAR} || '%'
		        OR B.DMN_LNM LIKE  '%' || #{dmnLnm,jdbcType=VARCHAR} || '%')
		   </if>
		 </where>
		 ORDER BY GAP_STATUS, DMN_LNM, A.CD_VAL
	</select>
<select id="selectCmpCodeGapMetaTsf" parameterType="kr.wise.meta.gap.service.CodeGapVO" resultMap="BaseResultMap">
SELECT B.DMN_ID
       ,B.DMN_LNM
       ,B.DMN_PNM
       ,T.DB_CONN_TRG_PNM AS TGT_DB_CONN_TRG_PNM
       ,T.DB_CONN_TRG_ID
       ,S.DB_SCH_PNM      AS TGT_DB_SCH_PNM
       ,S.DB_SCH_ID
       ,A.*
		     , CASE WHEN A.GAP_STATUS = 'GAP' THEN '#FF0000' END AS FontColor
		  FROM (
		        SELECT CASE WHEN    COALESCE(A.COEX_LVL_NO  ,0)   != COALESCE(B.COEX_LVL_NO    ,0)         
                                 OR COALESCE(A.COEX_CD_NM  ,'-')   != COALESCE(B.COEX_CD_NM    ,'-')         
                                 OR COALESCE(A.COEX_CD_STS_YN,'N')   != COALESCE(B.COEX_CD_STS_YN  ,'N')         
                                 OR COALESCE(A.ETC_CD1       ,'-')   != COALESCE(B.ETC_CD1         ,'-')         
                                 OR COALESCE(A.ETC_CD2       ,'-')   != COALESCE(B.ETC_CD2         ,'-')         
                                 OR COALESCE(A.ETC_CD3       ,'-')   != COALESCE(B.ETC_CD3         ,'-')         
                                 OR COALESCE(A.ETC_CD4       ,'-')   != COALESCE(B.ETC_CD4         ,'-')         
                                 OR COALESCE(A.ETC_CD5       ,'-')   != COALESCE(B.ETC_CD5         ,'-')         
                                 OR COALESCE(A.ETC_CD_NM1    ,'-')   != COALESCE(B.ETC_CD_NM1      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM2    ,'-')   != COALESCE(B.ETC_CD_NM2      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM3    ,'-')   != COALESCE(B.ETC_CD_NM3      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM4    ,'-')   != COALESCE(B.ETC_CD_NM4      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM5    ,'-')   != COALESCE(B.ETC_CD_NM5      ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN1 ,'-')   != COALESCE(B.CD_OUTL_CNTN1   ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN2 ,'-')   != COALESCE(B.CD_OUTL_CNTN2   ,'-')         
                                 OR COALESCE(A.ARY_SQNC_NO   ,0  )   != COALESCE(B.ARY_SQNC_NO     ,0  )         
                                 OR COALESCE(A.RMRK_CNTN     ,'-')   != COALESCE(B.RMRK_CNTN       ,'-')  THEN 'GAP'  
		                 ELSE 'NML' END AS GAP_STATUS
		                 ,CASE WHEN A.COEX_DTL_CD IS NULL THEN '[메타복잡코드미존재]'
                               WHEN B.COEX_DTL_CD IS NULL THEN '[개발복잡코드미존재]'
                               WHEN      COALESCE(A.COEX_LVL_NO  ,0)   != COALESCE(B.COEX_LVL_NO    ,0)         
                                 OR COALESCE(A.COEX_CD_NM  ,'-')   != COALESCE(B.COEX_CD_NM    ,'-')         
                                 OR COALESCE(A.COEX_CD_STS_YN,'N')   != COALESCE(B.COEX_CD_STS_YN  ,'N')         
                                 OR COALESCE(A.ETC_CD1       ,'-')   != COALESCE(B.ETC_CD1         ,'-')         
                                 OR COALESCE(A.ETC_CD2       ,'-')   != COALESCE(B.ETC_CD2         ,'-')         
                                 OR COALESCE(A.ETC_CD3       ,'-')   != COALESCE(B.ETC_CD3         ,'-')         
                                 OR COALESCE(A.ETC_CD4       ,'-')   != COALESCE(B.ETC_CD4         ,'-')         
                                 OR COALESCE(A.ETC_CD5       ,'-')   != COALESCE(B.ETC_CD5         ,'-')         
                                 OR COALESCE(A.ETC_CD_NM1    ,'-')   != COALESCE(B.ETC_CD_NM1      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM2    ,'-')   != COALESCE(B.ETC_CD_NM2      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM3    ,'-')   != COALESCE(B.ETC_CD_NM3      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM4    ,'-')   != COALESCE(B.ETC_CD_NM4      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM5    ,'-')   != COALESCE(B.ETC_CD_NM5      ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN1 ,'-')   != COALESCE(B.CD_OUTL_CNTN1   ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN2 ,'-')   != COALESCE(B.CD_OUTL_CNTN2   ,'-')         
                                 OR COALESCE(A.ARY_SQNC_NO   ,0  )   != COALESCE(B.ARY_SQNC_NO     ,0  )         
                                 OR COALESCE(A.RMRK_CNTN     ,'-')   != COALESCE(B.RMRK_CNTN       ,'-')  THEN '[코드GAP존재]'
		                 ELSE NULL END AS GAP_CONTS  
		               , COALESCE(A.COEX_DTL_CD,B.COEX_DTL_CD) AS CD_VAL
                       , A.COEX_UPRN_CD   AS UPP_CD_VAL
                       , A.COEX_LVL_NO    AS CODE_LEVEL
                       , A.COEX_CD_NM     AS CD_VAL_NM
                       , A.COEX_CD_STS_YN AS USE_YN
                       , A.ETC_CD1                             
                       , A.ETC_CD2                             
                       , A.ETC_CD3                             
                       , A.ETC_CD4                             
                       , A.ETC_CD5                             
                       , A.ETC_CD_NM1                          
                       , A.ETC_CD_NM2                          
                       , A.ETC_CD_NM3                          
                       , A.ETC_CD_NM4                          
                       , A.ETC_CD_NM5                          
                       , A.CD_OUTL_CNTN1                       
                       , A.CD_OUTL_CNTN2                       
                       , A.ARY_SQNC_NO     DISP_ORD                    
                       , A.RMRK_CNTN       
                       , B.COEX_DTL_CD    AS TGT_CD_VAL
                       , B.COEX_UPRN_CD   AS TGT_UPP_CD_VAL
                       , B.COEX_LVL_NO    AS TGT_CODE_LEVEL
                       , B.COEX_CD_NM     AS TGT_CD_VAL_NM
                       , B.COEX_CD_STS_YN AS TGT_USE_YN
                       , B.ETC_CD1         TGT_ETC_CD1         
                       , B.ETC_CD2         TGT_ETC_CD2         
                       , B.ETC_CD3         TGT_ETC_CD3         
                       , B.ETC_CD4         TGT_ETC_CD4         
                       , B.ETC_CD5         TGT_ETC_CD5         
                       , B.ETC_CD_NM1      TGT_ETC_CD_NM1      
                       , B.ETC_CD_NM2      TGT_ETC_CD_NM2      
                       , B.ETC_CD_NM3      TGT_ETC_CD_NM3      
                       , B.ETC_CD_NM4      TGT_ETC_CD_NM4      
                       , B.ETC_CD_NM5      TGT_ETC_CD_NM5      
                       , B.CD_OUTL_CNTN1   TGT_CD_OUTL_CNTN1   
                       , B.CD_OUTL_CNTN2   TGT_CD_OUTL_CNTN2   
                       , B.ARY_SQNC_NO     TGT_DISP_ORD 
                       , B.RMRK_CNTN       TGT_RMRK_CNTN   
                       , B.DB_CONN_TRG_ID
                       , B.DB_SCH_ID
                       FROM V_COMPLEX_CD_LIST A
                       FULL OUTER JOIN V_TSF_COMPLEX_CD_LIST B
                       ON A.COEX_DTL_CD = B.COEX_DTL_CD
                       AND A.COEX_UPRN_CD = B.COEX_UPRN_CD
		        ) A 
                LEFT OUTER JOIN WAM_CD_VAL V
                ON A.CD_VAL = V.CD_VAL
                LEFT OUTER JOIN WAM_DMN B
                ON V.DMN_ID = B.DMN_ID
                OR A.CD_VAL_NM = B.DMN_LNM
                LEFT OUTER JOIN WAA_DB_SCH S
                ON A.DB_SCH_ID =S.DB_SCH_ID
                AND S.REG_TYP_CD IN ('C', 'U')
                AND S.EXP_DTM = TO_DATE('99991231', 'YYYYMMDD')
                AND S.DDL_TRG_DCD ='R'
                LEFT OUTER JOIN WAA_DB_CONN_TRG T
                ON A.DB_CONN_TRG_ID =T.DB_CONN_TRG_ID
                AND T.DB_CONN_TRG_ID = S.DB_CONN_TRG_ID
                AND T.REG_TYP_CD IN ('C', 'U')
                AND T.EXP_DTM = TO_DATE('99991231', 'YYYYMMDD')
		 <where>
		   <if test="gapStatus != null">
		   AND A.GAP_STATUS = #{gapStatus,jdbcType=VARCHAR}
		   </if>
		   <if test="dbConnTrgId != null">
		   AND T.DB_CONN_TRG_ID = #{dbConnTrgId,jdbcType=VARCHAR}
		   </if>
		   <if test="dbSchId != null">
		   AND S.DB_SCH_ID = #{dbSchId,jdbcType=VARCHAR}
		   </if>
		   <if test="codePnm != null">
		   AND (   A.CD_VAL LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.CD_VAL_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_CD_VAL LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_CD_VAL_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		)
		   </if>
		   <if test="dmnLnm!=null">
		   AND (B.DMN_LNM LIKE  '%' || #{dmnLnm,jdbcType=VARCHAR} || '%'
		        OR B.DMN_LNM LIKE  '%' || #{dmnLnm,jdbcType=VARCHAR} || '%')
		   </if>
		 </where>
		 ORDER BY GAP_STATUS, DMN_LNM, A.CD_VAL
	</select>
	<select id="selectCmpCodeGapDevReal" parameterType="kr.wise.meta.gap.service.CodeGapVO" resultMap="BaseResultMap">
SELECT B.DMN_ID
       ,B.DMN_LNM
       ,B.DMN_PNM
       ,T.DB_CONN_TRG_PNM AS TGT_DB_CONN_TRG_PNM
       ,T.DB_CONN_TRG_ID
       ,S.DB_SCH_PNM      AS TGT_DB_SCH_PNM
       ,S.DB_SCH_ID
       ,A.*
		     , CASE WHEN A.GAP_STATUS = 'GAP' THEN '#FF0000' END AS FontColor
		  FROM (
		        SELECT CASE WHEN    COALESCE(A.COEX_LVL_NO  ,0)   != COALESCE(B.COEX_LVL_NO    ,0)         
                                 OR COALESCE(A.COEX_CD_NM  ,'-')   != COALESCE(B.COEX_CD_NM    ,'-')         
                                 OR COALESCE(A.COEX_CD_STS_YN,'N')   != COALESCE(B.COEX_CD_STS_YN  ,'N')         
                                 OR COALESCE(A.ETC_CD1       ,'-')   != COALESCE(B.ETC_CD1         ,'-')         
                                 OR COALESCE(A.ETC_CD2       ,'-')   != COALESCE(B.ETC_CD2         ,'-')         
                                 OR COALESCE(A.ETC_CD3       ,'-')   != COALESCE(B.ETC_CD3         ,'-')         
                                 OR COALESCE(A.ETC_CD4       ,'-')   != COALESCE(B.ETC_CD4         ,'-')         
                                 OR COALESCE(A.ETC_CD5       ,'-')   != COALESCE(B.ETC_CD5         ,'-')         
                                 OR COALESCE(A.ETC_CD_NM1    ,'-')   != COALESCE(B.ETC_CD_NM1      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM2    ,'-')   != COALESCE(B.ETC_CD_NM2      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM3    ,'-')   != COALESCE(B.ETC_CD_NM3      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM4    ,'-')   != COALESCE(B.ETC_CD_NM4      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM5    ,'-')   != COALESCE(B.ETC_CD_NM5      ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN1 ,'-')   != COALESCE(B.CD_OUTL_CNTN1   ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN2 ,'-')   != COALESCE(B.CD_OUTL_CNTN2   ,'-')         
                                 OR COALESCE(A.ARY_SQNC_NO   ,0  )   != COALESCE(B.ARY_SQNC_NO     ,0  )         
                                 OR COALESCE(A.RMRK_CNTN     ,'-')   != COALESCE(B.RMRK_CNTN       ,'-')  THEN 'GAP'  
		                 ELSE 'NML' END AS GAP_STATUS
		                 ,CASE WHEN A.COEX_DTL_CD IS NULL THEN '[메타복잡코드미존재]'
                               WHEN B.COEX_DTL_CD IS NULL THEN '[개발복잡코드미존재]'
                               WHEN      COALESCE(A.COEX_LVL_NO  ,0)   != COALESCE(B.COEX_LVL_NO    ,0)         
                                 OR COALESCE(A.COEX_CD_NM  ,'-')   != COALESCE(B.COEX_CD_NM    ,'-')         
                                 OR COALESCE(A.COEX_CD_STS_YN,'N')   != COALESCE(B.COEX_CD_STS_YN  ,'N')         
                                 OR COALESCE(A.ETC_CD1       ,'-')   != COALESCE(B.ETC_CD1         ,'-')         
                                 OR COALESCE(A.ETC_CD2       ,'-')   != COALESCE(B.ETC_CD2         ,'-')         
                                 OR COALESCE(A.ETC_CD3       ,'-')   != COALESCE(B.ETC_CD3         ,'-')         
                                 OR COALESCE(A.ETC_CD4       ,'-')   != COALESCE(B.ETC_CD4         ,'-')         
                                 OR COALESCE(A.ETC_CD5       ,'-')   != COALESCE(B.ETC_CD5         ,'-')         
                                 OR COALESCE(A.ETC_CD_NM1    ,'-')   != COALESCE(B.ETC_CD_NM1      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM2    ,'-')   != COALESCE(B.ETC_CD_NM2      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM3    ,'-')   != COALESCE(B.ETC_CD_NM3      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM4    ,'-')   != COALESCE(B.ETC_CD_NM4      ,'-')         
                                 OR COALESCE(A.ETC_CD_NM5    ,'-')   != COALESCE(B.ETC_CD_NM5      ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN1 ,'-')   != COALESCE(B.CD_OUTL_CNTN1   ,'-')         
                                 OR COALESCE(A.CD_OUTL_CNTN2 ,'-')   != COALESCE(B.CD_OUTL_CNTN2   ,'-')         
                                 OR COALESCE(A.ARY_SQNC_NO   ,0  )   != COALESCE(B.ARY_SQNC_NO     ,0  )         
                                 OR COALESCE(A.RMRK_CNTN     ,'-')   != COALESCE(B.RMRK_CNTN       ,'-')  THEN '[코드GAP존재]'
		                 ELSE NULL END AS GAP_CONTS  
		               , COALESCE(A.COEX_DTL_CD,B.COEX_DTL_CD) AS CD_VAL
                       , A.COEX_UPRN_CD   AS UPP_CD_VAL
                       , A.COEX_LVL_NO    AS CODE_LEVEL
                       , A.COEX_CD_NM     AS CD_VAL_NM
                       , A.COEX_CD_STS_YN AS USE_YN
                       , A.ETC_CD1                             
                       , A.ETC_CD2                             
                       , A.ETC_CD3                             
                       , A.ETC_CD4                             
                       , A.ETC_CD5                             
                       , A.ETC_CD_NM1                          
                       , A.ETC_CD_NM2                          
                       , A.ETC_CD_NM3                          
                       , A.ETC_CD_NM4                          
                       , A.ETC_CD_NM5                          
                       , A.CD_OUTL_CNTN1                       
                       , A.CD_OUTL_CNTN2                       
                       , A.ARY_SQNC_NO     DISP_ORD                    
                       , A.RMRK_CNTN       
                       , B.COEX_DTL_CD    AS TGT_CD_VAL
                       , B.COEX_UPRN_CD   AS TGT_UPP_CD_VAL
                       , B.COEX_LVL_NO    AS TGT_CODE_LEVEL
                       , B.COEX_CD_NM     AS TGT_CD_VAL_NM
                       , B.COEX_CD_STS_YN AS TGT_USE_YN
                       , B.ETC_CD1         TGT_ETC_CD1         
                       , B.ETC_CD2         TGT_ETC_CD2         
                       , B.ETC_CD3         TGT_ETC_CD3         
                       , B.ETC_CD4         TGT_ETC_CD4         
                       , B.ETC_CD5         TGT_ETC_CD5         
                       , B.ETC_CD_NM1      TGT_ETC_CD_NM1      
                       , B.ETC_CD_NM2      TGT_ETC_CD_NM2      
                       , B.ETC_CD_NM3      TGT_ETC_CD_NM3      
                       , B.ETC_CD_NM4      TGT_ETC_CD_NM4      
                       , B.ETC_CD_NM5      TGT_ETC_CD_NM5      
                       , B.CD_OUTL_CNTN1   TGT_CD_OUTL_CNTN1   
                       , B.CD_OUTL_CNTN2   TGT_CD_OUTL_CNTN2   
                       , B.ARY_SQNC_NO     TGT_DISP_ORD 
                       , B.RMRK_CNTN       TGT_RMRK_CNTN   
                       , B.DB_CONN_TRG_ID
                       , B.DB_SCH_ID
                       FROM WAT_CMP_CD A
                       FULL OUTER JOIN WAT_TSF_CMP_CD B
                       ON A.COEX_DTL_CD = B.COEX_DTL_CD
                       AND A.COEX_UPRN_CD = B.COEX_UPRN_CD
		        ) A 
                LEFT OUTER JOIN WAM_CD_VAL V
                ON A.CD_VAL = V.CD_VAL
                LEFT OUTER JOIN WAM_DMN B
                ON V.DMN_ID = B.DMN_ID
                OR A.CD_VAL_NM = B.DMN_LNM
                LEFT OUTER JOIN WAA_DB_SCH S
                ON A.DB_SCH_ID =S.DB_SCH_ID
                AND S.REG_TYP_CD IN ('C', 'U')
                AND S.EXP_DTM = TO_DATE('99991231', 'YYYYMMDD')
                AND S.DDL_TRG_DCD ='R'
                LEFT OUTER JOIN WAA_DB_CONN_TRG T
                ON A.DB_CONN_TRG_ID =T.DB_CONN_TRG_ID
                AND T.DB_CONN_TRG_ID = S.DB_CONN_TRG_ID
                AND T.REG_TYP_CD IN ('C', 'U')
                AND T.EXP_DTM = TO_DATE('99991231', 'YYYYMMDD')
		 <where>
		   <if test="gapStatus != null">
		   AND A.GAP_STATUS = #{gapStatus,jdbcType=VARCHAR}
		   </if>
		   <if test="dbConnTrgId != null">
		   AND T.DB_CONN_TRG_ID = #{dbConnTrgId,jdbcType=VARCHAR}
		   </if>
		   <if test="dbSchId != null">
		   AND S.DB_SCH_ID = #{dbSchId,jdbcType=VARCHAR}
		   </if>
		   <if test="codePnm != null">
		   AND (   A.CD_VAL LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.CD_VAL_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_CD_VAL LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		OR A.TGT_CD_VAL_NM LIKE '%' || #{codePnm,jdbcType=VARCHAR} || '%'
		   		)
		   </if>
		   <if test="dmnLnm!=null">
		   AND (B.DMN_LNM LIKE  '%' || #{dmnLnm,jdbcType=VARCHAR} || '%'
		        OR B.DMN_LNM LIKE  '%' || #{dmnLnm,jdbcType=VARCHAR} || '%')
		   </if>
		 </where>
		 ORDER BY GAP_STATUS, DMN_LNM, A.CD_VAL
	</select>
</mapper>