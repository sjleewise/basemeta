<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="kr.wise.commons.rqstmst.service.WaqRqstChgDtlsMapper" >
  <resultMap id="BaseResultMap" type="kr.wise.commons.rqstmst.service.WaqRqstChgDtls" >
    <id column="RQST_NO" property="rqstNo" jdbcType="VARCHAR" />
    <id column="RQST_SNO" property="rqstSno" jdbcType="DECIMAL" />
    <result column="ITEM_NM" property="itemNm" jdbcType="VARCHAR" />
    <result column="AFTER_CHG" property="afterChg" jdbcType="VARCHAR" />
    <result column="BEFORE_CHG" property="beforeChg" jdbcType="VARCHAR" />    
  </resultMap>
 
<select id="selectStwdChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
   SELECT RQST_NO
            ,RQST_SNO
            ,ITEM_NM
            ,AFTER_DATA AS "AFTER_CHG"
         	,BEFORE_DATA AS "BEFORE_CHG"
            <![CDATA[
            , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
            ]]>
     FROM (
    SELECT  RQST_NO
          , RQST_SNO
          , B.NO
          ,(CASE WHEN B.NO = 1 THEN '표준단어논리명'
                 WHEN B.NO = 2 THEN '표준단어물리명'
                 WHEN B.NO = 3 THEN '영문의미'
                 WHEN B.NO = 4 THEN '한자명'
                 WHEN B.NO = 5 THEN '출처구분'     
                 WHEN B.NO = 6 THEN '설명'
<!--                  WHEN B.NO = 7 THEN '표준단어구분' -->
            ELSE NULL END) AS ITEM_NM          
          ,(CASE WHEN B.NO = 1 THEN AFTER_STWD_LNM
                 WHEN B.NO = 2 THEN AFTER_STWD_PNM
                 WHEN B.NO = 3 THEN AFTER_ENG_MEAN
                 WHEN B.NO = 4 THEN AFTER_CCH_NM
                 WHEN B.NO = 5 THEN AFTER_ORG_DS
                 WHEN B.NO = 6 THEN AFTER_OBJ_DESCN
<!--                  WHEN B.NO = 7 THEN AFTER_COMM_DTL_CD_NM               -->
            ELSE NULL END) AS AFTER_DATA          
          ,(CASE WHEN B.NO = 1 THEN BEFORE_STWD_LNM
                 WHEN B.NO = 2 THEN BEFORE_STWD_PNM
                 WHEN B.NO = 3 THEN BEFORE_ENG_MEAN
                 WHEN B.NO = 4 THEN BEFORE_CCH_NM
                 WHEN B.NO = 5 THEN BEFORE_ORG_DS       
                 WHEN B.NO = 6 THEN BEFORE_OBJ_DESCN
<!--                  WHEN B.NO = 7 THEN BEFORE_COMM_DTL_CD_NM                -->
            ELSE NULL END) AS BEFORE_DATA  
   from   (SELECT A.RQST_NO
                  ,A.RQST_SNO
                  ,A.STWD_LNM AS AFTER_STWD_LNM
                  ,A.STWD_PNM AS AFTER_STWD_PNM
                  ,A.ENG_MEAN AS AFTER_ENG_MEAN
                  ,A.CCH_NM AS AFTER_CCH_NM
                  ,A.ORG_DS AS AFTER_ORG_DS
                  ,A.WD_DCD AS AFTER_WD_DCD           
                  ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
<!--                   ,C.COMM_DTL_CD_NM AS AFTER_COMM_DTL_CD_NM -->
                  ,B.STWD_LNM AS BEFORE_STWD_LNM
                  ,B.STWD_PNM AS BEFORE_STWD_PNM
                  ,B.ENG_MEAN AS BEFORE_ENG_MEAN
                  ,B.CCH_NM AS BEFORE_CCH_NM
                  ,B.ORG_DS AS BEFORE_ORG_DS
                  ,B.WD_DCD AS BEFORE_WD_DCD
                  ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
<!--                   ,D.COMM_DTL_CD_NM AS BEFORE_COMM_DTL_CD_NM -->
             FROM WAQ_STWD A
                  LEFT JOIN WAH_STWD B
                    ON B.STND_ASRT = A.STND_ASRT 
                   <choose>
	                   	<when test='stwdKeyDcd eq "H" '> 
	                   		AND B.STWD_PNM = A.STWD_PNM
	                   	</when>
	                   	<when test='stwdKeyDcd eq "A" '>  
	                   		AND B.STWD_LNM = A.STWD_LNM                           
	                   	</when>
	                   	<otherwise>
	                   		AND B.STWD_LNM = A.STWD_LNM    
	                   		AND B.STWD_PNM = A.STWD_PNM
	                   	</otherwise>
                   </choose> 
                    
                  LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                     FROM WAA_COMM_DCD A
                                          INNER JOIN WAA_COMM_DTL_CD B
                                             ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                            AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                            AND B.REG_TYP_CD IN ('C', 'U')
                                   WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                     AND A.REG_TYP_CD IN ('C', 'U')
                                     AND A.COMM_DCD = 'WD_DCD'
                                   ) C   
                    ON A.WD_DCD = C.COMM_DTL_CD
                  LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                     FROM WAA_COMM_DCD A
                                          INNER JOIN WAA_COMM_DTL_CD B
                                             ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                            AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                            AND B.REG_TYP_CD IN ('C', 'U')
                                   WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                     AND A.REG_TYP_CD IN ('C', 'U')
                                     AND A.COMM_DCD = 'WD_DCD'
                                   ) D   
                    ON A.WD_DCD = D.COMM_DTL_CD             
            WHERE B.REG_TYP_CD IN ('C','U')
              AND A.RQST_DTM BETWEEN B.STR_DTM AND B.EXP_DTM  
              AND A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
              AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
          ) A , (SELECT SEQ AS NO FROM seq_1_to_6) B
      )A
      ORDER BY NO
  </select>
  
  <select id="selectDmnChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
    SELECT RQST_NO
             ,RQST_SNO
             ,ITEM_NM
             ,AFTER_DATA AS "AFTER_CHG"
         	 ,BEFORE_DATA AS "BEFORE_CHG"
            <![CDATA[
            , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
            ]]>
      FROM (
     select  RQST_NO
           , RQST_SNO
           , B.NO
           ,(CASE WHEN B.NO = 1 THEN '도메인논리명'
                  WHEN B.NO = 2 THEN '도메인물리명'
                  WHEN B.NO = 3 THEN '부모도메인명'
                  WHEN B.NO = 4 THEN '논리명기준구분'
                  WHEN B.NO = 5 THEN '물리명기준구분'
                  WHEN B.NO = 6 THEN '도메인그룹명'     
                  WHEN B.NO = 7 THEN '인포타입명'
                  WHEN B.NO = 8 THEN '코드값유형'
                  WHEN B.NO = 9 THEN '코드값부여방식'
                  WHEN B.NO = 10 THEN '목록엔터티논리명'
                  WHEN B.NO = 11 THEN '목록엔터티물리명'
                  WHEN B.NO = 12 THEN '목록어트리뷰트논리명'
                  WHEN B.NO = 13 THEN '목록어트리뷰트물리명'
                  WHEN B.NO = 14 THEN '데이터형식'
                  WHEN B.NO = 15 THEN '설명'
                  WHEN B.NO = 16 THEN '출처구분'
                  WHEN B.NO = 17 THEN '출처내용'
                  WHEN B.NO = 18 THEN '담당자명'
                  WHEN B.NO = 19 THEN '데이터타입'
                  WHEN B.NO = 20 THEN '데이터길이'
                  WHEN B.NO = 21 THEN '데이터소수점길이'
                  WHEN B.NO = 22 THEN '암호화여부'
                  
             ELSE NULL END) AS ITEM_NM          
           ,(CASE WHEN B.NO = 1 THEN AFTER_DMN_LNM
                  WHEN B.NO = 2 THEN AFTER_DMN_PNM
                  WHEN B.NO = 3 THEN AFTER_UPP_DMN_LNM
                  WHEN B.NO = 4 THEN AFTER_LNM_CRI_DS
                  WHEN B.NO = 5 THEN AFTER_PNM_CRI_DS
                  WHEN B.NO = 6 THEN AFTER_DMNG_LNM
                  WHEN B.NO = 7 THEN AFTER_INFOTP_LNM
                  WHEN B.NO = 8 THEN AFTER_CD_VAL_TYP_CD             
                  WHEN B.NO = 9 THEN AFTER_CD_VAL_IVW_CD
                  WHEN B.NO = 10 THEN AFTER_LST_ENTY_LNM
                  WHEN B.NO = 11 THEN AFTER_LST_ENTY_PNM
                  WHEN B.NO = 12 THEN AFTER_LST_ATTR_LNM
                  WHEN B.NO = 13 THEN AFTER_LST_ATTR_PNM              
                  WHEN B.NO = 14 THEN AFTER_DATA_FRM
                  WHEN B.NO = 15 THEN AFTER_OBJ_DESCN
                  WHEN B.NO = 16 THEN AFTER_DMN_ORG_DS
                  WHEN B.NO = 17 THEN AFTER_DMN_ORG_TXT
                  WHEN B.NO = 18 THEN AFTER_CRG_USER_NM
                  WHEN B.NO = 19 THEN AFTER_DATA_TYPE
                  WHEN B.NO = 20 THEN CONCAT(AFTER_DATA_LEN)              
                  WHEN B.NO = 21 THEN CONCAT(AFTER_DATA_SCAL)
                  WHEN B.NO = 22 THEN AFTER_ENC_YN
             ELSE NULL END) AS AFTER_DATA            
           ,(CASE WHEN B.NO = 1 THEN BEFORE_DMN_LNM
                  WHEN B.NO = 2 THEN BEFORE_DMN_PNM
                  WHEN B.NO = 3 THEN BEFORE_UPP_DMN_LNM
                  WHEN B.NO = 4 THEN BEFORE_LNM_CRI_DS
                  WHEN B.NO = 5 THEN BEFORE_PNM_CRI_DS
                  WHEN B.NO = 6 THEN BEFORE_DMNG_LNM
                  WHEN B.NO = 7 THEN BEFORE_INFOTP_LNM
                  WHEN B.NO = 8 THEN BEFORE_CD_VAL_TYP_CD             
                  WHEN B.NO = 9 THEN BEFORE_CD_VAL_IVW_CD
                  WHEN B.NO = 10 THEN BEFORE_LST_ENTY_LNM
                  WHEN B.NO = 11 THEN BEFORE_LST_ENTY_PNM
                  WHEN B.NO = 12 THEN BEFORE_LST_ATTR_LNM
                  WHEN B.NO = 13 THEN BEFORE_LST_ATTR_PNM              
                  WHEN B.NO = 14 THEN BEFORE_DATA_FRM
                  WHEN B.NO = 15 THEN BEFORE_OBJ_DESCN
                  WHEN B.NO = 16 THEN BEFORE_DMN_ORG_DS
                  WHEN B.NO = 17 THEN BEFORE_DMN_ORG_TXT
                  WHEN B.NO = 18 THEN BEFORE_CRG_USER_NM
                  WHEN B.NO = 19 THEN BEFORE_DATA_TYPE
                  WHEN B.NO = 20 THEN CONCAT(BEFORE_DATA_LEN)              
                  WHEN B.NO = 21 THEN CONCAT(BEFORE_DATA_SCAL)  
                  WHEN B.NO = 22 THEN BEFORE_ENC_YN    
             ELSE NULL END) AS BEFORE_DATA    
       FROM (SELECT A.RQST_NO
                   ,A.RQST_SNO
                   ,A.DMN_LNM AS AFTER_DMN_LNM
                   ,A.DMN_PNM AS AFTER_DMN_PNM
                    ,NULLIF(A.UPP_DMN_LNM,'') AS AFTER_UPP_DMN_LNM
                   ,A.LNM_CRI_DS AS AFTER_LNM_CRI_DS
                   ,A.PNM_CRI_DS AS AFTER_PNM_CRI_DS
                   ,A.DMNG_LNM AS AFTER_DMNG_LNM
                   ,A.INFOTP_LNM AS AFTER_INFOTP_LNM           
                   ,D.COMM_DTL_CD_NM AS AFTER_CD_VAL_TYP_CD
                   ,E.COMM_DTL_CD_NM AS AFTER_CD_VAL_IVW_CD
                   ,A.LST_ENTY_LNM AS AFTER_LST_ENTY_LNM
                   ,A.LST_ENTY_PNM AS AFTER_LST_ENTY_PNM
                   ,A.LST_ATTR_LNM AS AFTER_LST_ATTR_LNM
                   ,A.LST_ATTR_PNM AS AFTER_LST_ATTR_PNM
                   ,A.DATA_FRM AS AFTER_DATA_FRM
                   ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
                   ,M.COMM_DTL_CD_NM AS AFTER_DMN_ORG_DS
                   ,A.DMN_ORG_TXT AS AFTER_DMN_ORG_TXT
                   ,A.CRG_USER_NM AS AFTER_CRG_USER_NM
                   ,A.DATA_TYPE AS AFTER_DATA_TYPE
                   ,A.DATA_LEN AS AFTER_DATA_LEN
                   ,A.DATA_SCAL AS AFTER_DATA_SCAL
                   ,B.DMN_LNM AS BEFORE_DMN_LNM
                   ,B.DMN_PNM AS BEFORE_DMN_PNM
                   ,NULLIF(G.DMN_LNM,'') AS BEFORE_UPP_DMN_LNM
                   ,B.LNM_CRI_DS AS BEFORE_LNM_CRI_DS
                   ,B.PNM_CRI_DS AS BEFORE_PNM_CRI_DS
                   ,H.DMNG_LNM AS BEFORE_DMNG_LNM
                   ,I.INFOTP_LNM AS BEFORE_INFOTP_LNM           
                   ,J.COMM_DTL_CD_NM AS BEFORE_CD_VAL_TYP_CD
                   ,K.COMM_DTL_CD_NM AS BEFORE_CD_VAL_IVW_CD
                   ,B.LST_ENTY_LNM AS BEFORE_LST_ENTY_LNM
                   ,B.LST_ENTY_PNM AS BEFORE_LST_ENTY_PNM
                   ,B.LST_ATTR_LNM AS BEFORE_LST_ATTR_LNM
                   ,B.LST_ATTR_PNM AS BEFORE_LST_ATTR_PNM
                   ,B.DATA_FRM AS BEFORE_DATA_FRM
                   ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
                   ,N.COMM_DTL_CD_NM AS BEFORE_DMN_ORG_DS
                   ,B.DMN_ORG_TXT AS BEFORE_DMN_ORG_TXT
                   ,L.USER_NM AS BEFORE_CRG_USER_NM
                   ,I.DATA_TYPE AS BEFORE_DATA_TYPE
                   ,I.DATA_LEN AS BEFORE_DATA_LEN
                   ,I.DATA_SCAL AS BEFORE_DATA_SCAL
                   ,A.ENC_YN AS AFTER_ENC_YN
                   ,B.ENC_YN AS BEFORE_ENC_YN
              FROM WAQ_DMN A
                   LEFT JOIN WAH_DMN B
                     ON A.STND_ASRT = B.STND_ASRT
                    AND A.DMN_LNM = B.DMN_LNM
                   LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                      FROM WAA_COMM_DCD A
                                           INNER JOIN WAA_COMM_DTL_CD B
                                              ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                             AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                             AND B.REG_TYP_CD IN ('C', 'U')
                                    WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                      AND A.REG_TYP_CD IN ('C', 'U')
                                      AND A.COMM_DCD = 'CD_VAL_TYP_CD'
                                    ) D   
                     ON A.CD_VAL_TYP_CD = D.COMM_DTL_CD
                   LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                      FROM WAA_COMM_DCD A
                                           INNER JOIN WAA_COMM_DTL_CD B
                                              ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                             AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                             AND B.REG_TYP_CD IN ('C', 'U')
                                    WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                      AND A.REG_TYP_CD IN ('C', 'U')
                                      AND A.COMM_DCD = 'CD_VAL_IVW_CD'
                                    ) E
                     ON A.CD_VAL_IVW_CD = E.COMM_DTL_CD
    			   LEFT OUTER JOIN (SELECT DMN_ID, DMN_LNM, STND_ASRT
                                      FROM WAM_DMN
                                     WHERE REG_TYP_CD IN ('C', 'U')
                                   ) G
                     ON B.UPP_DMN_ID = G.DMN_ID
                    AND B.STND_ASRT = G.STND_ASRT
                   LEFT OUTER JOIN (SELECT DMNG_ID, DMNG_LNM
                                      FROM WAA_DMNG
                                     WHERE EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                   ) H
                     ON B.DMNG_ID = H.DMNG_ID
                   LEFT OUTER JOIN (SELECT INFOTP_ID
                                         , INFOTP_LNM
                                         , DATA_TYPE
                                         , DATA_LEN
                                         , DATA_SCAL
                                      FROM WAA_INFO_TYPE
                                     WHERE EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                   ) I
                     ON B.INFOTP_ID = I.INFOTP_ID
                   LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                      FROM WAA_COMM_DCD A
                                           INNER JOIN WAA_COMM_DTL_CD B
                                              ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                             AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                             AND B.REG_TYP_CD IN ('C', 'U')
                                    WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                      AND A.REG_TYP_CD IN ('C', 'U')
                                      AND A.COMM_DCD = 'CD_VAL_TYP_CD'
                                    ) J   
                     ON B.CD_VAL_TYP_CD = J.COMM_DTL_CD
                   LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                      FROM WAA_COMM_DCD A
                                           INNER JOIN WAA_COMM_DTL_CD B
                                              ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                             AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                             AND B.REG_TYP_CD IN ('C', 'U')
                                    WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                      AND A.REG_TYP_CD IN ('C', 'U')
                                      AND A.COMM_DCD = 'CD_VAL_IVW_CD'
                                    ) K
                     ON B.CD_VAL_IVW_CD = K.COMM_DTL_CD
                   LEFT OUTER JOIN (SELECT USER_ID, USER_NM
                                      FROM WAA_USER
                                     WHERE EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                       AND REG_TYP_CD IN ('C', 'U')
                                   ) L
                     ON B.CRG_USER_ID = L.USER_ID
                   LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                      FROM WAA_COMM_DCD A
                                           INNER JOIN WAA_COMM_DTL_CD B
                                              ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                             AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                             AND B.REG_TYP_CD IN ('C', 'U')
                                    WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                      AND A.REG_TYP_CD IN ('C', 'U')
                                      AND A.COMM_DCD = 'CD_VAL_IVW_CD'
                                    ) M
                     ON A.DMN_ORG_DS = M.COMM_DTL_CD
                   LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                      FROM WAA_COMM_DCD A
                                           INNER JOIN WAA_COMM_DTL_CD B
                                              ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                             AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                             AND B.REG_TYP_CD IN ('C', 'U')
                                    WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                      AND A.REG_TYP_CD IN ('C', 'U')
                                      AND A.COMM_DCD = 'CD_VAL_IVW_CD'
                                    ) N
                     ON B.DMN_ORG_DS = N.COMM_DTL_CD
             WHERE B.REG_TYP_CD IN ('C','U')
               AND A.RQST_DTM BETWEEN B.STR_DTM AND B.EXP_DTM  
               AND A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
               AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
           ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_21) B
       )A
       ORDER BY NO
  </select>
  <select id="selectItemChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
   SELECT RQST_NO
            ,RQST_SNO
            ,ITEM_NM
            ,AFTER_DATA AS "AFTER_CHG"
         	,BEFORE_DATA AS "BEFORE_CHG"
            <![CDATA[
            , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
            ]]>
     FROM (
    SELECT  RQST_NO
          , RQST_SNO
          , B.NO
          ,(CASE WHEN B.NO = 1 THEN '표준용어논리명'
                 WHEN B.NO = 2 THEN '표준용어물리명'
                 WHEN B.NO = 3 THEN '논리명기준구분'
                 WHEN B.NO = 4 THEN '물리명기준구분'
                 WHEN B.NO = 5 THEN '도메인명'
                 WHEN B.NO = 6 THEN '도메인그룹명'     
                 WHEN B.NO = 7 THEN '인포타입명'
                 WHEN B.NO = 8 THEN '데이터타입'
                 WHEN B.NO = 9 THEN '데이터길이'
                 WHEN B.NO = 10 THEN '데이터소수점길이'
                 WHEN B.NO = 11 THEN '암호화여부'
                 WHEN B.NO = 12 THEN '테스트데이터변환여부'
                 WHEN B.NO = 13 THEN '설명'
                 
            ELSE NULL END) AS ITEM_NM          
          ,(CASE WHEN B.NO = 1 THEN AFTER_SDITM_LNM
                 WHEN B.NO = 2 THEN AFTER_SDITM_PNM
                 WHEN B.NO = 3 THEN AFTER_LNM_CRI_DS
                 WHEN B.NO = 4 THEN AFTER_PNM_CRI_DS
                 WHEN B.NO = 5 THEN AFTER_DMN_LNM
                 WHEN B.NO = 6 THEN AFTER_DMNG_LNM
                 WHEN B.NO = 7 THEN AFTER_INFOTP_LNM
                 WHEN B.NO = 8 THEN AFTER_DATA_TYPE
                 WHEN B.NO = 9 THEN CONCAT(AFTER_DATA_LEN)              
                 WHEN B.NO = 10 THEN CONCAT(AFTER_DATA_SCAL)
                 WHEN B.NO = 11 THEN AFTER_ENC_YN
                 WHEN B.NO = 12 THEN AFTER_TEST_DATA_CNV_YN
                 WHEN B.NO = 13 THEN AFTER_OBJ_DESCN
            ELSE NULL END) AS AFTER_DATA          
          ,(CASE WHEN B.NO = 1 THEN BEFORE_SDITM_LNM
                 WHEN B.NO = 2 THEN BEFORE_SDITM_PNM
                 WHEN B.NO = 3 THEN BEFORE_LNM_CRI_DS
                 WHEN B.NO = 4 THEN BEFORE_PNM_CRI_DS
                 WHEN B.NO = 5 THEN BEFORE_DMN_LNM
                 WHEN B.NO = 6 THEN BEFORE_DMNG_LNM
                 WHEN B.NO = 7 THEN BEFORE_INFOTP_LNM
                 WHEN B.NO = 8 THEN BEFORE_DATA_TYPE
                 WHEN B.NO = 9 THEN CONCAT(BEFORE_DATA_LEN)              
                 WHEN B.NO = 10 THEN CONCAT(BEFORE_DATA_SCAL)
                 WHEN B.NO = 11 THEN BEFORE_ENC_YN
                 WHEN B.NO = 12 THEN BEFORE_TEST_DATA_CNV_YN            
                 WHEN B.NO = 13 THEN BEFORE_OBJ_DESCN            
            ELSE NULL END) AS BEFORE_DATA  
      FROM (SELECT A.RQST_NO
                  ,A.RQST_SNO
                  ,A.SDITM_LNM AS AFTER_SDITM_LNM
                  ,A.SDITM_PNM AS AFTER_SDITM_PNM
                  ,A.LNM_CRI_DS AS AFTER_LNM_CRI_DS
                  ,A.PNM_CRI_DS AS AFTER_PNM_CRI_DS
                  ,A.DMN_LNM AS AFTER_DMN_LNM
                  ,A.DMNG_LNM AS AFTER_DMNG_LNM
                  ,A.INFOTP_LNM AS AFTER_INFOTP_LNM           
                  ,A.DATA_TYPE AS AFTER_DATA_TYPE
                  ,A.DATA_LEN AS AFTER_DATA_LEN
                  ,A.DATA_SCAL AS AFTER_DATA_SCAL
                  ,CASE WHEN A.ENC_YN = 'Y' THEN '예'
                        WHEN IFNULL(A.ENC_YN, 'N') = 'N' THEN '아니오'
                        END AS AFTER_ENC_YN
                  ,CASE WHEN A.TEST_DATA_CNV_YN = 'Y' THEN '예'
                        WHEN IFNULL(A.TEST_DATA_CNV_YN, 'N') = 'N' THEN '아니오'
                        END AS AFTER_TEST_DATA_CNV_YN
                  ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
                  ,B.SDITM_LNM AS BEFORE_SDITM_LNM
                  ,B.SDITM_PNM AS BEFORE_SDITM_PNM
                  ,B.LNM_CRI_DS AS BEFORE_LNM_CRI_DS
                  ,B.PNM_CRI_DS AS BEFORE_PNM_CRI_DS
                  ,C.DMN_LNM AS BEFORE_DMN_LNM
                  ,D.DMNG_LNM AS BEFORE_DMNG_LNM
                  ,E.INFOTP_LNM AS BEFORE_INFOTP_LNM           
                  ,E.DATA_TYPE AS BEFORE_DATA_TYPE
                  ,E.DATA_LEN AS BEFORE_DATA_LEN
                  ,E.DATA_SCAL AS BEFORE_DATA_SCAL
                  ,CASE WHEN B.ENC_YN = 'Y' THEN '예'
                        WHEN IFNULL(B.ENC_YN, 'N') = 'N' THEN '아니오'
                        END AS BEFORE_ENC_YN
                  ,CASE WHEN B.TEST_DATA_CNV_YN = 'Y' THEN '예'
                        WHEN IFNULL(B.TEST_DATA_CNV_YN, 'N') = 'N' THEN '아니오'
                        END AS BEFORE_TEST_DATA_CNV_YN
                  ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
             FROM WAQ_SDITM A
                  LEFT JOIN WAH_SDITM B
                    ON B.STND_ASRT = A.STND_ASRT
                   AND B.SDITM_LNM = A.SDITM_LNM                
   			   LEFT JOIN (SELECT DMN_ID, DMN_LNM, STND_ASRT
                                     FROM WAM_DMN
                                    WHERE REG_TYP_CD IN ('C', 'U')
                                  ) C
                    ON B.STND_ASRT = C.STND_ASRT
                   AND B.DMN_ID = C.DMN_ID
                  LEFT JOIN (SELECT DMNG_ID, DMNG_LNM, STND_ASRT
                                     FROM WAA_DMNG
                                    WHERE EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  ) D
                    ON B.STND_ASRT = D.STND_ASRT
                   AND B.DMNG_ID = D.DMNG_ID
                  LEFT JOIN (SELECT INFOTP_ID
                                        , INFOTP_LNM
                                        , DATA_TYPE
                                        , DATA_LEN
                                        , DATA_SCAL
                                        , STND_ASRT
                                     FROM WAA_INFO_TYPE
                                    WHERE EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  ) E
                    ON B.STND_ASRT = E.STND_ASRT
                   AND B.INFOTP_ID = E.INFOTP_ID
                  
            WHERE 1 = 1  
              AND B.REG_TYP_CD IN ('C','U')
              AND A.RQST_DTM BETWEEN B.STR_DTM AND B.EXP_DTM                            
              AND A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
              AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
          ) A,
           (SELECT SEQ AS NO FROM seq_1_to_13) B
       )A
      ORDER BY NO
  </select>
  
  <select id="selectLdmAttrChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
    SELECT RQST_NO
         , RQST_SNO
         , RQST_DTL_SNO
         , ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
          <![CDATA[
          , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
          ]]>
      FROM (
     SELECT  RQST_NO
           , RQST_SNO
           , RQST_DTL_SNO
           , B.NO
           , (CASE WHEN B.NO = 1  THEN '어트리뷰트명'                   
                   WHEN B.NO = 2  THEN '컬럼순서'
                   WHEN B.NO = 3  THEN '데이터타입'
                   WHEN B.NO = 4  THEN '데이터길이'     
                   WHEN B.NO = 5  THEN '데이터소수점길이'
                   WHEN B.NO = 6  THEN 'PK여부'
                   WHEN B.NO = 7  THEN 'PK순서'
                   WHEN B.NO = 8  THEN 'NOTNULL여부'
                   WHEN B.NO = 9  THEN 'DEFAULT값'                   
                   WHEN B.NO = 10 THEN '설명'
              ELSE NULL END) AS ITEM_NM   
                    
           , (CASE WHEN B.NO = 1  THEN AFTER_LDM_ATTR_LNM                   
                   WHEN B.NO = 2  THEN CONCAT(AFTER_COL_ORD)
                   WHEN B.NO = 3  THEN AFTER_DATA_TYPE
                   WHEN B.NO = 4  THEN CONCAT(AFTER_DATA_LEN)
                   WHEN B.NO = 5  THEN CONCAT(AFTER_DATA_SCAL)
                   WHEN B.NO = 6  THEN AFTER_PK_YN
                   WHEN B.NO = 7  THEN CONCAT(AFTER_PK_ORD)
                   WHEN B.NO = 8  THEN AFTER_NONUL_YN
                   WHEN B.NO = 9  THEN AFTER_DEFLT_VAL                   
                   WHEN B.NO = 10 THEN AFTER_OBJ_DESCN
              ELSE NULL END) AS AFTER_DATA          
             
           , (CASE WHEN B.NO = 1  THEN BEFORE_LDM_ATTR_LNM
                   WHEN B.NO = 2  THEN CONCAT(BEFORE_COL_ORD)
                   WHEN B.NO = 3  THEN BEFORE_DATA_TYPE
                   WHEN B.NO = 4  THEN CONCAT(BEFORE_DATA_LEN)
                   WHEN B.NO = 5  THEN CONCAT(BEFORE_DATA_SCAL)
                   WHEN B.NO = 6  THEN BEFORE_PK_YN
                   WHEN B.NO = 7  THEN CONCAT(BEFORE_PK_ORD)
                   WHEN B.NO = 8  THEN BEFORE_NONUL_YN
                   WHEN B.NO = 9  THEN BEFORE_DEFLT_VAL                   
                   WHEN B.NO = 10 THEN BEFORE_OBJ_DESCN
              ELSE NULL END) AS BEFORE_DATA  
      FROM (SELECT A.RQST_NO
                 , A.RQST_SNO
                 , A.RQST_DTL_SNO
                 , A.LDM_ATTR_LNM  AS AFTER_LDM_ATTR_LNM
                 , A.LDM_ATTR_PNM  AS AFTER_LDM_ATTR_PNM
                 , A.ATTR_ORD      AS AFTER_COL_ORD
                 , A.DATA_TYPE     AS AFTER_DATA_TYPE
                 , A.DATA_LEN      AS AFTER_DATA_LEN
                 , A.DATA_SCAL     AS AFTER_DATA_SCAL
                 , CASE WHEN A.PK_YN = 'Y' THEN '예' ELSE '아니오' END AS AFTER_PK_YN
                 , A.PK_ORD AS AFTER_PK_ORD
                 , CASE WHEN A.NONUL_YN = 'Y' THEN '예' ELSE '아니오' END AS AFTER_NONUL_YN
                 , A.DEFLT_VAL     AS AFTER_DEFLT_VAL
                 , A.OBJ_DESCN     AS AFTER_OBJ_DESCN
                 , B.LDM_ATTR_LNM  AS BEFORE_LDM_ATTR_LNM
                 , B.LDM_ATTR_PNM  AS BEFORE_LDM_ATTR_PNM
                 , B.ATTR_ORD      AS BEFORE_COL_ORD
                 , B.DATA_TYPE     AS BEFORE_DATA_TYPE
                 , B.DATA_LEN      AS BEFORE_DATA_LEN
                 , B.DATA_SCAL     AS BEFORE_DATA_SCAL
                 , CASE WHEN B.PK_YN = 'Y' THEN '예' ELSE '아니오' END AS BEFORE_PK_YN
                 , B.PK_ORD AS BEFORE_PK_ORD
                 , CASE WHEN B.NONUL_YN = 'Y' THEN '예' ELSE '아니오' END AS BEFORE_NONUL_YN
                 , B.DEFLT_VAL     AS BEFORE_DEFLT_VAL
                 , B.OBJ_DESCN     AS BEFORE_OBJ_DESCN                 
              FROM WAQ_LDM_ATTR A
                   LEFT JOIN WAH_LDM_ATTR B              
                     ON A.LDM_ATTR_ID = B.LDM_ATTR_ID  
             WHERE 1 = 1
               AND B.REG_TYP_CD IN ('C','U')
               AND A.RQST_DTM BETWEEN B.STR_DTM AND B.EXP_DTM  -- 이력테이블 일자조건에 맞는데이터만
               AND A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
               AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
               AND A.RQST_DTL_SNO = #{rqstDtlSno,jdbcType=DECIMAL}
           ) A,
           (SELECT SEQ AS NO FROM seq_1_to_10) B
       )A
       ORDER BY NO
  </select>
  
  <select id="selectLdmEntyChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
    SELECT RQST_NO
         , RQST_SNO
         , ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
      FROM (
      SELECT RQST_NO
           , RQST_SNO
           , B.NO
           ,(CASE WHEN B.NO = 1 THEN '엔티티명'                  
                  WHEN B.NO = 2 THEN '주제영역명'
                  WHEN B.NO = 3 THEN '표준적용여부'                                        
                  WHEN B.NO = 4 THEN '설명'
                  WHEN B.NO = 5 THEN '컬럼갯수'
             ELSE NULL END) AS ITEM_NM          
           ,(CASE WHEN B.NO = 1 THEN AFTER_LDM_ENTY_LNM                  
                  WHEN B.NO = 2 THEN AFTER_FULL_PATH
                  WHEN B.NO = 3 THEN AFTER_STD_APL_YN                                                     
                  WHEN B.NO = 4 THEN AFTER_OBJ_DESCN
                  WHEN B.NO = 5 THEN AFTER_COL_CNT
             ELSE NULL END) AS AFTER_DATA          
           ,(CASE WHEN B.NO = 1 THEN BEFORE_LDM_ENTY_LNM                  
                  WHEN B.NO = 2 THEN BEFORE_FULL_PATH
                  WHEN B.NO = 3 THEN BEFORE_STD_APL_YN                                      
                  WHEN B.NO = 4 THEN BEFORE_OBJ_DESCN
                  WHEN B.NO = 5 THEN BEFORE_COL_CNT         
             ELSE NULL END) AS BEFORE_DATA  
        FROM (SELECT A.RQST_NO
                   , A.RQST_SNO
                   , A.LDM_ENTY_LNM AS AFTER_LDM_ENTY_LNM                   
                   , A.FULL_PATH    AS AFTER_FULL_PATH
                   , CASE WHEN A.STD_APL_YN = 'Y' THEN '예'
                     ELSE CASE WHEN A.STD_APL_YN = 'N' THEN '아니오'
                     ELSE NULL END END AS AFTER_STD_APL_YN                   
                   , A.CRG_USER_NM AS AFTER_CRG_USER_NM                  
                   , A.OBJ_DESCN   AS AFTER_OBJ_DESCN
                   , (SELECT CONCAT(COUNT(1))
                        FROM WAQ_LDM_ATTR 
                       WHERE RQST_NO = #{rqstNo,jdbcType=VARCHAR}
                         AND RQST_SNO = #{rqstSno,jdbcType=VARCHAR}
                         AND RQST_DCD NOT IN 'DD'  
                     ) AS AFTER_COL_CNT
                   , B.LDM_ENTY_LNM AS BEFORE_LDM_ENTY_LNM                   
                   , B.FULL_PATH    AS BEFORE_FULL_PATH
                   , CASE WHEN B.STD_APL_YN = 'Y' THEN '예'
                     ELSE CASE WHEN B.STD_APL_YN = 'N' THEN '아니오'
                     ELSE NULL END END AS BEFORE_STD_APL_YN                    
                   , GET_USER_NM(B.CRG_USER_ID) AS BEFORE_CRG_USER_NM                   
                   , B.OBJ_DESCN                AS BEFORE_OBJ_DESCN
                   , (SELECT CONCAT(COUNT(1))
                        FROM WAM_LDM_ATTR 
                       WHERE LDM_ENTY_ID = B.LDM_ENTY_ID
                     ) AS BEFORE_COL_CNT
              FROM WAQ_LDM_ENTY A
                   LEFT JOIN WAH_LDM_ENTY B
                     ON A.LDM_ENTY_ID = B.LDM_ENTY_ID    			   
             WHERE 1 = 1
               AND B.REG_TYP_CD IN ('C','U')
               AND A.RQST_DTM BETWEEN B.STR_DTM AND B.EXP_DTM  -- 이력테이블 일자조건 맞는 데이터만 
               AND A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
               AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
           ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_5) B
       )A
       ORDER BY NO
  </select>
  
  <select id="selectPdmTblChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
    SELECT RQST_NO
         , RQST_SNO
         , ITEM_NM
         , AFTER_CHG
         , BEFORE_CHG
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_CHG, '') <> IFNULL(BEFORE_CHG, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
      FROM (
      SELECT RQST_NO
           , RQST_SNO
           , B.NO
           ,(CASE WHEN B.NO = 1 THEN '테이블논리명'
                  WHEN B.NO = 2 THEN '테이블물리명'
                  WHEN B.NO = 3 THEN '주제영역명'
                  WHEN B.NO = 4 THEN '표준적용여부'
                  WHEN B.NO = 5 THEN '파티션테이블여부'     
                  WHEN B.NO = 6 THEN 'DW대상테이블여부'
                  WHEN B.NO = 7 THEN '담당자명'
                  WHEN B.NO = 8 THEN '보관주기'
                  WHEN B.NO = 9 THEN '삭제기준'
                  WHEN B.NO = 10 THEN '삭제방법'
                  WHEN B.NO = 11 THEN '백업주기'
                  WHEN B.NO = 12 THEN '설명'
                  WHEN B.NO = 13 THEN '컬럼갯수'
             ELSE NULL END) AS ITEM_NM          
           ,(CASE WHEN B.NO = 1 THEN AFTER_PDM_TBL_LNM
                  WHEN B.NO = 2 THEN AFTER_PDM_TBL_PNM
                  WHEN B.NO = 3 THEN AFTER_FULL_PATH
                  WHEN B.NO = 4 THEN AFTER_STD_APL_YN
                  WHEN B.NO = 5 THEN AFTER_PART_TBL_YN
                  WHEN B.NO = 6 THEN AFTER_DW_TRG_TBL_YN
                  WHEN B.NO = 7 THEN AFTER_CRG_USER_NM
                  WHEN B.NO = 8 THEN AFTER_CTD_FCY
                  WHEN B.NO = 9 THEN AFTER_DEL_CRI
                  WHEN B.NO = 10 THEN AFTER_DEL_MTD
                  WHEN B.NO = 11 THEN AFTER_BCK_FCY
                  WHEN B.NO = 12 THEN AFTER_OBJ_DESCN
                  WHEN B.NO = 13 THEN AFTER_COL_CNT
             ELSE NULL END) AS AFTER_CHG          
           ,(CASE WHEN B.NO = 1 THEN BEFORE_PDM_TBL_LNM
                  WHEN B.NO = 2 THEN BEFORE_PDM_TBL_PNM
                  WHEN B.NO = 3 THEN BEFORE_FULL_PATH
                  WHEN B.NO = 4 THEN BEFORE_STD_APL_YN
                  WHEN B.NO = 5 THEN BEFORE_PART_TBL_YN
                  WHEN B.NO = 6 THEN BEFORE_DW_TRG_TBL_YN
                  WHEN B.NO = 7 THEN BEFORE_CRG_USER_NM
                  WHEN B.NO = 8 THEN BEFORE_CTD_FCY
                  WHEN B.NO = 9 THEN BEFORE_DEL_CRI
                  WHEN B.NO = 10 THEN BEFORE_DEL_MTD
                  WHEN B.NO = 11 THEN BEFORE_BCK_FCY
                  WHEN B.NO = 12 THEN BEFORE_OBJ_DESCN
                  WHEN B.NO = 13 THEN BEFORE_COL_CNT         
             ELSE NULL END) AS BEFORE_CHG  
        FROM (SELECT A.RQST_NO
                   , A.RQST_SNO
                   , A.PDM_TBL_LNM AS AFTER_PDM_TBL_LNM
                   , A.PDM_TBL_PNM AS AFTER_PDM_TBL_PNM
                   , A.FULL_PATH AS AFTER_FULL_PATH
                   , CASE WHEN A.STD_APL_YN = 'Y' THEN '예'
                     ELSE CASE WHEN A.STD_APL_YN = 'N' THEN '아니오'
                     ELSE NULL END END AS AFTER_STD_APL_YN
                   , CASE WHEN A.PART_TBL_YN = 'Y' THEN '예'
                     ELSE CASE WHEN A.PART_TBL_YN = 'N' THEN '아니오'
                     ELSE NULL END END AS AFTER_PART_TBL_YN
                   , CASE WHEN A.DW_TRG_TBL_YN = 'Y' THEN '예'
                     ELSE CASE WHEN A.DW_TRG_TBL_YN = 'N' THEN '아니오'
                     ELSE NULL END END AS AFTER_DW_TRG_TBL_YN
                   , A.CRG_USER_NM AS AFTER_CRG_USER_NM
                   , A.CTD_FCY AS AFTER_CTD_FCY
                   , A.DEL_CRI AS AFTER_DEL_CRI
                   , A.DEL_MTD AS AFTER_DEL_MTD
                   , A.BCK_FCY AS AFTER_BCK_FCY
                   , A.OBJ_DESCN AS AFTER_OBJ_DESCN
                   , (SELECT CONCAT(COUNT(1)) FROM WAQ_PDM_COL 
                       WHERE RQST_NO = #{rqstNo,jdbcType=VARCHAR}
                         AND RQST_SNO = #{rqstSno,jdbcType=VARCHAR}
                         AND RQST_DCD NOT IN ('DD')  ) AS AFTER_COL_CNT
                   , B.PDM_TBL_LNM AS BEFORE_PDM_TBL_LNM
                   , B.PDM_TBL_PNM AS BEFORE_PDM_TBL_PNM
                   , B.FULL_PATH AS BEFORE_FULL_PATH
                   , CASE WHEN B.STD_APL_YN = 'Y' THEN '예'
                     ELSE CASE WHEN B.STD_APL_YN = 'N' THEN '아니오'
                     ELSE NULL END END AS BEFORE_STD_APL_YN
                   , CASE WHEN B.PART_TBL_YN = 'Y' THEN '예'
                     ELSE CASE WHEN B.PART_TBL_YN = 'N' THEN '아니오'
                     ELSE NULL END END AS BEFORE_PART_TBL_YN
                   , CASE WHEN B.DW_TRG_TBL_YN = 'Y' THEN '예'
                     ELSE CASE WHEN B.DW_TRG_TBL_YN = 'N' THEN '아니오'
                     ELSE NULL END END AS BEFORE_DW_TRG_TBL_YN
                   , GET_USER_NM(B.CRG_USER_ID) AS BEFORE_CRG_USER_NM
                   , B.CTD_FCY                  AS BEFORE_CTD_FCY
                   , B.DEL_CRI                  AS BEFORE_DEL_CRI
                   , B.DEL_MTD                  AS BEFORE_DEL_MTD
                   , B.BCK_FCY                  AS BEFORE_BCK_FCY
                   , B.OBJ_DESCN                AS BEFORE_OBJ_DESCN
                   , (SELECT COUNT(1) FROM WAM_PDM_COL 
                       WHERE PDM_TBL_ID = B.PDM_TBL_ID
                       ) AS BEFORE_COL_CNT
              FROM WAQ_PDM_TBL A
                   LEFT JOIN WAH_PDM_TBL B
                     ON A.PDM_TBL_ID = B.PDM_TBL_ID   			   
             WHERE 1 = 1
               AND B.REG_TYP_CD IN ('C','U')
               AND A.RQST_DTM BETWEEN B.STR_DTM AND B.EXP_DTM  -- 이력테이블 일자조건 맞는 데이터만 
               AND A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
               AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
           ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_13) B
       ) A
       ORDER BY NO
  </select>
  
  <select id="selectPdmColChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
    /* WaqRqstChgDtlsMapper.selectPdmColChgList */
    SELECT RQST_NO
         , RQST_SNO
         , RQST_DTL_SNO
         , ITEM_NM
         , AFTER_CHG
         , BEFORE_CHG
           <![CDATA[
         , (CASE WHEN IFNULL(AFTER_CHG, '') <> IFNULL(BEFORE_CHG, '') THEN  '#FF0000' END  ) AS FontColor
           ]]>
      FROM (
     SELECT  RQST_NO
           , RQST_SNO
           , RQST_DTL_SNO
           , B.NO
           , (CASE WHEN B.NO = 1  THEN '컬럼논리명'
                   WHEN B.NO = 2  THEN '컬럼물리명'
                   WHEN B.NO = 3  THEN '컬럼순서'
                   WHEN B.NO = 4  THEN '데이터타입'
                   WHEN B.NO = 5  THEN '데이터길이'     
                   WHEN B.NO = 6  THEN '데이터소수점길이'
                   WHEN B.NO = 7  THEN 'PK여부'
                   WHEN B.NO = 8  THEN 'PK순서'
                   WHEN B.NO = 9  THEN 'NOTNULL여부'
                   WHEN B.NO = 10 THEN 'DEFAULT값'
                   WHEN B.NO = 11 THEN '암호화여부'
                   WHEN B.NO = 12 THEN '설명'
              ELSE NULL END) AS ITEM_NM   
                    
           , (CASE WHEN B.NO = 1  THEN AFTER_PDM_COL_LNM
                   WHEN B.NO = 2  THEN AFTER_PDM_COL_PNM
                   WHEN B.NO = 3  THEN CONCAT(AFTER_COL_ORD)
                   WHEN B.NO = 4  THEN AFTER_DATA_TYPE
                   WHEN B.NO = 5  THEN AFTER_DATA_LEN
                   WHEN B.NO = 6  THEN AFTER_DATA_SCAL
                   WHEN B.NO = 7  THEN AFTER_PK_YN
                   WHEN B.NO = 8  THEN CONCAT(AFTER_PK_ORD)
                   WHEN B.NO = 9  THEN AFTER_NONUL_YN
                   WHEN B.NO = 10 THEN AFTER_DEFLT_VAL
                   WHEN B.NO = 11 THEN AFTER_ENC_YN
                   WHEN B.NO = 12 THEN AFTER_OBJ_DESCN
              ELSE NULL END) AS AFTER_CHG         
             
           , (CASE WHEN B.NO = 1  THEN BEFORE_PDM_COL_LNM
                   WHEN B.NO = 2  THEN BEFORE_PDM_COL_PNM
                   WHEN B.NO = 3  THEN CONCAT(BEFORE_COL_ORD)
                   WHEN B.NO = 4  THEN BEFORE_DATA_TYPE
                   WHEN B.NO = 5  THEN CONCAT(BEFORE_DATA_LEN)
                   WHEN B.NO = 6  THEN CONCAT(BEFORE_DATA_SCAL)
                   WHEN B.NO = 7  THEN BEFORE_PK_YN
                   WHEN B.NO = 8  THEN CONCAT(BEFORE_PK_ORD)
                   WHEN B.NO = 9  THEN BEFORE_NONUL_YN
                   WHEN B.NO = 10 THEN BEFORE_DEFLT_VAL
                   WHEN B.NO = 11 THEN BEFORE_ENC_YN    
                   WHEN B.NO = 12 THEN BEFORE_OBJ_DESCN
              ELSE NULL END) AS BEFORE_CHG  
      FROM (SELECT A.RQST_NO
                 , A.RQST_SNO
                 , A.RQST_DTL_SNO
                 , A.PDM_COL_LNM   AS AFTER_PDM_COL_LNM
                 , A.PDM_COL_PNM   AS AFTER_PDM_COL_PNM
                 , A.COL_ORD       AS AFTER_COL_ORD
                 , A.DATA_TYPE     AS AFTER_DATA_TYPE
                 , A.DATA_LEN      AS AFTER_DATA_LEN
                 , A.DATA_SCAL     AS AFTER_DATA_SCAL
                 , CASE WHEN A.PK_YN = 'Y' THEN '예' ELSE '아니오' END AS AFTER_PK_YN
                 , A.PK_ORD AS AFTER_PK_ORD
                 , CASE WHEN A.NONUL_YN = 'Y' THEN '예' ELSE '아니오' END AS AFTER_NONUL_YN
                 , CASE WHEN A.DEFLT_VAL IS NULL THEN 'NULL' ELSE  A.DEFLT_VAL END AS AFTER_DEFLT_VAL
                 , A.OBJ_DESCN     AS AFTER_OBJ_DESCN
                 , B.PDM_COL_LNM   AS BEFORE_PDM_COL_LNM
                 , B.PDM_COL_PNM   AS BEFORE_PDM_COL_PNM
                 , B.COL_ORD       AS BEFORE_COL_ORD
                 , B.DATA_TYPE     AS BEFORE_DATA_TYPE
                 , B.DATA_LEN      AS BEFORE_DATA_LEN
                 , B.DATA_SCAL     AS BEFORE_DATA_SCAL
                 , CASE WHEN B.PK_YN = 'Y' THEN '예' ELSE '아니오' END AS BEFORE_PK_YN
                 , B.PK_ORD AS BEFORE_PK_ORD
                 , CASE WHEN B.NONUL_YN = 'Y' THEN '예' ELSE '아니오' END AS BEFORE_NONUL_YN
                 , CASE WHEN B.DEFLT_VAL IS NULL THEN 'NULL' ELSE  B.DEFLT_VAL END  AS BEFORE_DEFLT_VAL
                 , B.OBJ_DESCN     AS BEFORE_OBJ_DESCN
                 , A.ENC_YN        AS AFTER_ENC_YN
                 , B.ENC_YN        AS BEFORE_ENC_YN
              FROM WAQ_PDM_COL A
                   LEFT JOIN WAH_PDM_COL B              
                     ON A.PDM_COL_ID = B.PDM_COL_ID
             WHERE 1 = 1
               AND B.REG_TYP_CD IN ('C','U')
               AND A.RQST_DTM BETWEEN B.STR_DTM AND B.EXP_DTM  -- 이력테이블 일자조건에 맞는데이터만
               AND A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
               AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
               AND A.RQST_DTL_SNO = #{rqstDtlSno,jdbcType=DECIMAL}
           ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_12) B
       ) A
       ORDER BY NO
  </select>
  <select id="selectPdmRelChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,RQST_DTL_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,RQST_DTL_SNO
       ,(CASE WHEN B.NO = 1 THEN '관계물리명'
              WHEN B.NO = 2 THEN '관계논리명'
              WHEN B.NO = 3 THEN '관계유형'
              WHEN B.NO = 4 THEN '카디널리티유형'
              WHEN B.NO = 5 THEN 'Parent Optionality 유형'     
              WHEN B.NO = 6 THEN '부모엔터티 주제영역명'
              WHEN B.NO = 7 THEN '부모엔터티명'
              WHEN B.NO = 8 THEN '부모엔터티 속성명'
              WHEN B.NO = 9 THEN '자식엔터티 주제영역명'
              WHEN B.NO = 10 THEN '자식엔터티명'
              WHEN B.NO = 11 THEN '자식엔터티 속성명'
              WHEN B.NO = 12 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_PDM_REL_PNM
              WHEN B.NO = 2 THEN AFTER_PDM_REL_LNM
              WHEN B.NO = 3 THEN AFTER_REL_TYP_CD
              WHEN B.NO = 4 THEN AFTER_CRD_TYP_CD
              WHEN B.NO = 5 THEN AFTER_PA_OPT_TYP_CD
              WHEN B.NO = 6 THEN AFTER_PA_SUBJ_PNM
              WHEN B.NO = 7 THEN AFTER_PA_ENTY_PNM
              WHEN B.NO = 8 THEN AFTER_PA_ATTR_PNM
              WHEN B.NO = 9 THEN AFTER_CH_SUBJ_PNM
              WHEN B.NO = 10 THEN AFTER_CH_ENTY_PNM
              WHEN B.NO = 11 THEN AFTER_CH_ATTR_PNM
              WHEN B.NO = 12 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER_DATA          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_PDM_REL_PNM
       		  WHEN B.NO = 2 THEN BEFORE_PDM_REL_LNM
              WHEN B.NO = 3 THEN BEFORE_REL_TYP_CD
              WHEN B.NO = 4 THEN BEFORE_CRD_TYP_CD
              WHEN B.NO = 5 THEN BEFORE_PA_OPT_TYP_CD
              WHEN B.NO = 6 THEN BEFORE_PA_SUBJ_PNM
              WHEN B.NO = 7 THEN BEFORE_PA_ENTY_PNM
              WHEN B.NO = 8 THEN BEFORE_PA_ATTR_PNM
              WHEN B.NO = 9 THEN BEFORE_CH_SUBJ_PNM
              WHEN B.NO = 10 THEN BEFORE_CH_ENTY_PNM
              WHEN B.NO = 11 THEN BEFORE_CH_ATTR_PNM
              WHEN B.NO = 12 THEN BEFORE_OBJ_DESCN  
         ELSE NULL END) AS BEFORE_DATA  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.RQST_DTL_SNO
               ,A.PDM_REL_PNM AS AFTER_PDM_REL_PNM
               ,A.PDM_REL_LNM AS AFTER_PDM_REL_LNM
               ,C.COMM_DTL_CD_NM AS AFTER_REL_TYP_CD
               ,D.COMM_DTL_CD_NM AS AFTER_CRD_TYP_CD
               ,E.COMM_DTL_CD_NM AS AFTER_PA_OPT_TYP_CD
               ,A.PA_SUBJ_PNM AS AFTER_PA_SUBJ_PNM
               ,A.PA_ENTY_PNM AS AFTER_PA_ENTY_PNM
               ,A.PA_ATTR_PNM AS AFTER_PA_ATTR_PNM
               ,A.CH_SUBJ_PNM AS AFTER_CH_SUBJ_PNM
               ,A.CH_ENTY_PNM AS AFTER_CH_ENTY_PNM
               ,A.CH_ATTR_PNM AS AFTER_CH_ATTR_PNM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.PDM_REL_PNM AS BEFORE_PDM_REL_PNM
               ,B.PDM_REL_LNM AS BEFORE_PDM_REL_LNM
               ,F.COMM_DTL_CD_NM AS BEFORE_REL_TYP_CD
               ,G.COMM_DTL_CD_NM AS BEFORE_CRD_TYP_CD
               ,H.COMM_DTL_CD_NM AS BEFORE_PA_OPT_TYP_CD
               ,I.FULL_PATH AS BEFORE_PA_SUBJ_PNM
               ,J.PDM_TBL_PNM AS BEFORE_PA_ENTY_PNM
               ,K.PDM_COL_PNM AS BEFORE_PA_ATTR_PNM
               ,L.FULL_PATH AS BEFORE_CH_SUBJ_PNM
               ,M.PDM_TBL_PNM AS BEFORE_CH_ENTY_PNM
               ,N.PDM_COL_PNM AS BEFORE_CH_ATTR_PNM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_PDM_REL A
               LEFT OUTER JOIN WAM_PDM_REL B
                 ON A.PDM_REL_PNM = B.PDM_REL_PNM
                AND A.CH_SUBJ_PNM = ( SELECT FULL_PATH
			   						   FROM WAA_SUBJ
			   						  WHERE SUBJ_ID = B.CH_SUBJ_ID
			   						    AND REG_TYP_CD IN ('C', 'U')
			   						    AND EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')  
			   					    )
				AND A.CH_ENTY_PNM = ( SELECT PDM_TBL_PNM
			   					 	   FROM WAM_PDM_TBL
			   					 	  WHERE PDM_TBL_ID = B.CH_ENTY_ID
			   					 	    AND REG_TYP_CD IN ('C', 'U')
			   					    )
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'REL_TYP_CD'
                                ) C
            ON A.REL_TYP_CD = C.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'CRD_TYP_CD'
                                ) D
            ON A.CRD_TYP_CD = D.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'PA_OPT_TYP_CD'
                                ) E
            ON A.PA_OPT_TYP_CD = E.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'REL_TYP_CD'
                                ) F
            ON B.REL_TYP_CD = F.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'CRD_TYP_CD'
                                ) G
            ON B.CRD_TYP_CD = G.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'PA_OPT_TYP_CD'
                                ) H
            ON B.PA_OPT_TYP_CD = H.COMM_DTL_CD
          LEFT OUTER JOIN WAA_SUBJ I
          	ON B.PA_SUBJ_ID = I.SUBJ_ID
           AND I.REG_TYP_CD IN ('C', 'U')
           AND I.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
          LEFT OUTER JOIN WAM_PDM_TBL J
            ON B.PA_ENTY_ID = J.PDM_TBL_ID
           AND J.REG_TYP_CD IN ('C', 'U')
          LEFT OUTER JOIN WAM_PDM_COL K
            ON B.PA_ATTR_ID = K.PDM_COL_ID
           AND B.PA_ENTY_ID = K.PDM_TBL_ID
          LEFT OUTER JOIN WAA_SUBJ L
          	ON B.CH_SUBJ_ID = L.SUBJ_ID
           AND L.REG_TYP_CD IN ('C', 'U')
           AND L.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
          LEFT OUTER JOIN WAM_PDM_TBL M
            ON B.CH_ENTY_ID = M.PDM_TBL_ID
           AND M.REG_TYP_CD IN ('C', 'U')
          LEFT OUTER JOIN WAM_PDM_COL N
            ON B.CH_ATTR_ID = N.PDM_COL_ID
           AND B.CH_ENTY_ID = N.PDM_TBL_ID
			   
               
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
           AND A.RQST_DTL_SNO = #{rqstDtlSno,jdbcType=DECIMAL}
       ) A,
           (SELECT SEQ AS NO FROM seq_1_to_12) B
       )A
  </select>
  
  <select id="selectDdlTblChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
    SELECT RQST_NO
         , RQST_SNO
         , ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
      FROM (
     SELECT RQST_NO
          , RQST_SNO
          , B.NO
          , (CASE WHEN B.NO = 1 THEN '테이블논리명'
                  WHEN B.NO = 2 THEN '테이블물리명'
                  WHEN B.NO = 3 THEN 'DBMS유저명'
                  WHEN B.NO = 4 THEN '설명'
                  
             ELSE NULL END) AS ITEM_NM          
          ,(CASE WHEN B.NO = 1 THEN AFTER_DDL_TBL_LNM
                 WHEN B.NO = 2 THEN AFTER_DDL_TBL_PNM
                 WHEN B.NO = 3 THEN AFTER_DB_SCH_NM
                 WHEN B.NO = 4 THEN AFTER_OBJ_DESCN
            ELSE NULL END) AS AFTER_DATA        
          ,(CASE WHEN B.NO = 1 THEN BEFORE_DDL_TBL_LNM
                 WHEN B.NO = 2 THEN BEFORE_DDL_TBL_PNM
                 WHEN B.NO = 3 THEN BEFORE_DB_SCH_NM
                 WHEN B.NO = 4 THEN BEFORE_OBJ_DESCN
            ELSE NULL END) AS BEFORE_DATA  
      FROM (SELECT A.RQST_NO
                 , A.RQST_SNO
                 , A.DDL_TBL_LNM  AS AFTER_DDL_TBL_LNM
                 , A.DDL_TBL_PNM  AS AFTER_DDL_TBL_PNM
                 , A.DB_SCH_PNM   AS AFTER_DB_SCH_NM
                 , A.OBJ_DESCN    AS AFTER_OBJ_DESCN
                 , B.DDL_TBL_LNM  AS BEFORE_DDL_TBL_LNM
                 , B.DDL_TBL_PNM  AS BEFORE_DDL_TBL_PNM
                 , C.DB_SCH_PNM   AS BEFORE_DB_SCH_NM
                 , B.OBJ_DESCN    AS BEFORE_OBJ_DESCN
              FROM WAQ_DDL_TBL A
                   LEFT JOIN WAH_DDL_TBL B
                     ON B.DDL_TBL_ID = A.DDL_TBL_ID
    			   LEFT JOIN  WAA_DB_SCH C
                     ON C.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d') 
                    AND C.REG_TYP_CD IN ('C', 'U')
                    AND C.DB_SCH_ID = B.DB_SCH_ID      
             WHERE 1 = 1
               AND B.REG_TYP_CD IN ('C','U')
               AND A.RQST_DTM BETWEEN B.STR_DTM AND B.EXP_DTM  -- 이력테이블 일자조건에 맞는데이터만                      
               AND A.RQST_NO  = #{rqstNo,jdbcType=VARCHAR}
               AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
           ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_4) B
       )A
       ORDER BY NO
  </select>
  
  <select id="selectDdlColChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
  /* WaqRqstChgDtlsMapper.selectDdlColChgList */
   SELECT RQST_NO
        , RQST_SNO
        , RQST_DTL_SNO
        , ITEM_NM
        , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
     FROM (
    SELECT  RQST_NO
          , RQST_SNO
          , RQST_DTL_SNO
          , B.NO
          , (CASE WHEN B.NO = 1 THEN '컬럼논리명'
                  WHEN B.NO = 2 THEN '컬럼물리명'
                  WHEN B.NO = 3 THEN '컬럼순서'
                  WHEN B.NO = 4 THEN '데이터타입'
                  WHEN B.NO = 5 THEN '데이터길이'     
                  WHEN B.NO = 6 THEN '데이터소수점길이'
                  WHEN B.NO = 7 THEN 'PK여부'
                  WHEN B.NO = 8 THEN 'PK순서'
                  WHEN B.NO = 9 THEN 'NOTNULL여부'
                  WHEN B.NO = 10 THEN 'DEFAULT값'
                  WHEN B.NO = 11 THEN '설명'
             ELSE NULL END) AS ITEM_NM   
                   
          , (CASE WHEN B.NO = 1 THEN AFTER_DDL_COL_LNM
                  WHEN B.NO = 2 THEN AFTER_DDL_COL_PNM
                  WHEN B.NO = 3 THEN CONCAT(AFTER_COL_ORD)
                  WHEN B.NO = 4 THEN AFTER_DATA_TYPE
                  WHEN B.NO = 5 THEN CONCAT(AFTER_DATA_LEN)
                  WHEN B.NO = 6 THEN CONCAT(AFTER_DATA_SCAL)
                  WHEN B.NO = 7 THEN AFTER_PK_YN
                  WHEN B.NO = 8 THEN CONCAT(AFTER_PK_ORD)
                  WHEN B.NO = 9 THEN AFTER_NONUL_YN
                  WHEN B.NO = 10 THEN AFTER_DEFLT_VAL
                  WHEN B.NO = 11 THEN AFTER_OBJ_DESCN
             ELSE NULL END) AS AFTER_DATA          
            
          , (CASE WHEN B.NO = 1 THEN BEFORE_DDL_COL_LNM
                  WHEN B.NO = 2 THEN BEFORE_DDL_COL_PNM
                  WHEN B.NO = 3 THEN CONCAT(BEFORE_COL_ORD)
                  WHEN B.NO = 4 THEN BEFORE_DATA_TYPE
                  WHEN B.NO = 5 THEN CONCAT(BEFORE_DATA_LEN)
                  WHEN B.NO = 6 THEN CONCAT(BEFORE_DATA_SCAL)
                  WHEN B.NO = 7 THEN BEFORE_PK_YN
                  WHEN B.NO = 8 THEN CONCAT(BEFORE_PK_ORD)
                  WHEN B.NO = 9 THEN BEFORE_NONUL_YN
                  WHEN B.NO = 10 THEN BEFORE_DEFLT_VAL
                  WHEN B.NO = 11 THEN BEFORE_OBJ_DESCN
             ELSE NULL END) AS BEFORE_DATA  
     FROM (SELECT A.RQST_NO
                , A.RQST_SNO
                , A.RQST_DTL_SNO
                , A.DDL_COL_LNM  AS AFTER_DDL_COL_LNM
                , A.DDL_COL_PNM  AS AFTER_DDL_COL_PNM
                , A.COL_ORD      AS AFTER_COL_ORD
                , A.DATA_TYPE    AS AFTER_DATA_TYPE
                , A.DATA_LEN     AS AFTER_DATA_LEN
                , A.DATA_SCAL    AS AFTER_DATA_SCAL
                ,  CASE WHEN A.PK_YN = 'Y' THEN '예' ELSE '아니오' END AS AFTER_PK_YN
                , A.PK_ORD AS AFTER_PK_ORD
                ,  CASE WHEN A.NONUL_YN = 'Y' THEN '예' ELSE '아니오' END AS AFTER_NONUL_YN
                , CASE WHEN A.DEFLT_VAL IS NULL THEN 'NULL' ELSE  A.DEFLT_VAL END AS AFTER_DEFLT_VAL
                , A.OBJ_DESCN    AS AFTER_OBJ_DESCN
                , B.DDL_COL_LNM  AS BEFORE_DDL_COL_LNM
                , B.DDL_COL_PNM  AS BEFORE_DDL_COL_PNM
                , B.COL_ORD      AS BEFORE_COL_ORD
                , B.DATA_TYPE    AS BEFORE_DATA_TYPE
                , B.DATA_LEN     AS BEFORE_DATA_LEN
                , B.DATA_SCAL    AS BEFORE_DATA_SCAL
                ,  CASE WHEN B.PK_YN = 'Y' THEN '예' ELSE '아니오' END AS BEFORE_PK_YN
                , B.PK_ORD       AS BEFORE_PK_ORD
                ,  CASE WHEN B.NONUL_YN = 'Y' THEN '예' ELSE '아니오' END AS BEFORE_NONUL_YN
                , CASE WHEN B.DEFLT_VAL IS NULL THEN 'NULL' ELSE  B.DEFLT_VAL END  AS BEFORE_DEFLT_VAL
                , B.OBJ_DESCN    AS BEFORE_OBJ_DESCN
             FROM WAQ_DDL_COL A
                  LEFT JOIN WAH_DDL_COL B
                    ON A.DDL_COL_ID = B.DDL_COL_ID        
            WHERE 1 = 1
              AND B.REG_TYP_CD IN ('C','U')
              AND A.RQST_DTM BETWEEN B.STR_DTM AND B.EXP_DTM  -- 이력테이블 일자조건에 맞는데이터만                                        
              AND A.RQST_NO      = #{rqstNo,jdbcType=VARCHAR}
              AND A.RQST_SNO     = #{rqstSno,jdbcType=DECIMAL}
              AND A.RQST_DTL_SNO = #{rqstDtlSno,jdbcType=DECIMAL}
          ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_11) B
       )A
      ORDER BY NO
  </select>
  
  <select id="selectTblMapChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '타겟테이블논리명'
              WHEN B.NO = 2 THEN '타겟테이블물리명'
              WHEN B.NO = 3 THEN '타겟DB명'
              WHEN B.NO = 4 THEN '매핑일련번호'
              WHEN B.NO = 5 THEN '테이블매핑타입'
              WHEN B.NO = 6 THEN '타겟주제영역명'     
              WHEN B.NO = 7 THEN '타겟이행타입'
              WHEN B.NO = 8 THEN '소스업무명'
              WHEN B.NO = 9 THEN '소스시스템명'
              WHEN B.NO = 10 THEN '소스DB명'
              WHEN B.NO = 11 THEN '소스테이블논리명'
              WHEN B.NO = 12 THEN '소스테이블물리명'
              WHEN B.NO = 13 THEN '선택스킵조건명'
              WHEN B.NO = 14 THEN '조인조건명'
              WHEN B.NO = 15 THEN '응용담당자명'
              WHEN B.NO = 16 THEN '전환담당자명'
              WHEN B.NO = 17 THEN '참조설명'
              WHEN B.NO = 18 THEN '사전이행설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_TGT_TBL_LNM
              WHEN B.NO = 2 THEN AFTER_TGT_TBL_PNM
              WHEN B.NO = 3 THEN AFTER_TGT_DB_PNM
              WHEN B.NO = 4 THEN AFTER_MAP_SNO
              WHEN B.NO = 5 THEN AFTER_TBL_MAP_TYPE
              WHEN B.NO = 6 THEN AFTER_TGT_SUBJ_ALL_PATH
              WHEN B.NO = 7 THEN AFTER_TGT_FLF_TYPE
              WHEN B.NO = 8 THEN AFTER_SRC_BIZ_NM
              WHEN B.NO = 9 THEN AFTER_SRC_SYS_NM
              WHEN B.NO = 10 THEN AFTER_SRC_DB_PNM
              WHEN B.NO = 11 THEN AFTER_SRC_TBL_LNM
              WHEN B.NO = 12 THEN AFTER_SRC_TBL_PNM
              WHEN B.NO = 13 THEN AFTER_SLT_SKP_CND_NM
              WHEN B.NO = 14 THEN AFTER_JN_CND_NM
              WHEN B.NO = 15 THEN AFTER_APP_CRGP_NM
              WHEN B.NO = 16 THEN AFTER_CNVS_CRGP_NM
              WHEN B.NO = 17 THEN AFTER_REF_DESCN
              WHEN B.NO = 18 THEN AFTER_PRE_FLF_DESCN
         ELSE NULL END) AS AFTER_DATA          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_TGT_TBL_LNM
              WHEN B.NO = 2 THEN BEFORE_TGT_TBL_PNM
              WHEN B.NO = 3 THEN BEFORE_TGT_DB_PNM
              WHEN B.NO = 4 THEN BEFORE_MAP_SNO
              WHEN B.NO = 5 THEN BEFORE_TBL_MAP_TYPE
              WHEN B.NO = 6 THEN BEFORE_TGT_SUBJ_ALL_PATH
              WHEN B.NO = 7 THEN BEFORE_TGT_FLF_TYPE
              WHEN B.NO = 8 THEN BEFORE_SRC_BIZ_NM
              WHEN B.NO = 9 THEN BEFORE_SRC_SYS_NM
              WHEN B.NO = 10 THEN BEFORE_SRC_DB_PNM
              WHEN B.NO = 11 THEN BEFORE_SRC_TBL_LNM
              WHEN B.NO = 12 THEN BEFORE_SRC_TBL_PNM
              WHEN B.NO = 13 THEN BEFORE_SLT_SKP_CND_NM
              WHEN B.NO = 14 THEN BEFORE_JN_CND_NM
              WHEN B.NO = 15 THEN BEFORE_APP_CRGP_NM
              WHEN B.NO = 16 THEN BEFORE_CNVS_CRGP_NM
              WHEN B.NO = 17 THEN BEFORE_REF_DESCN
              WHEN B.NO = 18 THEN BEFORE_PRE_FLF_DESCN
         ELSE NULL END) AS BEFORE_DATA  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.TGT_TBL_LNM AS AFTER_TGT_TBL_LNM
               ,A.TGT_TBL_PNM AS AFTER_TGT_TBL_PNM
               ,A.TGT_DB_PNM AS AFTER_TGT_DB_PNM
               ,A.MAP_SNO AS AFTER_MAP_SNO
               ,C.COMM_DTL_CD_NM AS AFTER_TBL_MAP_TYPE
               ,A.TGT_SUBJ_ALL_PATH AS AFTER_TGT_SUBJ_ALL_PATH
               ,D.COMM_DTL_CD_NM AS AFTER_TGT_FLF_TYPE
               ,A.SRC_BIZ_NM AS AFTER_SRC_BIZ_NM
               ,A.SRC_SYS_NM AS AFTER_SRC_SYS_NM
               ,A.SRC_DB_PNM AS AFTER_SRC_DB_PNM
               ,A.SRC_TBL_LNM AS AFTER_SRC_TBL_LNM
               ,A.SRC_TBL_PNM AS AFTER_SRC_TBL_PNM
               ,A.SLT_SKP_CND_NM AS AFTER_SLT_SKP_CND_NM
               ,A.JN_CND_NM AS AFTER_JN_CND_NM
               ,A.APP_CRGP_NM AS AFTER_APP_CRGP_NM
               ,A.CNVS_CRGP_NM AS AFTER_CNVS_CRGP_NM
               ,A.REF_DESCN AS AFTER_REF_DESCN
               ,A.PRE_FLF_DESCN AS AFTER_PRE_FLF_DESCN
               ,B.TGT_TBL_LNM AS BEFORE_TGT_TBL_LNM
               ,B.TGT_TBL_PNM AS BEFORE_TGT_TBL_PNM
               ,B.TGT_DB_PNM AS BEFORE_TGT_DB_PNM
               ,B.MAP_SNO AS BEFORE_MAP_SNO
               ,E.COMM_DTL_CD_NM AS BEFORE_TBL_MAP_TYPE
               ,B.TGT_SUBJ_ALL_PATH AS BEFORE_TGT_SUBJ_ALL_PATH
               ,F.COMM_DTL_CD_NM AS BEFORE_TGT_FLF_TYPE
               ,B.SRC_BIZ_NM AS BEFORE_SRC_BIZ_NM
               ,B.SRC_SYS_NM AS BEFORE_SRC_SYS_NM
               ,B.SRC_DB_PNM AS BEFORE_SRC_DB_PNM
               ,B.SRC_TBL_LNM AS BEFORE_SRC_TBL_LNM
               ,B.SRC_TBL_PNM AS BEFORE_SRC_TBL_PNM
               ,B.SLT_SKP_CND_NM AS BEFORE_SLT_SKP_CND_NM
               ,B.JN_CND_NM AS BEFORE_JN_CND_NM
               ,B.APP_CRGP_NM AS BEFORE_APP_CRGP_NM
               ,B.CNVS_CRGP_NM AS BEFORE_CNVS_CRGP_NM
               ,B.REF_DESCN AS BEFORE_REF_DESCN
               ,B.PRE_FLF_DESCN AS BEFORE_PRE_FLF_DESCN
          FROM WAQ_TBL_MAP A
               LEFT OUTER JOIN WAM_TBL_MAP B
                 ON A.TBL_MAP_ID = B.TBL_MAP_ID
			   LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'TBL_MAP_TYP_CD'
                                ) C
                 ON A.TBL_MAP_TYPE = C.COMM_DTL_CD 
			   LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'TGT_FLF_TYP_CD'
                                ) D 
                 ON A.TGT_FLF_TYPE = D.COMM_DTL_CD 
               LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'TBL_MAP_TYP_CD'
                                ) E
                 ON B.TBL_MAP_TYPE = E.COMM_DTL_CD 
			   LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'TGT_FLF_TYP_CD'
                                ) F 
                 ON B.TGT_FLF_TYPE = F.COMM_DTL_CD 
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_18) B
       )A
  </select>
  <select id="selectCodMapChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>   
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '매핑정의서유형'
              WHEN B.NO = 2 THEN '코드전환유형'
              WHEN B.NO = 3 THEN '코드매핑유형'
              WHEN B.NO = 4 THEN '타겟(TOBE)코드도메인명'
              WHEN B.NO = 5 THEN '타겟(TOBE) 코드값'
              WHEN B.NO = 6 THEN '타겟(TOBE) 코드명'     
              WHEN B.NO = 7 THEN '소스(ASIS)시스템명'
              WHEN B.NO = 8 THEN '소스(ASIS)업무명'
              WHEN B.NO = 9 THEN '소스(ASIS)DB명'
              WHEN B.NO = 10 THEN '소스(ASIS)테이블물리명'
              WHEN B.NO = 11 THEN '소스(ASIS)테이블논리명'
              WHEN B.NO = 12 THEN '소스(ASIS)컬럼물리명'
              WHEN B.NO = 13 THEN '소스(ASIS)컬럼논리명'
              WHEN B.NO = 14 THEN '소스(ASIS) 코드'
              WHEN B.NO = 15 THEN '소스(ASIS) 코드명'
              WHEN B.NO = 16 THEN '소스(ASIS) 상위코드'
              WHEN B.NO = 17 THEN '소스(ASIS) 상위코드명'
              WHEN B.NO = 18 THEN '응용담당자'
              WHEN B.NO = 19 THEN '전환담당자'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_MAP_DF_TYPE
              WHEN B.NO = 2 THEN AFTER_CD_CNVS_TYPE
              WHEN B.NO = 3 THEN AFTER_CD_MAP_TYPE
              WHEN B.NO = 4 THEN AFTER_TGT_DMN_LNM
              WHEN B.NO = 5 THEN AFTER_TGT_CD_VAL
              WHEN B.NO = 6 THEN AFTER_TGT_CD_VAL_NM
              WHEN B.NO = 7 THEN AFTER_SRC_SYS_NM
              WHEN B.NO = 8 THEN AFTER_SRC_BIZ_NM
              WHEN B.NO = 9 THEN AFTER_SRC_DB_PNM
              WHEN B.NO = 10 THEN AFTER_SRC_TBL_PNM
              WHEN B.NO = 11 THEN AFTER_SRC_TBL_LNM
              WHEN B.NO = 12 THEN AFTER_SRC_COL_PNM
              WHEN B.NO = 13 THEN AFTER_SRC_COL_LNM              
              WHEN B.NO = 14 THEN AFTER_SRC_CD_VAL
              WHEN B.NO = 15 THEN AFTER_SRC_CD_VAL_NM
              WHEN B.NO = 16 THEN AFTER_SRC_UPP_CD_VAL
              WHEN B.NO = 17 THEN AFTER_SRC_UPP_CD_VAL_NM
              WHEN B.NO = 18 THEN AFTER_APP_CRGP_NM
              WHEN B.NO = 19 THEN AFTER_CNVS_CRGP_NM
         ELSE NULL END) AS AFTER_DATA          
       ,(CASE WHEN B.NO = 1 THEN BEFORE_MAP_DF_TYPE
              WHEN B.NO = 2 THEN BEFORE_CD_CNVS_TYPE
              WHEN B.NO = 3 THEN BEFORE_CD_MAP_TYPE
              WHEN B.NO = 4 THEN BEFORE_TGT_DMN_LNM
              WHEN B.NO = 5 THEN BEFORE_TGT_CD_VAL
              WHEN B.NO = 6 THEN BEFORE_TGT_CD_VAL_NM
              WHEN B.NO = 7 THEN BEFORE_SRC_SYS_NM
              WHEN B.NO = 8 THEN BEFORE_SRC_BIZ_NM
              WHEN B.NO = 9 THEN BEFORE_SRC_DB_PNM
              WHEN B.NO = 10 THEN BEFORE_SRC_TBL_PNM
              WHEN B.NO = 11 THEN BEFORE_SRC_TBL_LNM
              WHEN B.NO = 12 THEN BEFORE_SRC_COL_PNM
              WHEN B.NO = 13 THEN BEFORE_SRC_COL_LNM              
              WHEN B.NO = 14 THEN BEFORE_SRC_CD_VAL
              WHEN B.NO = 15 THEN BEFORE_SRC_CD_VAL_NM
              WHEN B.NO = 16 THEN BEFORE_SRC_UPP_CD_VAL
              WHEN B.NO = 17 THEN BEFORE_SRC_UPP_CD_VAL_NM
              WHEN B.NO = 18 THEN BEFORE_APP_CRGP_NM
              WHEN B.NO = 19 THEN BEFORE_CNVS_CRGP_NM
         ELSE NULL END) AS BEFORE_DATA  

from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,GET_CMCD_DTL_NM('MAP_DF_TYP_CD', A.MAP_DF_TYPE) AS AFTER_MAP_DF_TYPE
               ,GET_CMCD_DTL_NM('CD_CNVS_TYPE', A.CD_CNVS_TYPE) AS AFTER_CD_CNVS_TYPE
               ,GET_CMCD_DTL_NM('CD_MAP_TYPE', A.CD_MAP_TYPE) AS AFTER_CD_MAP_TYPE
               ,A.TGT_DMN_LNM       AS  AFTER_TGT_DMN_LNM      
               ,A.TGT_CD_VAL        AS  AFTER_TGT_CD_VAL       
               ,A.TGT_CD_VAL_NM     AS  AFTER_TGT_CD_VAL_NM    
               ,A.SRC_SYS_NM        AS  AFTER_SRC_SYS_NM       
               ,A.SRC_BIZ_NM        AS  AFTER_SRC_BIZ_NM       
               ,A.SRC_DB_PNM        AS  AFTER_SRC_DB_PNM       
               ,A.SRC_TBL_PNM       AS  AFTER_SRC_TBL_PNM      
               ,A.SRC_TBL_LNM       AS  AFTER_SRC_TBL_LNM      
               ,A.SRC_COL_PNM       AS  AFTER_SRC_COL_PNM      
               ,A.SRC_COL_LNM       AS  AFTER_SRC_COL_LNM                     
               ,A.SRC_CD_VAL        AS  AFTER_SRC_CD_VAL       
               ,A.SRC_CD_VAL_NM     AS  AFTER_SRC_CD_VAL_NM    
               ,A.SRC_UPP_CD_VAL    AS  AFTER_SRC_UPP_CD_VAL   
               ,A.SRC_UPP_CD_VAL_NM AS  AFTER_SRC_UPP_CD_VAL_NM
               ,A.APP_CRGP_NM AS  AFTER_APP_CRGP_NM
               ,A.CNVS_CRGP_NM AS  AFTER_CNVS_CRGP_NM
               ,B.TGT_DMN_LNM       AS  BEFORE_TGT_DMN_LNM      
               ,B.TGT_CD_VAL        AS  BEFORE_TGT_CD_VAL       
               ,B.TGT_CD_VAL_NM     AS  BEFORE_TGT_CD_VAL_NM    
               ,B.SRC_SYS_NM        AS  BEFORE_SRC_SYS_NM       
               ,B.SRC_BIZ_NM        AS  BEFORE_SRC_BIZ_NM       
               ,B.SRC_DB_PNM        AS  BEFORE_SRC_DB_PNM       
               ,B.SRC_TBL_PNM       AS  BEFORE_SRC_TBL_PNM      
               ,B.SRC_TBL_LNM       AS  BEFORE_SRC_TBL_LNM      
               ,B.SRC_COL_PNM       AS  BEFORE_SRC_COL_PNM      
               ,B.SRC_COL_LNM       AS  BEFORE_SRC_COL_LNM      
               ,B.SRC_CD_VAL        AS  BEFORE_SRC_CD_VAL       
               ,B.SRC_CD_VAL_NM     AS  BEFORE_SRC_CD_VAL_NM    
               ,B.SRC_UPP_CD_VAL    AS  BEFORE_SRC_UPP_CD_VAL   
               ,B.SRC_UPP_CD_VAL_NM AS  BEFORE_SRC_UPP_CD_VAL_NM
               ,GET_CMCD_DTL_NM('MAP_DF_TYP_CD', B.MAP_DF_TYPE) AS BEFORE_MAP_DF_TYPE
               ,GET_CMCD_DTL_NM('CD_CNVS_TYPE', B.CD_CNVS_TYPE) AS BEFORE_CD_CNVS_TYPE
               ,GET_CMCD_DTL_NM('CD_MAP_TYPE', B.CD_MAP_TYPE) AS BEFORE_CD_MAP_TYPE
               ,B.APP_CRGP_NM AS  BEFORE_APP_CRGP_NM
               ,B.CNVS_CRGP_NM AS  BEFORE_CNVS_CRGP_NM
          FROM WAQ_COD_MAP A
               LEFT OUTER JOIN WAM_COD_MAP B
                 ON A.CD_MAP_ID = B.CD_MAP_ID
        WHERE A.RQST_NO = 'REQ_00000005865'
          AND A.RQST_SNO = 1
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_19) B
       )A
  </select>
  <select id="selectBizAreaChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '업무영역명'
              WHEN B.NO = 2 THEN '상위업무영역명'
              WHEN B.NO = 3 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_BIZ_AREA_LNM
              WHEN B.NO = 2 THEN AFTER_UPP_BIZ_AREA_LNM
              WHEN B.NO = 3 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER_DATA          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_BIZ_AREA_LNM
              WHEN B.NO = 2 THEN BEFORE_UPP_BIZ_AREA_LNM
              WHEN B.NO = 3 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE_DATA  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.BIZ_AREA_LNM AS AFTER_BIZ_AREA_LNM
               ,C.BIZ_AREA_LNM AS AFTER_UPP_BIZ_AREA_LNM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.BIZ_AREA_LNM AS BEFORE_BIZ_AREA_LNM
               ,D.BIZ_AREA_LNM AS BEFORE_UPP_BIZ_AREA_LNM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_BIZ_AREA A
               LEFT OUTER JOIN WAM_BIZ_AREA B
                 ON A.BIZ_AREA_ID = B.BIZ_AREA_ID
			   LEFT OUTER JOIN (SELECT BIZ_AREA_ID, BIZ_AREA_LNM
			    				  FROM WAM_BIZ_AREA
			    				 WHERE REG_TYP_CD IN ('C', 'U')
                               ) C
                 ON A.UPP_BIZ_AREA_ID = C.BIZ_AREA_ID
               LEFT OUTER JOIN (SELECT BIZ_AREA_ID, BIZ_AREA_LNM
			    				  FROM WAM_BIZ_AREA
			    				 WHERE REG_TYP_CD IN ('C', 'U')
                               ) D
                 ON B.UPP_BIZ_AREA_ID = D.BIZ_AREA_ID 
			   
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_3) B
       )A
  </select>
  <select id="selectDqiChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '데이터품질지표명'
              WHEN B.NO = 2 THEN '상위데이터품질지표명'
              WHEN B.NO = 3 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_DQI_LNM
              WHEN B.NO = 2 THEN AFTER_UPP_DQI_LNM
              WHEN B.NO = 3 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER_DATA          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_DQI_LNM
              WHEN B.NO = 2 THEN BEFORE_UPP_DQI_LNM
              WHEN B.NO = 3 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE_DATA  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.DQI_LNM AS AFTER_DQI_LNM
               ,C.DQI_LNM AS AFTER_UPP_DQI_LNM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.DQI_LNM AS BEFORE_DQI_LNM
               ,D.DQI_LNM AS BEFORE_UPP_DQI_LNM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_DQI A
               LEFT OUTER JOIN WAM_DQI B
                 ON A.DQI_ID = B.DQI_ID
			   LEFT OUTER JOIN (SELECT DQI_ID, DQI_LNM
			    				  FROM WAM_DQI
			    				 WHERE REG_TYP_CD IN ('C', 'U')
                               ) C
                 ON A.UPP_DQI_ID = C.DQI_ID
               LEFT OUTER JOIN (SELECT DQI_ID, DQI_LNM
			    				  FROM WAM_DQI
			    				 WHERE REG_TYP_CD IN ('C', 'U')
                               ) D
                 ON B.UPP_DQI_ID = D.DQI_ID 
			   
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_3) B
       )A
  </select>
  <select id="selectCtqChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '중요정보항목명'
              WHEN B.NO = 2 THEN '상위중요정보항목명'
              WHEN B.NO = 3 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_CTQ_LNM
              WHEN B.NO = 2 THEN AFTER_UPP_CTQ_LNM
              WHEN B.NO = 3 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER_DATA          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_CTQ_LNM
              WHEN B.NO = 2 THEN BEFORE_UPP_CTQ_LNM
              WHEN B.NO = 3 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE_DATA  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.CTQ_LNM AS AFTER_CTQ_LNM
               ,C.CTQ_LNM AS AFTER_UPP_CTQ_LNM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.CTQ_LNM AS BEFORE_CTQ_LNM
               ,D.CTQ_LNM AS BEFORE_UPP_CTQ_LNM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_CTQ A
               LEFT OUTER JOIN WAM_CTQ B
                 ON A.CTQ_ID = B.CTQ_ID
			   LEFT OUTER JOIN (SELECT CTQ_ID, CTQ_LNM
			    				  FROM WAM_CTQ
			    				 WHERE REG_TYP_CD IN ('C', 'U')
                               ) C
                 ON A.UPP_CTQ_ID = C.CTQ_ID
               LEFT OUTER JOIN (SELECT CTQ_ID, CTQ_LNM
			    				  FROM WAM_CTQ
			    				 WHERE REG_TYP_CD IN ('C', 'U')
                               ) D
                 ON B.UPP_CTQ_ID = D.CTQ_ID 
			   
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_3) B
       )A
  </select>
  <select id="selectBizruleChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '업무규칙명'
              WHEN B.NO = 2 THEN '업무규칙담당자'
              WHEN B.NO = 3 THEN '사용여부'
              WHEN B.NO = 4 THEN '업무영역명'
              WHEN B.NO = 5 THEN '데이터품질지표명'
              WHEN B.NO = 6 THEN '중요정보항목명'
              WHEN B.NO = 7 THEN 'DB접속대상명'
              WHEN B.NO = 8 THEN '테이블명'
              WHEN B.NO = 9 THEN '컬럼명'
              WHEN B.NO = 10 THEN '타겟DB접속대상명'
              WHEN B.NO = 11 THEN '타겟테이블명'
              WHEN B.NO = 12 THEN '타겟컬럼명'
              WHEN B.NO = 13 THEN '타겟키컬럼명'
              WHEN B.NO = 14 THEN '타겟키컬럼값'
              WHEN B.NO = 15 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_BR_NM
              WHEN B.NO = 2 THEN AFTER_BR_CRGP_USER_NM
              WHEN B.NO = 3 THEN AFTER_USE_YN
              WHEN B.NO = 4 THEN AFTER_BIZ_AREA_LNM
              WHEN B.NO = 5 THEN AFTER_DQI_LNM
              WHEN B.NO = 6 THEN AFTER_CTQ_LNM
              WHEN B.NO = 7 THEN AFTER_DB_CONN_TRG_PNM
              WHEN B.NO = 8 THEN AFTER_DBC_TBL_NM
              WHEN B.NO = 9 THEN AFTER_DBC_COL_NM
              WHEN B.NO = 10 THEN AFTER_TGT_DB_CONN_TRG_PNM
              WHEN B.NO = 11 THEN AFTER_TGT_DBC_TBL_NM
              WHEN B.NO = 12 THEN AFTER_TGT_DBC_COL_NM
              WHEN B.NO = 13 THEN AFTER_TGT_KEY_DBC_COL_NM
              WHEN B.NO = 14 THEN AFTER_TGT_KEY_DBC_COL_VAL
              WHEN B.NO = 15 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER_DATA          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_BR_NM
              WHEN B.NO = 2 THEN BEFORE_BR_CRGP_USER_NM
              WHEN B.NO = 3 THEN BEFORE_USE_YN
              WHEN B.NO = 4 THEN BEFORE_BIZ_AREA_LNM
              WHEN B.NO = 5 THEN BEFORE_DQI_LNM
              WHEN B.NO = 6 THEN BEFORE_CTQ_LNM
              WHEN B.NO = 7 THEN BEFORE_DB_CONN_TRG_PNM
              WHEN B.NO = 8 THEN BEFORE_DBC_TBL_NM
              WHEN B.NO = 9 THEN BEFORE_DBC_COL_NM
              WHEN B.NO = 10 THEN BEFORE_TGT_DB_CONN_TRG_PNM
              WHEN B.NO = 11 THEN BEFORE_TGT_DBC_TBL_NM
              WHEN B.NO = 12 THEN BEFORE_TGT_DBC_COL_NM
              WHEN B.NO = 13 THEN BEFORE_TGT_KEY_DBC_COL_NM
              WHEN B.NO = 14 THEN BEFORE_TGT_KEY_DBC_COL_VAL
              WHEN B.NO = 15 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE_DATA  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.BR_NM AS AFTER_BR_NM
               ,C.USER_NM AS AFTER_BR_CRGP_USER_NM
               ,CASE WHEN A.USE_YN = 'Y' THEN '예'
                ELSE CASE WHEN A.USE_YN = 'N' THEN '아니오'
                ELSE NULL END END AS AFTER_USE_YN
               ,A.BIZ_AREA_LNM AS AFTER_BIZ_AREA_LNM
               ,D.DQI_LNM AS AFTER_DQI_LNM
               ,E.CTQ_LNM AS AFTER_CTQ_LNM
               ,A.DB_CONN_TRG_PNM AS AFTER_DB_CONN_TRG_PNM
               ,A.DBC_TBL_NM AS AFTER_DBC_TBL_NM
               ,A.DBC_COL_NM AS AFTER_DBC_COL_NM
               ,A.TGT_DB_CONN_TRG_PNM AS AFTER_TGT_DB_CONN_TRG_PNM
               ,A.TGT_DBC_TBL_NM AS AFTER_TGT_DBC_TBL_NM
               ,A.TGT_DBC_COL_NM AS AFTER_TGT_DBC_COL_NM
               ,A.TGT_KEY_DBC_COL_NM AS AFTER_TGT_KEY_DBC_COL_NM
               ,A.TGT_KEY_DBC_COL_VAL AS AFTER_TGT_KEY_DBC_COL_VAL
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
			   ,B.BR_NM AS BEFORE_BR_NM
               ,F.USER_NM AS BEFORE_BR_CRGP_USER_NM
               ,CASE WHEN B.USE_YN = 'Y' THEN '예'
                ELSE CASE WHEN B.USE_YN = 'N' THEN '아니오'
                ELSE NULL END END AS BEFORE_USE_YN
               ,N.FULL_PATH AS BEFORE_BIZ_AREA_LNM
               ,H.FULL_PATH AS BEFORE_DQI_LNM
               ,J.FULL_PATH AS BEFORE_CTQ_LNM
               ,K.DB_CONN_TRG_PNM AS BEFORE_DB_CONN_TRG_PNM
               ,B.DBC_TBL_NM AS BEFORE_DBC_TBL_NM
               ,B.DBC_COL_NM AS BEFORE_DBC_COL_NM
               ,L.DB_CONN_TRG_PNM AS BEFORE_TGT_DB_CONN_TRG_PNM
               ,B.TGT_DBC_TBL_NM AS BEFORE_TGT_DBC_TBL_NM
               ,B.TGT_DBC_COL_NM AS BEFORE_TGT_DBC_COL_NM
               ,B.TGT_KEY_DBC_COL_NM AS BEFORE_TGT_KEY_DBC_COL_NM
               ,B.TGT_KEY_DBC_COL_VAL AS BEFORE_TGT_KEY_DBC_COL_VAL
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_BR_MSTR A
               LEFT OUTER JOIN WAM_BR_MSTR B
                 ON A.BR_NM = B.BR_NM
               LEFT OUTER JOIN (SELECT USER_ID, USER_NM
               					  FROM WAA_USER
               					 WHERE REG_TYP_CD IN ('C', 'U')
               					   AND EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
               				   ) C
                 ON A.BR_CRGP_USER_ID = C.USER_ID
			   LEFT OUTER JOIN (SELECT DQI_ID, DQI_LNM, RQST_NO, RQST_SNO
			    				  FROM WAQ_BR_DQI_MAP
			    				 WHERE REG_TYP_CD IN ('C', 'U')
                               ) D
                 ON A.RQST_NO = D.RQST_NO
                AND A.RQST_SNO = D.RQST_SNO
               LEFT OUTER JOIN (SELECT CTQ_ID, CTQ_LNM, RQST_NO, RQST_SNO
			    				  FROM WAQ_BR_CTQ_MAP
			    				 WHERE REG_TYP_CD IN ('C', 'U')
                               ) E
                 ON A.RQST_NO = E.RQST_NO
                AND A.RQST_SNO = E.RQST_SNO
			   LEFT OUTER JOIN (SELECT USER_ID, USER_NM
               					  FROM WAA_USER
               					 WHERE REG_TYP_CD IN ('C', 'U')
               					   AND EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
               				   ) F
                 ON B.BR_CRGP_USER_ID = F.USER_ID
               LEFT OUTER JOIN (SELECT BR_ID, DQI_ID
                                  FROM WAM_BR_DQI_MAP
                                 WHERE REG_TYP_CD IN ('C', 'U')
                               ) G
                 ON B.BR_ID = G.BR_ID
               LEFT OUTER JOIN (SELECT DQI_ID, DQI_LNM, FULL_PATH
               					  FROM WAM_DQI
               					 WHERE REG_TYP_CD IN ('C', 'U')
               				   ) H
                 ON G.DQI_ID = H.DQI_ID
               LEFT OUTER JOIN (SELECT BR_ID, CTQ_ID
                                  FROM WAM_BR_CTQ_MAP
                                 WHERE REG_TYP_CD IN ('C', 'U')
                               ) I
                 ON B.BR_ID = I.BR_ID
               LEFT OUTER JOIN (SELECT CTQ_ID, CTQ_LNM, FULL_PATH
               					  FROM WAM_CTQ
               					 WHERE REG_TYP_CD IN ('C', 'U')
               				   ) J
                 ON I.CTQ_ID = J.CTQ_ID
               LEFT OUTER JOIN (SELECT DB_CONN_TRG_ID, DB_CONN_TRG_PNM
               					  FROM WAA_DB_CONN_TRG
               					 WHERE REG_TYP_CD IN ('C', 'U')
               					   AND EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
               				   ) K
               	 ON B.DB_CONN_TRG_ID = K.DB_CONN_TRG_ID 
               LEFT OUTER JOIN (SELECT DB_CONN_TRG_ID, DB_CONN_TRG_PNM
               					  FROM WAA_DB_CONN_TRG
               					 WHERE REG_TYP_CD IN ('C', 'U')
               					   AND EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
               				   ) L
               	 ON B.TGT_DB_CONN_TRG_ID = L.DB_CONN_TRG_ID 
               LEFT OUTER JOIN (SELECT BIZ_AREA_ID, BIZ_AREA_LNM, FULL_PATH
               					  FROM WAM_BIZ_AREA
               					 WHERE REG_TYP_CD IN ('C', 'U')
               				   ) N
               	 ON B.BIZ_AREA_ID = N.BIZ_AREA_ID
                            
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_15) B
       )A
  </select>
  <select id="selectImPlChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '원인분석코드명'
              WHEN B.NO = 2 THEN '원인분석내역'
              WHEN B.NO = 3 THEN '원인분석시작일자'
              WHEN B.NO = 4 THEN '원인분석종료일자'
              WHEN B.NO = 5 THEN '개선계획코드명'
              WHEN B.NO = 6 THEN '개선계획내역'
              WHEN B.NO = 7 THEN '개선계획시작일자'
              WHEN B.NO = 8 THEN '개선계획종료일자'
              WHEN B.NO = 9 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_CS_ANA_CD_NM
              WHEN B.NO = 2 THEN AFTER_CS_ANA_DTLS
              WHEN B.NO = 3 THEN AFTER_CS_ANA_STR_DTM
              WHEN B.NO = 4 THEN AFTER_CS_ANA_END_DTM
              WHEN B.NO = 5 THEN AFTER_IM_PL_CD_NM
              WHEN B.NO = 6 THEN AFTER_IM_PL_DTLS
              WHEN B.NO = 7 THEN AFTER_IM_PL_STR_DTM
              WHEN B.NO = 8 THEN AFTER_IM_PL_END_DTM
              WHEN B.NO = 9 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER_DATA          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_CS_ANA_CD_NM
              WHEN B.NO = 2 THEN BEFORE_CS_ANA_DTLS
              WHEN B.NO = 3 THEN BEFORE_CS_ANA_STR_DTM
              WHEN B.NO = 4 THEN BEFORE_CS_ANA_END_DTM
              WHEN B.NO = 5 THEN BEFORE_IM_PL_CD_NM
              WHEN B.NO = 6 THEN BEFORE_IM_PL_DTLS
              WHEN B.NO = 7 THEN BEFORE_IM_PL_STR_DTM
              WHEN B.NO = 8 THEN BEFORE_IM_PL_END_DTM
              WHEN B.NO = 9 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE_DATA  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.CS_ANA_CD_NM AS AFTER_CS_ANA_CD_NM
               ,A.CS_ANA_DTLS AS AFTER_CS_ANA_DTLS
               ,DATE_FORMAT(STR_TO_DATE(A.CS_ANA_STR_DTM, '%Y%m%d'), '%Y-%m-%d') AS AFTER_CS_ANA_STR_DTM
               ,DATE_FORMAT(STR_TO_DATE(A.CS_ANA_END_DTM, '%Y%m%d'), '%Y-%m-%d') AS AFTER_CS_ANA_END_DTM
               ,A.IM_PL_CD_NM AS AFTER_IM_PL_CD_NM
               ,A.IM_PL_DTLS AS AFTER_IM_PL_DTLS
               ,DATE_FORMAT(STR_TO_DATE(A.IM_PL_STR_DTM, '%Y%m%d'), '%Y-%m-%d') AS AFTER_IM_PL_STR_DTM
               ,DATE_FORMAT(STR_TO_DATE(A.IM_PL_END_DTM, '%Y%m%d'), '%Y-%m-%d') AS AFTER_IM_PL_END_DTM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
			   ,B.CS_ANA_CD_NM AS BEFORE_CS_ANA_CD_NM
               ,B.CS_ANA_DTLS AS BEFORE_CS_ANA_DTLS
               ,DATE_FORMAT(STR_TO_DATE(A.CS_ANA_STR_DTM, '%Y%m%d'), '%Y-%m-%d') AS BEFORE_CS_ANA_STR_DTM
               ,DATE_FORMAT(STR_TO_DATE(A.CS_ANA_END_DTM, '%Y%m%d'), '%Y-%m-%d') AS BEFORE_CS_ANA_END_DTM
               ,B.IM_PL_CD_NM AS BEFORE_IM_PL_CD_NM
               ,B.IM_PL_DTLS AS BEFORE_IM_PL_DTLS
               ,DATE_FORMAT(STR_TO_DATE(B.IM_PL_STR_DTM, '%Y%m%d'), '%Y-%m-%d') AS BEFORE_IM_PL_STR_DTM
               ,DATE_FORMAT(STR_TO_DATE(B.IM_PL_END_DTM, '%Y%m%d'), '%Y-%m-%d') AS BEFORE_IM_PL_END_DTM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_CS_ANA_MSTR A
               LEFT OUTER JOIN WAM_CS_ANA_MSTR B
                 ON A.ANA_JOB_ID = B.ANA_JOB_ID
                AND A.ANA_STR_DTM = B.ANA_STR_DTM
                                           
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_9) B
       )A
  </select>
  <select id="selectImRslChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '개선결과코드명'
              WHEN B.NO = 2 THEN '개선결과내역'
              WHEN B.NO = 3 THEN '개선활동시작일자'
              WHEN B.NO = 4 THEN '개선활동종료일자'
              WHEN B.NO = 5 THEN '개선불가코드명'
              WHEN B.NO = 6 THEN '스케줄작업삭제요청여부'
              WHEN B.NO = 7 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_IM_RSL_CD_NM
              WHEN B.NO = 2 THEN AFTER_IM_ACT_DTLS
              WHEN B.NO = 3 THEN AFTER_IM_ACT_STR_DTM
              WHEN B.NO = 4 THEN AFTER_IM_ACT_END_DTM
              WHEN B.NO = 5 THEN AFTER_IM_IL_CD_NM
              WHEN B.NO = 6 THEN AFTER_SHD_JOB_DEL_RQST_YN
              WHEN B.NO = 7 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER_DATA          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_IM_RSL_CD_NM
              WHEN B.NO = 2 THEN BEFORE_IM_ACT_DTLS
              WHEN B.NO = 3 THEN BEFORE_IM_ACT_STR_DTM
              WHEN B.NO = 4 THEN BEFORE_IM_ACT_END_DTM
              WHEN B.NO = 5 THEN BEFORE_IM_IL_CD_NM
              WHEN B.NO = 6 THEN BEFORE_SHD_JOB_DEL_RQST_YN
              WHEN B.NO = 7 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE_DATA  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.IM_RSL_CD_NM AS AFTER_IM_RSL_CD_NM
               ,A.IM_ACT_DTLS AS AFTER_IM_ACT_DTLS
               ,DATE_FORMAT(STR_TO_DATE(A.IM_ACT_STR_DTM, '%Y%m%d'), '%Y-%m-%d') AS AFTER_IM_ACT_STR_DTM
               ,DATE_FORMAT(STR_TO_DATE(A.IM_ACT_END_DTM, '%Y%m%d'), '%Y-%m-%d') AS AFTER_IM_ACT_END_DTM
               ,A.IM_IL_CD_NM AS AFTER_IM_IL_CD_NM
               ,CASE WHEN A.SHD_JOB_DEL_RQST_YN = 'Y' THEN '예'
                ELSE CASE WHEN A.SHD_JOB_DEL_RQST_YN = 'N' THEN '아니오'
                ELSE NULL END END AS AFTER_SHD_JOB_DEL_RQST_YN
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.IM_RSL_CD_NM AS BEFORE_IM_RSL_CD_NM
               ,B.IM_ACT_DTLS AS BEFORE_IM_ACT_DTLS
               ,DATE_FORMAT(STR_TO_DATE(B.IM_ACT_STR_DTM, '%Y%m%d'), '%Y-%m-%d') AS BEFORE_IM_ACT_STR_DTM
               ,DATE_FORMAT(STR_TO_DATE(B.IM_ACT_END_DTM, '%Y%m%d'), '%Y-%m-%d') AS BEFORE_IM_ACT_END_DTM
               ,B.IM_IL_CD_NM AS BEFORE_IM_IL_CD_NM
               ,CASE WHEN B.SHD_JOB_DEL_RQST_YN = 'Y' THEN '예'
                ELSE CASE WHEN B.SHD_JOB_DEL_RQST_YN = 'N' THEN '아니오'
                ELSE NULL END END AS BEFORE_SHD_JOB_DEL_RQST_YN
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
			  
          FROM WAQ_IM_ACT_MSTR A
               LEFT OUTER JOIN WAM_IM_ACT_MSTR B
                 ON A.ANA_JOB_ID = B.ANA_JOB_ID
                AND A.ANA_STR_DTM = B.ANA_STR_DTM
                                           
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_7) B
       )A
  </select>
  
  <select id="selectCodeCfcSysChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '코드분류체계유형'
              WHEN B.NO = 2 THEN '코드분류체계명'
              WHEN B.NO = 3 THEN '코드분류체계포맷'
              WHEN B.NO = 4 THEN '담당자'
              WHEN B.NO = 5 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_CODE_CFC_SYS_CD
              WHEN B.NO = 2 THEN AFTER_CODE_CFC_SYS_LNM
              WHEN B.NO = 3 THEN AFTER_CODE_CFC_SYS_FRM
              WHEN B.NO = 4 THEN AFTER_CRG_USER_NM
              WHEN B.NO = 5 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER_DATA          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_CODE_CFC_SYS_CD
              WHEN B.NO = 2 THEN BEFORE_CODE_CFC_SYS_LNM
              WHEN B.NO = 3 THEN BEFORE_CODE_CFC_SYS_FRM
              WHEN B.NO = 4 THEN BEFORE_CRG_USER_NM
              WHEN B.NO = 5 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE_DATA  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,C.COMM_DTL_CD_NM AS AFTER_CODE_CFC_SYS_CD
               ,A.CODE_CFC_SYS_LNM AS AFTER_CODE_CFC_SYS_LNM
               ,A.CODE_CFC_SYS_FRM AS AFTER_CODE_CFC_SYS_FRM
			   ,D.USER_NM AS AFTER_CRG_USER_NM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,E.COMM_DTL_CD_NM AS BEFORE_CODE_CFC_SYS_CD
               ,B.CODE_CFC_SYS_LNM AS BEFORE_CODE_CFC_SYS_LNM
               ,B.CODE_CFC_SYS_FRM AS BEFORE_CODE_CFC_SYS_FRM
			   ,F.USER_NM AS BEFORE_CRG_USER_NM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
			  
          FROM WAQ_CODE_CFC_SYS A
               LEFT OUTER JOIN WAM_CODE_CFC_SYS B
                 ON A.CODE_CFC_SYS_CD = B.CODE_CFC_SYS_CD
                AND A.CODE_CFC_SYS_LNM = B.CODE_CFC_SYS_LNM
				AND B.REG_TYP_CD IN ('C', 'U')
			   LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'CODE_CFC_SYS_CD'
                                ) C   
                 ON A.CODE_CFC_SYS_CD = C.COMM_DTL_CD    
               LEFT OUTER JOIN (SELECT USER_ID, USER_NM
                                  FROM WAA_USER
                                 WHERE EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                   AND REG_TYP_CD IN ('C', 'U')
                               ) D
                 ON A.CRG_USER_ID = D.USER_ID
               LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'CODE_CFC_SYS_CD'
                                ) E   
                 ON B.CODE_CFC_SYS_CD = E.COMM_DTL_CD   
               LEFT OUTER JOIN (SELECT USER_ID, USER_NM
                                  FROM WAA_USER
                                 WHERE EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                   AND REG_TYP_CD IN ('C', 'U')
                               ) F
                 ON B.CRG_USER_ID = F.USER_ID          
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_5) B
       )A
  </select>
  
  <select id="selectDdlIdxChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 SELECT  RQST_NO
       , RQST_SNO
       , (CASE WHEN B.NO = 1 THEN '인덱스물리명'
               WHEN B.NO = 2 THEN '인덱스논리명'
               WHEN B.NO = 3 THEN 'DB접속정보명'
               WHEN B.NO = 4 THEN 'DB스키마명'
               WHEN B.NO = 5 THEN 'DDL테이블명'
               WHEN B.NO = 6 THEN '인덱스스페이스명'
               WHEN B.NO = 7 THEN '인덱스유형'
               WHEN B.NO = 8 THEN 'PK여부'
               WHEN B.NO = 9 THEN 'UNIQUE여부'
               WHEN B.NO = 10 THEN '설명'                
          ELSE NULL END) AS ITEM_NM          
       , (CASE WHEN B.NO = 1 THEN AFTER_DDL_IDX_PNM
               WHEN B.NO = 2 THEN AFTER_DDL_IDX_LNM
               WHEN B.NO = 3 THEN AFTER_DB_CONN_TRG_PNM
               WHEN B.NO = 4 THEN AFTER_DB_SCH_PNM
               WHEN B.NO = 5 THEN AFTER_DDL_TBL_PNM
               WHEN B.NO = 6 THEN AFTER_IDX_SPAC_PNM
               WHEN B.NO = 7 THEN AFTER_IDX_TYP_CD
               WHEN B.NO = 8 THEN AFTER_PK_IDX_YN
               WHEN B.NO = 9 THEN AFTER_UK_IDX_YN
               WHEN B.NO = 10 THEN AFTER_OBJ_DESCN
          ELSE NULL END) AS AFTER_DATA           
       , (CASE WHEN B.NO = 1 THEN BEFORE_DDL_IDX_PNM
               WHEN B.NO = 2 THEN BEFORE_DDL_IDX_LNM
               WHEN B.NO = 3 THEN BEFORE_DB_CONN_TRG_PNM
               WHEN B.NO = 4 THEN BEFORE_DB_SCH_PNM
               WHEN B.NO = 5 THEN BEFORE_DDL_TBL_PNM
               WHEN B.NO = 6 THEN BEFORE_IDX_SPAC_PNM
               WHEN B.NO = 7 THEN BEFORE_IDX_TYP_CD
               WHEN B.NO = 8 THEN BEFORE_PK_IDX_YN
               WHEN B.NO = 9 THEN BEFORE_UK_IDX_YN
               WHEN B.NO = 10 THEN BEFORE_OBJ_DESCN
          ELSE NULL END) AS BEFORE_DATA   
    FROM (SELECT A.RQST_NO
               , A.RQST_SNO
               , A.DDL_IDX_PNM     AS AFTER_DDL_IDX_PNM
               , A.DDL_IDX_LNM     AS AFTER_DDL_IDX_LNM
               , A.DB_CONN_TRG_PNM AS AFTER_DB_CONN_TRG_PNM
               , A.DB_SCH_PNM      AS AFTER_DB_SCH_PNM
               , A.DDL_TBL_PNM     AS AFTER_DDL_TBL_PNM
               , A.IDX_SPAC_PNM    AS AFTER_IDX_SPAC_PNM
               , C.COMM_DTL_CD_NM  AS AFTER_IDX_TYP_CD
               , CASE WHEN A.PK_IDX_YN = 'Y' THEN '예'
                 ELSE CASE WHEN A.PK_IDX_YN = 'N' THEN '아니오'
                 ELSE NULL END END AS AFTER_PK_IDX_YN
               , CASE WHEN A.UK_IDX_YN = 'Y' THEN '예'
                 ELSE CASE WHEN A.UK_IDX_YN = 'N' THEN '아니오'
                 ELSE NULL END END AS AFTER_UK_IDX_YN
               , A.OBJ_DESCN       AS AFTER_OBJ_DESCN
               , B.DDL_IDX_PNM     AS BEFORE_DDL_IDX_PNM
               , B.DDL_IDX_LNM     AS BEFORE_DDL_IDX_LNM
               , D.DB_CONN_TRG_PNM AS BEFORE_DB_CONN_TRG_PNM
               , E.DB_SCH_PNM      AS BEFORE_DB_SCH_PNM
               , F.DDL_TBL_PNM     AS BEFORE_DDL_TBL_PNM
               , G.DB_TBL_SPAC_PNM AS BEFORE_IDX_SPAC_PNM
               , H.COMM_DTL_CD_NM  AS BEFORE_IDX_TYP_CD
               , CASE WHEN B.PK_IDX_YN = 'Y' THEN '예'
                 ELSE CASE WHEN B.PK_IDX_YN = 'N' THEN '아니오'
                 ELSE NULL END END AS BEFORE_PK_IDX_YN
               , CASE WHEN B.UK_IDX_YN = 'Y' THEN '예'
                 ELSE CASE WHEN B.UK_IDX_YN = 'N' THEN '아니오'
                 ELSE NULL END END AS BEFORE_UK_IDX_YN
               , B.OBJ_DESCN       AS BEFORE_OBJ_DESCN
          FROM WAQ_DDL_IDX A
               LEFT JOIN WAH_DDL_IDX B
                 ON A.DB_SCH_ID   = B.DB_SCH_ID
                AND A.DDL_IDX_PNM = B.DDL_IDX_PNM
               LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'IDX_TYP_CD'
                                ) C
                 ON A.IDX_TYP_CD = C.COMM_DTL_CD    
               LEFT JOIN WAM_DDL_TBL F
                 ON B.DDL_TBL_ID = F.DDL_TBL_ID
                AND F.REG_TYP_CD IN ('C', 'U')
               LEFT JOIN WAA_DB_CONN_TRG D
                 ON B.DB_CONN_TRG_ID = D.DB_CONN_TRG_ID
                AND D.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                AND D.REG_TYP_CD IN ('C', 'U')
			   LEFT JOIN WAA_DB_SCH E
                 ON B.DB_SCH_ID = E.DB_SCH_ID
                AND E.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                AND E.REG_TYP_CD IN ('C', 'U')
               LEFT JOIN WAA_TBL_SPAC G
                 ON B.IDX_SPAC_ID = G.DB_TBL_SPAC_ID
                AND G.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                AND G.REG_TYP_CD IN ('C', 'U')
               LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'IDX_TYP_CD'
                                ) H
                 ON B.IDX_TYP_CD = H.COMM_DTL_CD  
         WHERE B.REG_TYP_CD IN ('C','U')
           AND A.RQST_DTM BETWEEN B.STR_DTM AND B.EXP_DTM          
           AND A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_10) B
       )A
  </select>
  
  <select id="selectDdlIdxColChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,RQST_DTL_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 SELECT RQST_NO
      , RQST_SNO
      , RQST_DTL_SNO
      , (CASE WHEN B.NO = 1 THEN '인덱스컬럼물리명'
              WHEN B.NO = 2 THEN '인덱스컬럼논리명'
              WHEN B.NO = 3 THEN '인덱스컬럼순서'
              WHEN B.NO = 4 THEN '정렬순서'
              WHEN B.NO = 5 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
      , (CASE WHEN B.NO = 1 THEN AFTER_DDL_IDX_COL_PNM
              WHEN B.NO = 2 THEN AFTER_DDL_IDX_COL_LNM
              WHEN B.NO = 3 THEN CONCAT(AFTER_DDL_IDX_COL_ORD)
              WHEN B.NO = 4 THEN AFTER_SORT_TYP
              WHEN B.NO = 5 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER_DATA          
         
      , (CASE WHEN B.NO = 1 THEN BEFORE_DDL_IDX_COL_PNM
              WHEN B.NO = 2 THEN BEFORE_DDL_IDX_COL_LNM
              WHEN B.NO = 3 THEN CONCAT(BEFORE_DDL_IDX_COL_ORD)
              WHEN B.NO = 4 THEN BEFORE_SORT_TYP
              WHEN B.NO = 5 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE_DATA  
  FROM (SELECT A.RQST_NO
             , A.RQST_SNO
             , A.RQST_DTL_SNO
             , A.DDL_IDX_COL_PNM AS AFTER_DDL_IDX_COL_PNM
             , A.DDL_IDX_COL_LNM AS AFTER_DDL_IDX_COL_LNM
             , A.DDL_IDX_COL_ORD AS AFTER_DDL_IDX_COL_ORD
             , A.SORT_TYP        AS AFTER_SORT_TYP
             , A.OBJ_DESCN       AS AFTER_OBJ_DESCN
             , B.DDL_IDX_COL_PNM AS BEFORE_DDL_IDX_COL_PNM
             , B.DDL_IDX_COL_LNM AS BEFORE_DDL_IDX_COL_LNM
             , B.DDL_IDX_COL_ORD AS BEFORE_DDL_IDX_COL_ORD
             , B.SORT_TYP        AS BEFORE_SORT_TYP
             , B.OBJ_DESCN       AS BEFORE_OBJ_DESCN
          FROM WAQ_DDL_IDX_COL A
               LEFT JOIN WAH_DDL_IDX_COL B
                 ON A.DDL_IDX_ID      = B.DDL_IDX_ID
                AND A.DDL_IDX_COL_PNM = B.DDL_IDX_COL_PNM                
         WHERE B.REG_TYP_CD IN ('C','U')
           AND A.RQST_DTM BETWEEN B.STR_DTM AND B.EXP_DTM                
           AND A.RQST_NO          = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO         = #{rqstSno,jdbcType=DECIMAL}
           AND A.RQST_DTL_SNO     = #{rqstDtlSno,jdbcType=DECIMAL}
           AND A.RQST_DTL_DTL_SNO = #{rqstDtlDtlSno,jdbcType=DECIMAL}
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_5) B
       )A
  </select>
  
  <select id="selectDdlRelChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,RQST_DTL_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,RQST_DTL_SNO
       ,(CASE WHEN B.NO = 1 THEN '관계물리명'
              WHEN B.NO = 2 THEN '관계논리명'
              WHEN B.NO = 3 THEN '관계유형'
              WHEN B.NO = 4 THEN '카디널리티유형'
              WHEN B.NO = 5 THEN 'Parent Optionality 유형'     
              WHEN B.NO = 6 THEN '부모엔터티 주제영역명'
              WHEN B.NO = 7 THEN '부모엔터티명'
              WHEN B.NO = 8 THEN '부모엔터티 속성명'
              WHEN B.NO = 9 THEN '자식엔터티 주제영역명'
              WHEN B.NO = 10 THEN '자식엔터티명'
              WHEN B.NO = 11 THEN '자식엔터티 속성명'
              WHEN B.NO = 12 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_DDL_REL_PNM
              WHEN B.NO = 2 THEN AFTER_DDL_REL_LNM
              WHEN B.NO = 3 THEN AFTER_REL_TYP_CD
              WHEN B.NO = 4 THEN AFTER_CRD_TYP_CD
              WHEN B.NO = 5 THEN AFTER_PA_OPT_TYP_CD
              WHEN B.NO = 6 THEN AFTER_PA_SUBJ_PNM
              WHEN B.NO = 7 THEN AFTER_PA_ENTY_PNM
              WHEN B.NO = 8 THEN AFTER_PA_ATTR_PNM
              WHEN B.NO = 9 THEN AFTER_CH_SUBJ_PNM
              WHEN B.NO = 10 THEN AFTER_CH_ENTY_PNM
              WHEN B.NO = 11 THEN AFTER_CH_ATTR_PNM
              WHEN B.NO = 12 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER_DATA          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_DDL_REL_PNM
       		  WHEN B.NO = 2 THEN BEFORE_DDL_REL_LNM
              WHEN B.NO = 3 THEN BEFORE_REL_TYP_CD
              WHEN B.NO = 4 THEN BEFORE_CRD_TYP_CD
              WHEN B.NO = 5 THEN BEFORE_PA_OPT_TYP_CD
              WHEN B.NO = 6 THEN BEFORE_PA_SUBJ_PNM
              WHEN B.NO = 7 THEN BEFORE_PA_ENTY_PNM
              WHEN B.NO = 8 THEN BEFORE_PA_ATTR_PNM
              WHEN B.NO = 9 THEN BEFORE_CH_SUBJ_PNM
              WHEN B.NO = 10 THEN BEFORE_CH_ENTY_PNM
              WHEN B.NO = 11 THEN BEFORE_CH_ATTR_PNM
              WHEN B.NO = 12 THEN BEFORE_OBJ_DESCN  
         ELSE NULL END) AS BEFORE_DATA  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.RQST_DTL_SNO
               ,A.DDL_REL_PNM AS AFTER_DDL_REL_PNM
               ,A.DDL_REL_LNM AS AFTER_DDL_REL_LNM
               ,C.COMM_DTL_CD_NM AS AFTER_REL_TYP_CD
               ,D.COMM_DTL_CD_NM AS AFTER_CRD_TYP_CD
               ,E.COMM_DTL_CD_NM AS AFTER_PA_OPT_TYP_CD
               ,A.PA_SUBJ_PNM AS AFTER_PA_SUBJ_PNM
               ,A.PA_ENTY_PNM AS AFTER_PA_ENTY_PNM
               ,A.PA_ATTR_PNM AS AFTER_PA_ATTR_PNM
               ,A.CH_SUBJ_PNM AS AFTER_CH_SUBJ_PNM
               ,A.CH_ENTY_PNM AS AFTER_CH_ENTY_PNM
               ,A.CH_ATTR_PNM AS AFTER_CH_ATTR_PNM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.DDL_REL_PNM AS BEFORE_DDL_REL_PNM
               ,B.DDL_REL_LNM AS BEFORE_DDL_REL_LNM
               ,F.COMM_DTL_CD_NM AS BEFORE_REL_TYP_CD
               ,G.COMM_DTL_CD_NM AS BEFORE_CRD_TYP_CD
               ,H.COMM_DTL_CD_NM AS BEFORE_PA_OPT_TYP_CD
               ,I.FULL_PATH AS BEFORE_PA_SUBJ_PNM
               ,J.DDL_TBL_PNM AS BEFORE_PA_ENTY_PNM
               ,K.DDL_COL_PNM AS BEFORE_PA_ATTR_PNM
               ,L.FULL_PATH AS BEFORE_CH_SUBJ_PNM
               ,M.DDL_TBL_PNM AS BEFORE_CH_ENTY_PNM
               ,N.DDL_COL_PNM AS BEFORE_CH_ATTR_PNM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_DDL_REL A
               LEFT OUTER JOIN WAM_DDL_REL B
                 ON A.DDL_REL_PNM = B.DDL_REL_PNM
                AND A.CH_SUBJ_PNM = ( SELECT FULL_PATH
			   						   FROM WAA_SUBJ
			   						  WHERE SUBJ_ID = B.CH_SUBJ_ID
			   						    AND REG_TYP_CD IN ('C', 'U')
			   						    AND EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')  
			   					    )
				AND A.CH_ENTY_PNM = ( SELECT DDL_TBL_PNM
			   					 	   FROM WAM_DDL_TBL
			   					 	  WHERE DDL_TBL_ID = B.CH_ENTY_ID
			   					 	    AND REG_TYP_CD IN ('C', 'U')
			   					    )
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'REL_TYP_CD'
                                ) C
            ON A.REL_TYP_CD = C.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'CRD_TYP_CD'
                                ) D
            ON A.CRD_TYP_CD = D.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'PA_OPT_TYP_CD'
                                ) E
            ON A.PA_OPT_TYP_CD = E.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'REL_TYP_CD'
                                ) F
            ON B.REL_TYP_CD = F.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'CRD_TYP_CD'
                                ) G
            ON B.CRD_TYP_CD = G.COMM_DTL_CD
          LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'PA_OPT_TYP_CD'
                                ) H
            ON B.PA_OPT_TYP_CD = H.COMM_DTL_CD
          LEFT OUTER JOIN WAA_SUBJ I
          	ON B.PA_SUBJ_ID = I.SUBJ_ID
           AND I.REG_TYP_CD IN ('C', 'U')
           AND I.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
          LEFT OUTER JOIN WAM_DDL_TBL J
            ON B.PA_ENTY_ID = J.DDL_TBL_ID
           AND J.REG_TYP_CD IN ('C', 'U')
          LEFT OUTER JOIN WAM_DDL_COL K
            ON B.PA_ATTR_ID = K.DDL_COL_ID
           AND B.PA_ENTY_ID = K.DDL_TBL_ID
          LEFT OUTER JOIN WAA_SUBJ L
          	ON B.CH_SUBJ_ID = L.SUBJ_ID
           AND L.REG_TYP_CD IN ('C', 'U')
           AND L.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
          LEFT OUTER JOIN WAM_DDL_TBL M
            ON B.CH_ENTY_ID = M.DDL_TBL_ID
           AND M.REG_TYP_CD IN ('C', 'U')
          LEFT OUTER JOIN WAM_DDL_COL N
            ON B.CH_ATTR_ID = N.DDL_COL_ID
           AND B.CH_ENTY_ID = N.DDL_TBL_ID
			   
               
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
           AND A.RQST_DTL_SNO = #{rqstDtlSno,jdbcType=DECIMAL}
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_12) B
       )A
  </select>
  
  <select id="selectDdlTsfTblChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '테이블논리명'
              WHEN B.NO = 2 THEN '테이블물리명'
              WHEN B.NO = 3 THEN '소스DB스키마명'
              WHEN B.NO = 4 THEN '타겟DB스키마명'
              WHEN B.NO = 5 THEN '테이블스페이스명'
              WHEN B.NO = 6 THEN '파티션여부'
              WHEN B.NO = 7 THEN '개인정보분리보관여부'
              WHEN B.NO = 8 THEN '설명'
              
         ELSE NULL END) AS ITEM_NM          
       ,(CASE WHEN B.NO = 1 THEN AFTER_DDL_TBL_LNM
              WHEN B.NO = 2 THEN AFTER_DDL_TBL_PNM
              WHEN B.NO = 3 THEN AFTER_SRC_DB_SCH_PNM
              WHEN B.NO = 4 THEN AFTER_TGT_DB_SCH_PNM
              WHEN B.NO = 5 THEN AFTER_TBL_SPAC_PNM
              WHEN B.NO = 6 THEN AFTER_PART_TBL_YN
              WHEN B.NO = 7 THEN AFTER_PCI_YN
              WHEN B.NO = 8 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER_DATA          
       ,(CASE WHEN B.NO = 1 THEN BEFORE_DDL_TBL_LNM
              WHEN B.NO = 2 THEN BEFORE_DDL_TBL_PNM
              WHEN B.NO = 3 THEN BEFORE_SRC_DB_SCH_PNM
              WHEN B.NO = 4 THEN BEFORE_TGT_DB_SCH_PNM
              WHEN B.NO = 5 THEN BEFORE_TBL_SPAC_PNM
              WHEN B.NO = 6 THEN BEFORE_PART_TBL_YN
              WHEN B.NO = 7 THEN BEFORE_PCI_YN
              WHEN B.NO = 8 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE_DATA  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.DDL_TBL_LNM AS AFTER_DDL_TBL_LNM
               ,A.DDL_TBL_PNM AS AFTER_DDL_TBL_PNM
               ,A.SRC_DB_SCH_PNM AS AFTER_SRC_DB_SCH_PNM
               ,A.TGT_DB_SCH_PNM AS AFTER_TGT_DB_SCH_PNM
               ,A.TBL_SPAC_PNM AS AFTER_TBL_SPAC_PNM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.DDL_TBL_LNM AS BEFORE_DDL_TBL_LNM
               ,B.DDL_TBL_PNM AS BEFORE_DDL_TBL_PNM
               ,C.DB_SCH_PNM AS BEFORE_SRC_DB_SCH_PNM
               ,D.DB_SCH_PNM AS BEFORE_TGT_DB_SCH_PNM
               ,E.DB_TBL_SPAC_PNM AS BEFORE_TBL_SPAC_PNM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
               ,B.PART_TBL_YN AS BEFORE_PART_TBL_YN
               ,A.PART_TBL_YN AS AFTER_PART_TBL_YN
               ,B.PCI_YN      AS BEFORE_PCI_YN
               ,A.PCI_YN      AS AFTER_PCI_YN
          FROM WAQ_DDL_TSF_TBL A
               LEFT OUTER JOIN WAM_DDL_TSF_TBL B
                 ON A.DDL_TBL_PNM = B.DDL_TBL_PNM
                AND A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID
                AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID
			   LEFT OUTER JOIN  WAA_DB_SCH C
                 ON B.SRC_DB_SCH_ID = C.DB_SCH_ID
                AND C.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                AND C.REG_TYP_CD IN ('C', 'U')
			   LEFT OUTER JOIN  WAA_DB_SCH D
                 ON B.TGT_DB_SCH_ID = D.DB_SCH_ID
                AND D.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                AND D.REG_TYP_CD IN ('C', 'U')
               LEFT OUTER JOIN WAA_TBL_SPAC E
                 ON B.TBL_SPAC_ID = E.DB_TBL_SPAC_ID
                AND E.REG_TYP_CD IN ('C', 'U')
                AND E.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_8) B
       )A
  </select>
  
  <select id="selectDdlTsfIdxChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE WHEN B.NO = 1 THEN '인덱스물리명'
              WHEN B.NO = 2 THEN '인덱스논리명'
              WHEN B.NO = 3 THEN '소스DB스키마명'
              WHEN B.NO = 4 THEN '타겟DB스키마명'
              WHEN B.NO = 5 THEN '인덱스스페이스명'
              WHEN B.NO = 6 THEN '설명'
              
         ELSE NULL END) AS ITEM_NM          
       ,(CASE WHEN B.NO = 1 THEN AFTER_DDL_IDX_PNM
              WHEN B.NO = 2 THEN AFTER_DDL_IDX_LNM
              WHEN B.NO = 3 THEN AFTER_SRC_DB_SCH_PNM
              WHEN B.NO = 4 THEN AFTER_TGT_DB_SCH_PNM
              WHEN B.NO = 5 THEN AFTER_IDX_SPAC_PNM
              WHEN B.NO = 6 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER_DATA          
       ,(CASE WHEN B.NO = 1 THEN BEFORE_DDL_IDX_PNM
              WHEN B.NO = 2 THEN BEFORE_DDL_IDX_LNM
              WHEN B.NO = 3 THEN BEFORE_SRC_DB_SCH_PNM
              WHEN B.NO = 4 THEN BEFORE_TGT_DB_SCH_PNM
              WHEN B.NO = 5 THEN BEFORE_IDX_SPAC_PNM
              WHEN B.NO = 6 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE_DATA  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.DDL_IDX_PNM AS AFTER_DDL_IDX_PNM
               ,A.DDL_IDX_LNM AS AFTER_DDL_IDX_LNM
               ,A.SRC_DB_SCH_PNM AS AFTER_SRC_DB_SCH_PNM
               ,A.TGT_DB_SCH_PNM AS AFTER_TGT_DB_SCH_PNM
               ,A.IDX_SPAC_PNM AS AFTER_IDX_SPAC_PNM
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.DDL_IDX_PNM AS BEFORE_DDL_IDX_PNM
               ,B.DDL_IDX_LNM AS BEFORE_DDL_IDX_LNM
               ,D.DB_SCH_PNM AS BEFORE_SRC_DB_SCH_PNM
               ,E.DB_SCH_PNM AS BEFORE_TGT_DB_SCH_PNM
               ,G.DB_TBL_SPAC_PNM AS BEFORE_IDX_SPAC_PNM
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_DDL_TSF_IDX A
               LEFT OUTER JOIN WAM_DDL_TSF_IDX B
                 ON A.DDL_IDX_PNM = B.DDL_IDX_PNM
                AND A.SRC_DB_SCH_ID = B.SRC_DB_SCH_ID
                AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID
			   LEFT OUTER JOIN WAA_DB_SCH D
                 ON B.SRC_DB_SCH_ID = D.DB_SCH_ID
                AND D.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                AND D.REG_TYP_CD IN ('C', 'U')
			   LEFT OUTER JOIN WAA_DB_SCH E
                 ON B.TGT_DB_SCH_ID = E.DB_SCH_ID
                AND E.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                AND E.REG_TYP_CD IN ('C', 'U')
               LEFT OUTER JOIN WAA_TBL_SPAC G
                 ON B.IDX_SPAC_ID = G.DB_TBL_SPAC_ID
                AND G.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                AND G.REG_TYP_CD IN ('C', 'U')
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_6) B
       )A
  </select>
  <select id="selectMsgChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN '메시지코드'
                WHEN NO = 2 THEN '메시지내용'
                WHEN NO = 3 THEN '유형구분코드'
                WHEN NO = 4 THEN '업무구분코드'
                WHEN NO = 5 THEN '사용여부'
                WHEN NO = 6 THEN '설명' 
                END AS ITEM_NM
               ,CASE WHEN NO = 1 THEN BEFORE_MSG_CD 
                WHEN NO = 2 THEN BEFORE_MSG_CONTS
                WHEN NO = 3 THEN BEFORE_TYP_DIV_CD
                WHEN NO = 4 THEN BEFORE_BIZ_DIV_CD
                WHEN NO = 5 THEN BEFORE_USE_YN
                WHEN NO = 6 THEN BEFORE_OBJ_DESCN
               END AS BEFORE_DATA
               ,CASE WHEN NO = 1 THEN AFTER_MSG_CD 
                WHEN NO = 2 THEN AFTER_MSG_CONTS
                WHEN NO = 3 THEN AFTER_TYP_DIV_CD
                WHEN NO = 4 THEN AFTER_BIZ_DIV_CD
                WHEN NO = 5 THEN AFTER_USE_YN
                WHEN NO = 6 THEN AFTER_OBJ_DESCN
               END AS AFTER_DATA
        FROM 
            (SELECT
                   A.RQST_NO
                  ,A.RQST_SNO
                  ,B.MSG_CD BEFORE_MSG_CD
                  ,A.MSG_CD AFTER_MSG_CD
                  ,B.MSG_CONTS AS BEFORE_MSG_CONTS
                  ,A.MSG_CONTS AS AFTER_MSG_CONTS
                  ,B.TYP_DIV_CD BEFORE_TYP_DIV_CD
                  ,A.TYP_DIV_CD AFTER_TYP_DIV_CD
                  ,B.BIZ_DIV_CD BEFORE_BIZ_DIV_CD
                  ,A.BIZ_DIV_CD AFTER_BIZ_DIV_CD
                  ,B.USE_YN BEFORE_USE_YN
                  ,A.USE_YN AFTER_USE_YN
                  ,B.OBJ_DESCN BEFORE_OBJ_DESCN
                  ,A.OBJ_DESCN AFTER_OBJ_DESCN
            FROM WAQ_MSG A
            INNER JOIN WAM_MSG B
            ON A.MSG_CD = B.MSG_CD
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,
           (SELECT SEQ AS NO FROM seq_1_to_6) B
       )A
    

  </select>
   <select id="selectCdValChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN '코드값'
                WHEN NO = 2 THEN '코드값명'
                WHEN NO = 3 THEN '표시순서'
                WHEN NO = 4 THEN '사용여부' 
                WHEN NO = 5 THEN '비고' 
                END AS ITEM_NM
               ,CASE WHEN NO = 1  THEN BEFORE_CD_VAL 
                     WHEN NO = 2  THEN BEFORE_CD_VAL_NM  
                     WHEN NO = 3  THEN BEFORE_DISP_ORD 
                     WHEN NO = 4  THEN BEFORE_USE_YN
                     WHEN NO = 5 THEN BEFORE_OBJ_DESCN 
               END AS BEFORE_DATA
               ,CASE WHEN NO = 1  THEN AFTER_CD_VAL 
                     WHEN NO = 2  THEN AFTER_CD_VAL_NM  
                     WHEN NO = 3  THEN AFTER_DISP_ORD 
                     WHEN NO = 4  THEN AFTER_USE_YN
                     WHEN NO = 5 THEN AFTER_OBJ_DESCN 
               END AS AFTER_DATA
        FROM 
            (SELECT
                   A.RQST_NO
                  ,A.RQST_SNO
                  ,B.CD_VAL BEFORE_CD_VAL
                  ,A.CD_VAL AFTER_CD_VAL
                  ,B.CD_VAL_NM AS BEFORE_CD_VAL_NM
                  ,A.CD_VAL_NM AS AFTER_CD_VAL_NM
<!--                   ,GET_CD_VAL_NM(B.UPP_CD_VAL_ID) BEFORE_UPP_CD_VAL -->
<!--                   ,A.UPP_CD_VAL AFTER_UPP_CD_VAL -->
                  ,B.OBJ_DESCN BEFORE_OBJ_DESCN
                  ,A.OBJ_DESCN AFTER_OBJ_DESCN
<!--                   ,B.VV_NOTE1 BEFORE_VV_NOTE1 -->
<!--                   ,A.VV_NOTE1 AFTER_VV_NOTE1 -->
<!--                   ,B.VV_NOTE_NM1 BEFORE_VV_NOTE_NM1 -->
<!--                   ,A.VV_NOTE_NM1 AFTER_VV_NOTE_NM1 -->
<!--                   ,B.VV_NOTE2 BEFORE_VV_NOTE2 -->
<!--                   ,A.VV_NOTE2 AFTER_VV_NOTE2 -->
<!--                   ,B.VV_NOTE_NM2 BEFORE_VV_NOTE_NM2 -->
<!--                   ,A.VV_NOTE_NM2 AFTER_VV_NOTE_NM2 -->
<!--                   ,B.VV_NOTE3 BEFORE_VV_NOTE3 -->
<!--                   ,A.VV_NOTE3 AFTER_VV_NOTE3 -->
<!--                   ,B.VV_NOTE_NM3 BEFORE_VV_NOTE_NM3 -->
<!--                   ,A.VV_NOTE_NM3 AFTER_VV_NOTE_NM3 -->
<!--                   ,B.VV_NOTE4 BEFORE_VV_NOTE4 -->
<!--                   ,A.VV_NOTE4 AFTER_VV_NOTE4 -->
<!--                   ,B.VV_NOTE_NM4 BEFORE_VV_NOTE_NM4 -->
<!--                   ,A.VV_NOTE_NM4 AFTER_VV_NOTE_NM4 -->
<!--                   ,B.VV_NOTE5 BEFORE_VV_NOTE5 -->
<!--                   ,A.VV_NOTE5 AFTER_VV_NOTE5 -->
<!--                   ,B.VV_NOTE_NM5 BEFORE_VV_NOTE_NM5 -->
<!--                   ,A.VV_NOTE_NM5 AFTER_VV_NOTE_NM5 -->
<!--                   ,B.OUTL_CNTN1 BEFORE_OUTL_CNTN1 -->
<!--                   ,A.OUTL_CNTN1 AFTER_OUTL_CNTN1 -->
<!--                   ,B.OUTL_CNTN2 BEFORE_OUTL_CNTN2 -->
<!--                   ,A.OUTL_CNTN2 AFTER_OUTL_CNTN2 -->
                  ,B.USE_YN BEFORE_USE_YN
                  ,A.USE_YN AFTER_USE_YN
                  ,CONCAT(IFNULL(B.DISP_ORD,'')) BEFORE_DISP_ORD
                  ,CONCAT(IFNULL(A.DISP_ORD,'')) AFTER_DISP_ORD
            FROM WAQ_CD_VAL A
            INNER JOIN WAM_CD_VAL B
            ON A.CD_VAL_ID = B.CD_VAL_ID
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO =  #{rqstSno,jdbcType=DECIMAL}
            AND A.RQST_DTL_SNO = #{rqstDtlSno,jdbcType=DECIMAL}) A
           ,
           (SELECT SEQ AS NO FROM seq_1_to_5) B
             )A

  </select>
  
     <select id="selectCodeTsfChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN '코드값'
                WHEN NO = 2 THEN '코드값명'
                WHEN NO = 3 THEN '상위코드값'
                WHEN NO = 4 THEN '표시순서'
                WHEN NO = 5 THEN '사용여부' 
                WHEN NO = 6 THEN '기타1' 
                WHEN NO = 7 THEN '기타1명' 
                WHEN NO = 8 THEN '기타2' 
                WHEN NO = 9 THEN '기타2명' 
                WHEN NO = 10 THEN '기타3' 
                WHEN NO = 11 THEN '기타3명' 
                WHEN NO = 12 THEN '기타4' 
                WHEN NO = 13 THEN '기타5명' 
                WHEN NO = 14 THEN '기타5' 
                WHEN NO = 15 THEN '기타5명' 
                WHEN NO = 16 THEN '적요1' 
                WHEN NO = 17 THEN '적요2' 
                WHEN NO = 18 THEN '비고' 
                END AS ITEM_NM
               ,CASE WHEN NO = 1  THEN BEFORE_CD_VAL 
                     WHEN NO = 2  THEN BEFORE_CD_VAL_NM  
                     WHEN NO = 3  THEN BEFORE_UPP_CD_VAL 
                     WHEN NO = 4  THEN BEFORE_DISP_ORD 
                     WHEN NO = 5  THEN BEFORE_USE_YN
                     WHEN NO = 6  THEN BEFORE_VV_NOTE1 
                     WHEN NO = 7  THEN BEFORE_VV_NOTE_NM1 
                     WHEN NO = 8  THEN BEFORE_VV_NOTE2 
                     WHEN NO = 9  THEN BEFORE_VV_NOTE_NM2 
                     WHEN NO = 10 THEN BEFORE_VV_NOTE3 
                     WHEN NO = 11 THEN BEFORE_VV_NOTE_NM3 
                     WHEN NO = 12 THEN BEFORE_VV_NOTE4 
                     WHEN NO = 13 THEN BEFORE_VV_NOTE_NM4 
                     WHEN NO = 14 THEN BEFORE_VV_NOTE5
                     WHEN NO = 15 THEN BEFORE_VV_NOTE_NM5
                     WHEN NO = 16 THEN BEFORE_OUTL_CNTN1 
                     WHEN NO = 17 THEN BEFORE_OUTL_CNTN2
                     WHEN NO = 18 THEN BEFORE_OBJ_DESCN 
               END AS BEFORE_DATA
               ,CASE WHEN NO = 1  THEN AFTER_CD_VAL 
                     WHEN NO = 2  THEN AFTER_CD_VAL_NM  
                     WHEN NO = 3  THEN AFTER_UPP_CD_VAL 
                     WHEN NO = 4  THEN AFTER_DISP_ORD 
                     WHEN NO = 5  THEN AFTER_USE_YN
                     WHEN NO = 6  THEN AFTER_VV_NOTE1 
                     WHEN NO = 7  THEN AFTER_VV_NOTE_NM1 
                     WHEN NO = 8  THEN AFTER_VV_NOTE2 
                     WHEN NO = 9  THEN AFTER_VV_NOTE_NM2 
                     WHEN NO = 10 THEN AFTER_VV_NOTE3 
                     WHEN NO = 11 THEN AFTER_VV_NOTE_NM3 
                     WHEN NO = 12 THEN AFTER_VV_NOTE4 
                     WHEN NO = 13 THEN AFTER_VV_NOTE_NM4 
                     WHEN NO = 14 THEN AFTER_VV_NOTE5
                     WHEN NO = 15 THEN AFTER_VV_NOTE_NM5
                     WHEN NO = 16 THEN AFTER_OUTL_CNTN1 
                     WHEN NO = 17 THEN AFTER_OUTL_CNTN2
                     WHEN NO = 18 THEN AFTER_OBJ_DESCN 
               END AS AFTER_DATA
        FROM 
            (SELECT
                   A.RQST_NO
                  ,A.RQST_SNO
                  ,B.CD_VAL BEFORE_CD_VAL
                  ,A.CD_VAL AFTER_CD_VAL
                  ,B.CD_VAL_NM AS BEFORE_CD_VAL_NM
                  ,A.CD_VAL_NM AS AFTER_CD_VAL_NM
                  ,GET_CD_VAL_NM(B.UPP_CD_VAL_ID) BEFORE_UPP_CD_VAL
                  ,A.UPP_CD_VAL AFTER_UPP_CD_VAL
                  ,B.OBJ_DESCN BEFORE_OBJ_DESCN
                  ,A.OBJ_DESCN AFTER_OBJ_DESCN
                  ,B.VV_NOTE1 BEFORE_VV_NOTE1
                  ,A.VV_NOTE1 AFTER_VV_NOTE1
                  ,B.VV_NOTE_NM1 BEFORE_VV_NOTE_NM1
                  ,A.VV_NOTE_NM1 AFTER_VV_NOTE_NM1
                  ,B.VV_NOTE2 BEFORE_VV_NOTE2
                  ,A.VV_NOTE2 AFTER_VV_NOTE2
                  ,B.VV_NOTE_NM2 BEFORE_VV_NOTE_NM2
                  ,A.VV_NOTE_NM2 AFTER_VV_NOTE_NM2
                  ,B.VV_NOTE3 BEFORE_VV_NOTE3
                  ,A.VV_NOTE3 AFTER_VV_NOTE3
                  ,B.VV_NOTE_NM3 BEFORE_VV_NOTE_NM3
                  ,A.VV_NOTE_NM3 AFTER_VV_NOTE_NM3
                  ,B.VV_NOTE4 BEFORE_VV_NOTE4
                  ,A.VV_NOTE4 AFTER_VV_NOTE4
                  ,B.VV_NOTE_NM4 BEFORE_VV_NOTE_NM4
                  ,A.VV_NOTE_NM4 AFTER_VV_NOTE_NM4
                  ,B.VV_NOTE5 BEFORE_VV_NOTE5
                  ,A.VV_NOTE5 AFTER_VV_NOTE5
                  ,B.VV_NOTE_NM5 BEFORE_VV_NOTE_NM5
                  ,A.VV_NOTE_NM5 AFTER_VV_NOTE_NM5
                  ,B.OUTL_CNTN1 BEFORE_OUTL_CNTN1
                  ,A.OUTL_CNTN1 AFTER_OUTL_CNTN1
                  ,B.OUTL_CNTN2 BEFORE_OUTL_CNTN2
                  ,A.OUTL_CNTN2 AFTER_OUTL_CNTN2
                  ,B.USE_YN BEFORE_USE_YN
                  ,A.USE_YN AFTER_USE_YN
                  ,CONCAT(B.DISP_ORD) BEFORE_DISP_ORD
                  ,CONCAT(A.DISP_ORD) AFTER_DISP_ORD
            FROM WAQ_CD_VAL_TSF A
            INNER JOIN WAM_CD_VAL_TSF B
            ON A.CD_VAL_ID = B.CD_VAL_ID
            AND A.TGT_DB_CONN_TRG_ID = B.TGT_DB_CONN_TRG_ID
            AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO =  #{rqstSno,jdbcType=DECIMAL}
            ) A
        ,
           (SELECT SEQ AS NO FROM seq_1_to_18) B
       )A

  </select>

<select id="selectMsgTsfChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN '메시지코드'
                WHEN NO = 2 THEN '메시지내용'
                WHEN NO = 3 THEN '유형구분코드'
                WHEN NO = 4 THEN '업무구분코드'
                WHEN NO = 5 THEN '사용여부'
                WHEN NO = 6 THEN '설명'  
                END AS ITEM_NM
               ,CASE WHEN NO = 1 THEN BEFORE_MSG_CD 
                WHEN NO = 2 THEN BEFORE_MSG_CONTS
                WHEN NO = 3 THEN BEFORE_TYP_DIV_CD
                WHEN NO = 4 THEN BEFORE_BIZ_DIV_CD
                WHEN NO = 5 THEN BEFORE_USE_YN
                WHEN NO = 6 THEN BEFORE_OBJ_DESCN
               END AS BEFORE_DATA
               ,CASE WHEN NO = 1 THEN AFTER_MSG_CD 
                WHEN NO = 2 THEN AFTER_MSG_CONTS
                WHEN NO = 3 THEN AFTER_TYP_DIV_CD
                WHEN NO = 4 THEN AFTER_BIZ_DIV_CD
                WHEN NO = 5 THEN AFTER_USE_YN
                WHEN NO = 6 THEN AFTER_OBJ_DESCN
               END AS AFTER_DATA
        FROM 
            (SELECT
                   A.RQST_NO
                  ,A.RQST_SNO
                  ,B.MSG_CD BEFORE_MSG_CD
                  ,A.MSG_CD AFTER_MSG_CD
                  ,B.MSG_CONTS AS BEFORE_MSG_CONTS
                  ,A.MSG_CONTS AS AFTER_MSG_CONTS
                  ,B.TYP_DIV_CD BEFORE_TYP_DIV_CD
                  ,A.TYP_DIV_CD AFTER_TYP_DIV_CD
                  ,B.BIZ_DIV_CD BEFORE_BIZ_DIV_CD
                  ,A.BIZ_DIV_CD AFTER_BIZ_DIV_CD
                  ,B.USE_YN BEFORE_USE_YN
                  ,A.USE_YN AFTER_USE_YN
                  ,B.OBJ_DESCN BEFORE_OBJ_DESCN
                  ,A.OBJ_DESCN AFTER_OBJ_DESCN
            FROM WAQ_MSG_TSF A
            INNER JOIN WAM_MSG_TSF B
            ON A.MSG_ID = B.MSG_ID
            AND A.TGT_DB_CONN_TRG_ID = B.TGT_DB_CONN_TRG_ID
            AND A.TGT_DB_SCH_ID = B.TGT_DB_SCH_ID
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,
           (SELECT SEQ AS NO FROM seq_1_to_6) B
       )A
 </select>
 
   <select id="selectDdlColTsfChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,RQST_DTL_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,RQST_DTL_SNO
       ,(CASE WHEN B.NO = 1 THEN '컬럼논리명'
              WHEN B.NO = 2 THEN '컬럼물리명'
              WHEN B.NO = 3 THEN '컬럼순서'
              WHEN B.NO = 4 THEN '데이터타입'
              WHEN B.NO = 5 THEN '데이터길이'     
              WHEN B.NO = 6 THEN '데이터소수점길이'
              WHEN B.NO = 7 THEN 'PK여부'
              WHEN B.NO = 8 THEN 'PK순서'
              WHEN B.NO = 9 THEN 'NOTNULL여부'
              WHEN B.NO = 10 THEN 'DEFAULT값'
              WHEN B.NO = 11 THEN '설명'
              WHEN B.NO = 12 THEN '암호화여부'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_DDL_COL_LNM
              WHEN B.NO = 2 THEN AFTER_DDL_COL_PNM
              WHEN B.NO = 3 THEN CONCAT(AFTER_COL_ORD)
              WHEN B.NO = 4 THEN AFTER_DATA_TYPE
              WHEN B.NO = 5 THEN CONCAT(AFTER_DATA_LEN)
              WHEN B.NO = 6 THEN CONCAT(AFTER_DATA_SCAL)
              WHEN B.NO = 7 THEN AFTER_PK_YN
              WHEN B.NO = 8 THEN CONCAT(AFTER_PK_ORD)
              WHEN B.NO = 9 THEN AFTER_NONUL_YN
              WHEN B.NO = 10 THEN AFTER_DEFLT_VAL
              WHEN B.NO = 11 THEN AFTER_OBJ_DESCN
              WHEN B.NO = 12 THEN AFTER_ENC_YN
         ELSE NULL END) AS AFTER_DATA          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_DDL_COL_LNM
              WHEN B.NO = 2 THEN BEFORE_DDL_COL_PNM
              WHEN B.NO = 3 THEN CONCAT(BEFORE_COL_ORD)
              WHEN B.NO = 4 THEN BEFORE_DATA_TYPE
              WHEN B.NO = 5 THEN CONCAT(BEFORE_DATA_LEN)
              WHEN B.NO = 6 THEN CONCAT(BEFORE_DATA_SCAL)
              WHEN B.NO = 7 THEN BEFORE_PK_YN
              WHEN B.NO = 8 THEN CONCAT(BEFORE_PK_ORD)
              WHEN B.NO = 9 THEN BEFORE_NONUL_YN
              WHEN B.NO = 10 THEN BEFORE_DEFLT_VAL
              WHEN B.NO = 11 THEN BEFORE_OBJ_DESCN
              WHEN B.NO = 12 THEN BEFORE_ENC_YN
         ELSE NULL END) AS BEFORE_DATA  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.RQST_DTL_SNO
               ,A.DDL_COL_LNM AS AFTER_DDL_COL_LNM
               ,A.DDL_COL_PNM AS AFTER_DDL_COL_PNM
               ,A.COL_ORD AS AFTER_COL_ORD
               ,A.DATA_TYPE AS AFTER_DATA_TYPE
               ,A.DATA_LEN AS AFTER_DATA_LEN
               ,A.DATA_SCAL AS AFTER_DATA_SCAL
               ,CASE WHEN A.PK_YN = 'Y' THEN '예'
                ELSE CASE WHEN A.PK_YN = 'N' THEN '아니오'
                ELSE NULL END END AS AFTER_PK_YN
               ,A.PK_ORD AS AFTER_PK_ORD
               ,CASE WHEN A.NONUL_YN = 'Y' THEN '예'
                ELSE CASE WHEN A.NONUL_YN = 'N' THEN '아니오'
                ELSE NULL END END AS AFTER_NONUL_YN
               ,A.DEFLT_VAL AS AFTER_DEFLT_VAL
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.DDL_COL_LNM AS BEFORE_DDL_COL_LNM
               ,B.DDL_COL_PNM AS BEFORE_DDL_COL_PNM
               ,B.COL_ORD AS BEFORE_COL_ORD
               ,B.DATA_TYPE AS BEFORE_DATA_TYPE
               ,B.DATA_LEN AS BEFORE_DATA_LEN
               ,B.DATA_SCAL AS BEFORE_DATA_SCAL
               ,CASE WHEN B.PK_YN = 'Y' THEN '예'
                ELSE CASE WHEN B.PK_YN = 'N' THEN '아니오'
                ELSE NULL END END AS BEFORE_PK_YN
               ,B.PK_ORD AS BEFORE_PK_ORD
               ,CASE WHEN B.NONUL_YN = 'Y' THEN '예'
                ELSE CASE WHEN B.NONUL_YN = 'N' THEN '아니오'
                ELSE NULL END END AS BEFORE_NONUL_YN
               ,B.DEFLT_VAL AS BEFORE_DEFLT_VAL
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
               ,B.ENC_YN AS BEFORE_ENC_YN
               ,A.ENC_YN AS AFTER_ENC_YN
          FROM WAQ_DDL_TSF_COL A
               LEFT OUTER JOIN (SELECT A.*
		                                       ,B.DDL_TBL_PNM
		                                  FROM WAM_DDL_TSF_COL A
		                                       INNER JOIN WAM_DDL_TSF_TBL B
		                                          ON A.DDL_TBL_ID = B.DDL_TBL_ID
		                                         AND A.REG_TYP_CD IN ('C','U')
		                                         AND B.REG_TYP_CD IN ('C','U')
		                                WHERE B.DDL_TBL_PNM = #{searchObj,jdbcType=VARCHAR}  ) B
                 ON A.DDL_TBL_PNM = B.DDL_TBL_PNM
                AND A.DDL_COL_PNM = B.DDL_COL_PNM                                         
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
           AND A.RQST_DTL_SNO = #{rqstDtlSno,jdbcType=DECIMAL}
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_12) B
       )A
  </select>
    <select id="selectDdlIdxColTsfChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,RQST_DTL_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,RQST_DTL_SNO
       ,(CASE WHEN B.NO = 1 THEN '인덱스컬럼물리명'
              WHEN B.NO = 2 THEN '인덱스컬럼논리명'
              WHEN B.NO = 3 THEN '인덱스컬럼순서'
              WHEN B.NO = 4 THEN '정렬순서'
              WHEN B.NO = 5 THEN '설명'
         ELSE NULL END) AS ITEM_NM   
                
       ,(CASE WHEN B.NO = 1 THEN AFTER_DDL_IDX_COL_PNM
              WHEN B.NO = 2 THEN AFTER_DDL_IDX_COL_LNM
              WHEN B.NO = 3 THEN CONCAT(AFTER_DDL_IDX_COL_ORD)
              WHEN B.NO = 4 THEN AFTER_SORT_TYP
              WHEN B.NO = 5 THEN AFTER_OBJ_DESCN
         ELSE NULL END) AS AFTER_DATA          
         
       ,(CASE WHEN B.NO = 1 THEN BEFORE_DDL_IDX_COL_PNM
              WHEN B.NO = 2 THEN BEFORE_DDL_IDX_COL_LNM
              WHEN B.NO = 3 THEN CONCAT(BEFORE_DDL_IDX_COL_ORD)
              WHEN B.NO = 4 THEN BEFORE_SORT_TYP
              WHEN B.NO = 5 THEN BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE_DATA  
from   (SELECT A.RQST_NO
               ,A.RQST_SNO
               ,A.RQST_DTL_SNO
               ,A.DDL_IDX_COL_PNM AS AFTER_DDL_IDX_COL_PNM
               ,A.DDL_IDX_COL_LNM AS AFTER_DDL_IDX_COL_LNM
               ,A.DDL_IDX_COL_ORD AS AFTER_DDL_IDX_COL_ORD
               ,C.COMM_DTL_CD_NM AS AFTER_SORT_TYP
               ,A.OBJ_DESCN AS AFTER_OBJ_DESCN
               ,B.DDL_IDX_COL_PNM AS BEFORE_DDL_IDX_COL_PNM
               ,B.DDL_IDX_COL_LNM AS BEFORE_DDL_IDX_COL_LNM
               ,B.DDL_IDX_COL_ORD AS BEFORE_DDL_IDX_COL_ORD
               ,D.COMM_DTL_CD_NM AS BEFORE_SORT_TYP
               ,B.OBJ_DESCN AS BEFORE_OBJ_DESCN
          FROM WAQ_DDL_TSF_IDX_COL A
               LEFT OUTER JOIN WAM_DDL_TSF_IDX_COL B
                 ON A.DDL_IDX_COL_LNM = B.DDL_IDX_COL_LNM
                AND A.DDL_IDX_COL_PNM = B.DDL_IDX_COL_PNM
                AND A.DDL_IDX_ID = B.DDL_IDX_ID
			   LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'IDX_COL_SRT_ORD_CD'
                                ) C
                 ON A.SORT_TYP = C.COMM_DTL_CD  
               LEFT OUTER JOIN (SELECT B.COMM_DTL_CD, B.COMM_DTL_CD_NM
                                  FROM WAA_COMM_DCD A
                                       INNER JOIN WAA_COMM_DTL_CD B
                                          ON A.COMM_DCD_ID = B.COMM_DCD_ID
                                         AND B.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                         AND B.REG_TYP_CD IN ('C', 'U')
                                WHERE A.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                                  AND A.REG_TYP_CD IN ('C', 'U')
                                  AND A.COMM_DCD = 'IDX_COL_SRT_ORD_CD'
                                ) D
                 ON B.SORT_TYP = D.COMM_DTL_CD  
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
           AND A.RQST_DTL_SNO = #{rqstDtlSno,jdbcType=DECIMAL}
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_5) B
       )A
  </select> 
  <select id="selectMsgStdChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN '오류전문언어구분코드'
                WHEN NO = 2 THEN '오류유형코두'
                WHEN NO = 3 THEN '메시지구분'
                WHEN NO = 4 THEN '표준오류코드여부'
                WHEN NO = 5 THEN '조치코드'
                WHEN NO = 6 THEN '오류코드' 
                WHEN NO = 7 THEN '전산메시지오류원인내용' 
                WHEN NO = 8 THEN '고객메시지오류원인내용' 
                WHEN NO = 9 THEN '오류코드적용일자' 
                WHEN NO = 10 THEN 'AS-IS오류코드' 
                WHEN NO = 11 THEN '담당파트' 
                WHEN NO = 12 THEN '담당자' 
                END AS ITEM_NM
               ,CASE WHEN NO = 1 THEN BEFORE_ERR_TLG_LAN_DSCD 
                WHEN NO = 2 THEN BEFORE_ERR_TP_CD
                WHEN NO = 3 THEN BEFORE_MSG_DIT
                WHEN NO = 4 THEN BEFORE_STD_ERR_CD_YN
                WHEN NO = 5 THEN BEFORE_ACTN_CD
                WHEN NO = 6 THEN BEFORE_ERR_CD
                WHEN NO = 7 THEN BEFORE_ISD_ERR_CAS_CTS
                WHEN NO = 8 THEN BEFORE_OSD_ERR_CAS_CTS
                WHEN NO = 9 THEN BEFORE_ERR_CD_APL_DT
                WHEN NO = 10 THEN BEFORE_STSY_ERR_CD
                WHEN NO = 11 THEN BEFORE_TSK_DMN
                WHEN NO = 12 THEN BEFORE_MNG_USER
               END AS BEFORE_DATA
               ,CASE WHEN NO = 1 THEN AFTER_ERR_TLG_LAN_DSCD 
                WHEN NO = 2 THEN AFTER_ERR_TP_CD
                WHEN NO = 3 THEN AFTER_MSG_DIT
                WHEN NO = 4 THEN AFTER_STD_ERR_CD_YN
                WHEN NO = 5 THEN AFTER_ACTN_CD
                WHEN NO = 6 THEN AFTER_ERR_CD
                WHEN NO = 7 THEN AFTER_ISD_ERR_CAS_CTS
                WHEN NO = 8 THEN AFTER_OSD_ERR_CAS_CTS
                WHEN NO = 9 THEN AFTER_ERR_CD_APL_DT
                WHEN NO = 10 THEN AFTER_STSY_ERR_CD
                WHEN NO = 11 THEN AFTER_TSK_DMN
                WHEN NO = 12 THEN AFTER_MNG_USER
               END AS AFTER_DATA
        FROM 
            (SELECT
            		 A.RQST_NO
            		,A.RQST_SNO
            		,A.ERR_TLG_LAN_DSCD AS AFTER_ERR_TLG_LAN_DSCD
            		,A.ERR_TP_CD AS AFTER_ERR_TP_CD
            		,A.MSG_DIT AS AFTER_MSG_DIT        
            		,A.STD_ERR_CD_YN AS AFTER_STD_ERR_CD_YN  
            		,A.ACTN_CD AS AFTER_ACTN_CD        
            		,A.ERR_CD AS AFTER_ERR_CD         
            		,A.ISD_ERR_CAS_CTS AS AFTER_ISD_ERR_CAS_CTS
            		,A.OSD_ERR_CAS_CTS AS AFTER_OSD_ERR_CAS_CTS
            		,A.ERR_CD_APL_DT AS AFTER_ERR_CD_APL_DT  
            		,A.STSY_ERR_CD AS AFTER_STSY_ERR_CD    
            		,A.TSK_DMN AS AFTER_TSK_DMN        
            		,A.MNG_USER AS AFTER_MNG_USER       
            		,B.ERR_TLG_LAN_DSCD AS BEFORE_ERR_TLG_LAN_DSCD
            		,B.ERR_TP_CD AS BEFORE_ERR_TP_CD
            		,B.MSG_DIT AS BEFORE_MSG_DIT
            		,B.STD_ERR_CD_YN AS BEFORE_STD_ERR_CD_YN
            		,B.ACTN_CD AS BEFORE_ACTN_CD
            		,B.ERR_CD AS BEFORE_ERR_CD
            		,B.ISD_ERR_CAS_CTS AS BEFORE_ISD_ERR_CAS_CTS
            		,B.OSD_ERR_CAS_CTS AS BEFORE_OSD_ERR_CAS_CTS
            		,B.ERR_CD_APL_DT AS BEFORE_ERR_CD_APL_DT
            		,B.STSY_ERR_CD AS BEFORE_STSY_ERR_CD
            		,B.TSK_DMN AS BEFORE_TSK_DMN
            		,B.MNG_USER AS BEFORE_MNG_USER
            FROM WAQ_STD_ERR_MSG A
            INNER JOIN WAM_STD_ERR_MSG B
            ON CASE WHEN A.STD_ERR_MSG_ID IS NULL THEN A.ERR_CD  ELSE A.STD_ERR_MSG_ID  END = CASE WHEN A.STD_ERR_MSG_ID IS NULL THEN B.ERR_CD  ELSE B.STD_ERR_MSG_ID  END 
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,
           (SELECT SEQ AS NO FROM seq_1_to_12) B
       )A
    

  </select>
  <select id="selectMsgChnlChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN '오류코드'
                WHEN NO = 2 THEN '오류전문언어구분코드'
                WHEN NO = 3 THEN '오류유형코드'
                WHEN NO = 4 THEN '채널오류코드'
                WHEN NO = 5 THEN '오류코드사용여부'
                WHEN NO = 6 THEN '채널오류코드' 
                WHEN NO = 7 THEN '채널오류메시지내용' 
                WHEN NO = 8 THEN '오류코드적용일자' 
                WHEN NO = 9 THEN '조치코드' 
                WHEN NO = 10 THEN '채널유형코드' 
                WHEN NO = 11 THEN '채널세부코드' 
                END AS ITEM_NM
               ,CASE WHEN NO = 1 THEN BEFORE_ERR_CD 
                WHEN NO = 2 THEN BEFORE_ERR_TLG_LAN_DSCD
                WHEN NO = 3 THEN BEFORE_ERR_TP_CD
                WHEN NO = 4 THEN BEFORE_CHNL_TP_CD
                WHEN NO = 5 THEN BEFORE_ERR_CD_US_YN
                WHEN NO = 6 THEN BEFORE_CHNL_ERR_CD
                WHEN NO = 7 THEN BEFORE_CHNL_ERR_MSG_CTS
                WHEN NO = 8 THEN BEFORE_ERR_CD_APL_DT
                WHEN NO = 9 THEN BEFORE_ACTN_CD
                WHEN NO = 10 THEN BEFORE_CHNL_DTLS_CLCD
                WHEN NO = 11 THEN BEFORE_CHNL_GRP_CD
               END AS BEFORE_DATA
              ,CASE WHEN NO = 1 THEN AFTER_ERR_CD 
                WHEN NO = 2 THEN AFTER_ERR_TLG_LAN_DSCD
                WHEN NO = 3 THEN AFTER_ERR_TP_CD
                WHEN NO = 4 THEN AFTER_CHNL_TP_CD
                WHEN NO = 5 THEN AFTER_ERR_CD_US_YN
                WHEN NO = 6 THEN AFTER_CHNL_ERR_CD
                WHEN NO = 7 THEN AFTER_CHNL_ERR_MSG_CTS
                WHEN NO = 8 THEN AFTER_ERR_CD_APL_DT
                WHEN NO = 9 THEN AFTER_ACTN_CD
                WHEN NO = 10 THEN AFTER_CHNL_DTLS_CLCD
                WHEN NO = 11 THEN AFTER_CHNL_GRP_CD
               END AS AFTER_DATA
        FROM 
            (SELECT
               A.RQST_NO
              ,A.RQST_SNO
              ,A.ERR_CD AS AFTER_ERR_CD
              ,A.ERR_TLG_LAN_DSCD AS AFTER_ERR_TLG_LAN_DSCD
              ,A.ERR_TP_CD AS AFTER_ERR_TP_CD
              ,A.CHNL_TP_CD AS AFTER_CHNL_TP_CD
              ,A.ERR_CD_US_YN AS AFTER_ERR_CD_US_YN
              ,A.CHNL_ERR_CD AS AFTER_CHNL_ERR_CD
              ,A.CHNL_ERR_MSG_CTS AS AFTER_CHNL_ERR_MSG_CTS
              ,A.ERR_CD_APL_DT AS AFTER_ERR_CD_APL_DT
              ,A.ACTN_CD AS AFTER_ACTN_CD
              ,A.CHNL_DTLS_CLCD AS AFTER_CHNL_DTLS_CLCD
              ,A.CHNL_GRP_CD AS AFTER_CHNL_GRP_CD
              ,B.ERR_CD AS BEFORE_ERR_CD
              ,B.ERR_TLG_LAN_DSCD AS BEFORE_ERR_TLG_LAN_DSCD
              ,B.ERR_TP_CD AS BEFORE_ERR_TP_CD
              ,B.CHNL_TP_CD AS BEFORE_CHNL_TP_CD
              ,B.ERR_CD_US_YN AS BEFORE_ERR_CD_US_YN
              ,B.CHNL_ERR_CD AS BEFORE_CHNL_ERR_CD
              ,B.CHNL_ERR_MSG_CTS AS BEFORE_CHNL_ERR_MSG_CTS
              ,B.ERR_CD_APL_DT AS BEFORE_ERR_CD_APL_DT
              ,B.ACTN_CD AS BEFORE_ACTN_CD
              ,B.CHNL_DTLS_CLCD AS BEFORE_CHNL_DTLS_CLCD
              ,B.CHNL_GRP_CD AS BEFORE_CHNL_GRP_CD
            FROM WAQ_CHNL_ERR_MSG A
            INNER JOIN WAM_CHNL_ERR_MSG B
			ON CASE WHEN A.CHNL_MSG_ID IS NULL THEN A.ERR_CD  ELSE A.CHNL_MSG_ID  END = CASE WHEN A.CHNL_MSG_ID IS NULL THEN B.ERR_CD  ELSE B.CHNL_MSG_ID  END 
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,
           (SELECT SEQ AS NO FROM seq_1_to_11) B
       )A

  </select>
  <select id="selectMsgMapChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN '오류코드코드'
                WHEN NO = 2 THEN '전산메세지오류원인내용'
                WHEN NO = 3 THEN '고객메세지오류원인내용'
                WHEN NO = 4 THEN '도메인ID'
                WHEN NO = 5 THEN '도메인명'
                WHEN NO = 6 THEN '도메인물리명' 
                WHEN NO = 7 THEN '유효값ID' 
                WHEN NO = 8 THEN '유효값(코드값)' 
                WHEN NO = 9 THEN '유효값(코드값)명' 
                WHEN NO = 10 THEN '기관사용불가여부' 
                WHEN NO = 11 THEN '대표오류코드여부' 
                END AS ITEM_NM
              ,CASE WHEN NO = 1 THEN BEFORE_ERR_CD 
                WHEN NO = 2 THEN BEFORE_ISD_ERR_CAS_CTS
                WHEN NO = 3 THEN BEFORE_OSD_ERR_CAS_CTS
                WHEN NO = 4 THEN BEFORE_DMN_ID
                WHEN NO = 5 THEN BEFORE_DMN_LNM
                WHEN NO = 6 THEN BEFORE_DMN_PNM
                WHEN NO = 7 THEN BEFORE_CD_VAL_ID
                WHEN NO = 8 THEN BEFORE_CD_VAL
                WHEN NO = 9 THEN BEFORE_CD_VAL_NM
                WHEN NO = 10 THEN BEFORE_ISTT_US_IMPO_YN
                WHEN NO = 11 THEN BEFORE_RPST_ERCD_YN
               END AS BEFORE_DATA
              ,CASE WHEN NO = 1 THEN AFTER_ERR_CD 
                WHEN NO = 2 THEN AFTER_ISD_ERR_CAS_CTS
                WHEN NO = 3 THEN AFTER_OSD_ERR_CAS_CTS
                WHEN NO = 4 THEN AFTER_DMN_ID
                WHEN NO = 5 THEN AFTER_DMN_LNM
                WHEN NO = 6 THEN AFTER_DMN_PNM
                WHEN NO = 7 THEN AFTER_CD_VAL_ID
                WHEN NO = 8 THEN AFTER_CD_VAL
                WHEN NO = 9 THEN AFTER_CD_VAL_NM
                WHEN NO = 10 THEN AFTER_ISTT_US_IMPO_YN
                WHEN NO = 11 THEN AFTER_RPST_ERCD_YN
               END AS AFTER_DATA
        FROM 
            (SELECT
                A.RQST_NO
               ,A.RQST_SNO
               ,A.ERR_CD AS AFTER_ERR_CD
               ,A.ISD_ERR_CAS_CTS AS AFTER_ISD_ERR_CAS_CTS
               ,A.OSD_ERR_CAS_CTS AS AFTER_OSD_ERR_CAS_CTS
               ,A.DMN_ID AS AFTER_DMN_ID
               ,A.DMN_LNM AS AFTER_DMN_LNM
               ,A.DMN_PNM AS AFTER_DMN_PNM
               ,A.CD_VAL_ID AS AFTER_CD_VAL_ID
               ,A.CD_VAL AS AFTER_CD_VAL
               ,A.CD_VAL_NM AS AFTER_CD_VAL_NM
               ,A.ISTT_US_IMPO_YN AS AFTER_ISTT_US_IMPO_YN
               ,A.RPST_ERCD_YN AS AFTER_RPST_ERCD_YN
               ,B.ERR_CD AS BEFORE_ERR_CD
               ,B.ISD_ERR_CAS_CTS AS BEFORE_ISD_ERR_CAS_CTS
               ,B.OSD_ERR_CAS_CTS AS BEFORE_OSD_ERR_CAS_CTS
               ,B.DMN_ID AS BEFORE_DMN_ID
               ,B.DMN_LNM AS BEFORE_DMN_LNM
               ,B.DMN_PNM AS BEFORE_DMN_PNM
               ,B.CD_VAL_ID AS BEFORE_CD_VAL_ID
               ,B.CD_VAL AS BEFORE_CD_VAL
               ,B.CD_VAL_NM AS BEFORE_CD_VAL_NM
               ,B.ISTT_US_IMPO_YN AS BEFORE_ISTT_US_IMPO_YN
               ,B.RPST_ERCD_YN AS BEFORE_RPST_ERCD_YN
            FROM WAQ_ERR_MSG_MAP A
            INNER JOIN WAM_ERR_MSG_MAP B
			ON CASE WHEN A.MSG_MAP_ID IS NULL THEN A.ERR_CD  ELSE A.MSG_MAP_ID  END = CASE WHEN A.MSG_MAP_ID IS NULL THEN B.ERR_CD  ELSE B.MSG_MAP_ID  END
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,
           (SELECT SEQ AS NO FROM seq_1_to_11) B
       )A
  </select>
  <select id="selectMsgCodeChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN '조치코드'
                WHEN NO = 2 THEN '언어구분코드'
                WHEN NO = 3 THEN '조치내용'
                WHEN NO = 4 THEN '조치코드사용여부'
                WHEN NO = 5 THEN '조치코드삭제여부'
                WHEN NO = 6 THEN '조치코드적용일자' 
<!--                 WHEN NO = 7 THEN '채널메시지코드'  -->
<!--                 WHEN NO = 8 THEN '채널유형코드'  -->
<!--                 WHEN NO = 9 THEN 'MCI링크여부'  -->
<!--                 WHEN NO = 10 THEN 'MCI링크일자'  -->
                END AS ITEM_NM
              ,CASE WHEN NO = 1 THEN BEFORE_ACTN_CD 
                WHEN NO = 2 THEN BEFORE_ERR_TLG_LAN_DSCD
                WHEN NO = 3 THEN BEFORE_ACTN_MSG_CTNT
                WHEN NO = 4 THEN BEFORE_ACTN_USE_YN
                WHEN NO = 5 THEN BEFORE_ACTN_DEL_YN
                WHEN NO = 6 THEN BEFORE_ACTN_CD_APL_DT
<!--                 WHEN NO = 7 THEN BEFORE_CHNL_MSG_CD -->
<!--                 WHEN NO = 8 THEN BEFORE_CHNL_TYP_CD -->
<!--                 WHEN NO = 9 THEN BEFORE_MCI_LNK_YN -->
<!--                 WHEN NO = 10 THEN BEFORE_MCI_LNK_DT -->
               END AS BEFORE_DATA
              ,CASE WHEN NO = 1 THEN AFTER_ACTN_CD 
                WHEN NO = 2 THEN AFTER_ERR_TLG_LAN_DSCD
                WHEN NO = 3 THEN AFTER_ACTN_MSG_CTNT
                WHEN NO = 4 THEN AFTER_ACTN_USE_YN
                WHEN NO = 5 THEN AFTER_ACTN_DEL_YN
                WHEN NO = 6 THEN AFTER_ACTN_CD_APL_DT
<!--                 WHEN NO = 7 THEN AFTER_CHNL_MSG_CD -->
<!--                 WHEN NO = 8 THEN AFTER_CHNL_TYP_CD -->
<!--                 WHEN NO = 9 THEN AFTER_MCI_LNK_YN -->
<!--                 WHEN NO = 10 THEN AFTER_MCI_LNK_DT -->
               END AS AFTER_DATA
        FROM 
            (SELECT
                A.RQST_NO
               ,A.RQST_SNO
               ,A.ACTN_CD AS AFTER_ACTN_CD 
			   ,A.ERR_TLG_LAN_DSCD AS AFTER_ERR_TLG_LAN_DSCD
			   ,A.ACTN_MSG_CTNT AS AFTER_ACTN_MSG_CTNT
			   ,A.ACTN_USE_YN AS AFTER_ACTN_USE_YN
			   ,A.ACTN_DEL_YN AS AFTER_ACTN_DEL_YN
			   ,A.ACTN_CD_APL_DT AS AFTER_ACTN_CD_APL_DT
			   ,A.CHNL_MSG_CD AS AFTER_CHNL_MSG_CD
			   ,A.CHNL_TYP_CD AS AFTER_CHNL_TYP_CD
			   ,A.MCI_LNK_YN AS AFTER_MCI_LNK_YN
			   ,A.MCI_LNK_DT AS AFTER_MCI_LNK_DT
               ,B.ACTN_CD AS BEFORE_ACTN_CD 
			   ,B.ERR_TLG_LAN_DSCD AS BEFORE_ERR_TLG_LAN_DSCD
			   ,B.ACTN_MSG_CTNT AS BEFORE_ACTN_MSG_CTNT
			   ,B.ACTN_USE_YN AS BEFORE_ACTN_USE_YN
			   ,B.ACTN_DEL_YN AS BEFORE_ACTN_DEL_YN
			   ,B.ACTN_CD_APL_DT AS BEFORE_ACTN_CD_APL_DT
			   ,B.CHNL_MSG_CD AS BEFORE_CHNL_MSG_CD
			   ,B.CHNL_TYP_CD AS BEFORE_CHNL_TYP_CD
			   ,B.MCI_LNK_YN AS BEFORE_MCI_LNK_YN
			   ,B.MCI_LNK_DT AS BEFORE_MCI_LNK_DT
            FROM WAQ_ACTN_MSG A
            INNER JOIN WAM_ACTN_MSG B
            ON CASE WHEN A.ACTN_MSG_ID IS NULL THEN A.ACTN_CD  ELSE A.ACTN_MSG_ID  END = CASE WHEN A.ACTN_MSG_ID IS NULL THEN B.ACTN_CD  ELSE B.ACTN_MSG_ID  END
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,
           (SELECT SEQ AS NO FROM seq_1_to_6) B
       )A
  </select>
  <select id="selectAsisDmnCdValChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN '도메인논리명'
                WHEN NO = 2 THEN '도메인물리명'
                WHEN NO = 3 THEN '시스템구분'
                WHEN NO = 4 THEN '시스템명'
                WHEN NO = 5 THEN '시스템그룹명'
                WHEN NO = 6 THEN 'ASIS DB명' 
                WHEN NO = 7 THEN '테이블명' 
                WHEN NO = 8 THEN '컬럼ID' 
                WHEN NO = 9 THEN '컬럼명' 
                WHEN NO = 10 THEN '코드명' 
                WHEN NO = 11 THEN '참조컬럼명' 
                WHEN NO = 12 THEN '참조컬럼값' 
                WHEN NO = 13 THEN '코드값' 
                WHEN NO = 14 THEN '표시순서' 
                WHEN NO = 15 THEN '응용팀' 
                WHEN NO = 16 THEN 'KB담당자' 
                WHEN NO = 17 THEN '전환팀' 
                WHEN NO = 18 THEN '전환담당자' 
                WHEN NO = 19 THEN '최종수정일자' 
                WHEN NO = 20 THEN '비고1' 
                WHEN NO = 21 THEN '비고2' 
                WHEN NO = 22 THEN '비고3' 
                WHEN NO = 23 THEN '비고4' 
                WHEN NO = 24 THEN 'SI담당자' 
<!--                 WHEN NO = 25 THEN '파트명'  -->
<!--                 WHEN NO = 26 THEN '업무명'  -->
<!--                 WHEN NO = 27 THEN '업무코드'  -->
                END AS ITEM_NM
              ,CASE WHEN NO = 1 THEN BEFORE_DMN_LNM 
                WHEN NO = 2 THEN BEFORE_DMN_PNM
                WHEN NO = 3 THEN BEFORE_ASIS_DIT
                WHEN NO = 4 THEN BEFORE_ASIS_SYSTEM_NM
                WHEN NO = 5 THEN BEFORE_ASIS_GROUP_NM
                WHEN NO = 6 THEN BEFORE_ASIS_PART_NM 
                WHEN NO = 7 THEN BEFORE_ASIS_BIZ_NM  
                WHEN NO = 8 THEN BEFORE_ASIS_BIZ_CD  
                WHEN NO = 9 THEN BEFORE_ASIS_DB_NM   
                WHEN NO = 10 THEN BEFORE_ASIS_TBL_NM  
                WHEN NO = 11 THEN BEFORE_ASIS_COL_ID  
                WHEN NO = 12 THEN BEFORE_ASIS_COL_NM  
                WHEN NO = 13 THEN BEFORE_CODE_NM      
                WHEN NO = 14 THEN BEFORE_DFD_COL_NM   
                WHEN NO = 15 THEN BEFORE_DFD_COL_VALUE
                WHEN NO = 16 THEN BEFORE_CODE_VALUE   
                WHEN NO = 17 THEN BEFORE_CODE_DISP_NUM
                WHEN NO = 18 THEN BEFORE_APP_TEAM_NM  
                WHEN NO = 19 THEN BEFORE_APP_CHRG_NM  
                WHEN NO = 20 THEN BEFORE_TSF_TEAM_NM  
                WHEN NO = 21 THEN BEFORE_TSF_CHRG_NM  
                WHEN NO = 22 THEN BEFORE_LAST_CHG_DT  
                WHEN NO = 23 THEN BEFORE_ADD_NOTE1    
                WHEN NO = 24 THEN BEFORE_ADD_NOTE2    
                WHEN NO = 25 THEN BEFORE_ADD_NOTE3    
                WHEN NO = 26 THEN BEFORE_ADD_NOTE4    
                WHEN NO = 27 THEN BEFORE_APP_SI_NM
               END AS BEFORE_DATA
              ,CASE WHEN NO = 1 THEN AFTER_DMN_LNM 
                WHEN NO = 2 THEN AFTER_DMN_PNM
                WHEN NO = 3 THEN AFTER_ASIS_DIT
                WHEN NO = 4 THEN AFTER_ASIS_SYSTEM_NM
                WHEN NO = 5 THEN AFTER_ASIS_GROUP_NM
                WHEN NO = 6 THEN AFTER_ASIS_PART_NM 
                WHEN NO = 7 THEN AFTER_ASIS_BIZ_NM  
                WHEN NO = 8 THEN AFTER_ASIS_BIZ_CD  
                WHEN NO = 9 THEN AFTER_ASIS_DB_NM   
                WHEN NO = 10 THEN AFTER_ASIS_TBL_NM  
                WHEN NO = 11 THEN AFTER_ASIS_COL_ID  
                WHEN NO = 12 THEN AFTER_ASIS_COL_NM  
                WHEN NO = 13 THEN AFTER_CODE_NM      
                WHEN NO = 14 THEN AFTER_DFD_COL_NM   
                WHEN NO = 15 THEN AFTER_DFD_COL_VALUE
                WHEN NO = 16 THEN AFTER_CODE_VALUE   
                WHEN NO = 17 THEN AFTER_CODE_DISP_NUM
                WHEN NO = 18 THEN AFTER_APP_TEAM_NM  
                WHEN NO = 19 THEN AFTER_APP_CHRG_NM  
                WHEN NO = 20 THEN AFTER_TSF_TEAM_NM  
                WHEN NO = 21 THEN AFTER_TSF_CHRG_NM  
                WHEN NO = 22 THEN AFTER_LAST_CHG_DT  
                WHEN NO = 23 THEN AFTER_ADD_NOTE1    
                WHEN NO = 24 THEN AFTER_ADD_NOTE2    
                WHEN NO = 25 THEN AFTER_ADD_NOTE3    
                WHEN NO = 26 THEN AFTER_ADD_NOTE4    
                WHEN NO = 27 THEN AFTER_APP_SI_NM    
               END AS AFTER_DATA
        FROM 
            (SELECT
                A.RQST_NO
               ,A.RQST_SNO
               ,A.DMN_LNM        AS AFTER_DMN_LNM         
               ,A.DMN_PNM        AS AFTER_DMN_PNM         
               ,A.ASIS_DIT       AS AFTER_ASIS_DIT        
               ,A.ASIS_SYSTEM_NM AS AFTER_ASIS_SYSTEM_NM  
               ,A.ASIS_GROUP_NM  AS AFTER_ASIS_GROUP_NM   
               ,A.ASIS_PART_NM   AS AFTER_ASIS_PART_NM    
               ,A.ASIS_BIZ_NM    AS AFTER_ASIS_BIZ_NM     
               ,A.ASIS_BIZ_CD    AS AFTER_ASIS_BIZ_CD     
               ,A.ASIS_DB_NM     AS AFTER_ASIS_DB_NM      
               ,A.ASIS_TBL_NM    AS AFTER_ASIS_TBL_NM     
               ,A.ASIS_COL_ID    AS AFTER_ASIS_COL_ID     
               ,A.ASIS_COL_NM    AS AFTER_ASIS_COL_NM     
               ,A.CODE_NM        AS AFTER_CODE_NM         
               ,A.DFD_COL_NM     AS AFTER_DFD_COL_NM      
               ,A.DFD_COL_VALUE  AS AFTER_DFD_COL_VALUE   
               ,A.CODE_VALUE     AS AFTER_CODE_VALUE      
               ,A.CODE_DISP_NUM  AS AFTER_CODE_DISP_NUM   
               ,A.APP_TEAM_NM    AS AFTER_APP_TEAM_NM     
               ,A.APP_CHRG_NM    AS AFTER_APP_CHRG_NM     
               ,A.TSF_TEAM_NM    AS AFTER_TSF_TEAM_NM     
               ,A.TSF_CHRG_NM    AS AFTER_TSF_CHRG_NM     
               ,A.LAST_CHG_DT    AS AFTER_LAST_CHG_DT     
               ,A.ADD_NOTE1      AS AFTER_ADD_NOTE1       
               ,A.ADD_NOTE2      AS AFTER_ADD_NOTE2       
               ,A.ADD_NOTE3      AS AFTER_ADD_NOTE3       
               ,A.ADD_NOTE4      AS AFTER_ADD_NOTE4       
               ,A.APP_SI_NM      AS AFTER_APP_SI_NM      
               ,B.DMN_LNM        AS BEFORE_DMN_LNM       
               ,B.DMN_PNM        AS BEFORE_DMN_PNM       
               ,B.ASIS_DIT       AS BEFORE_ASIS_DIT      
               ,B.ASIS_SYSTEM_NM AS BEFORE_ASIS_SYSTEM_NM
               ,B.ASIS_GROUP_NM  AS BEFORE_ASIS_GROUP_NM 
               ,B.ASIS_PART_NM   AS BEFORE_ASIS_PART_NM  
               ,B.ASIS_BIZ_NM    AS BEFORE_ASIS_BIZ_NM   
               ,B.ASIS_BIZ_CD    AS BEFORE_ASIS_BIZ_CD   
               ,B.ASIS_DB_NM     AS BEFORE_ASIS_DB_NM    
               ,B.ASIS_TBL_NM    AS BEFORE_ASIS_TBL_NM   
               ,B.ASIS_COL_ID    AS BEFORE_ASIS_COL_ID   
               ,B.ASIS_COL_NM    AS BEFORE_ASIS_COL_NM   
               ,B.CODE_NM        AS BEFORE_CODE_NM       
               ,B.DFD_COL_NM     AS BEFORE_DFD_COL_NM    
               ,B.DFD_COL_VALUE  AS BEFORE_DFD_COL_VALUE 
               ,B.CODE_VALUE     AS BEFORE_CODE_VALUE    
               ,B.CODE_DISP_NUM  AS BEFORE_CODE_DISP_NUM 
               ,B.APP_TEAM_NM    AS BEFORE_APP_TEAM_NM   
               ,B.APP_CHRG_NM    AS BEFORE_APP_CHRG_NM   
               ,B.TSF_TEAM_NM    AS BEFORE_TSF_TEAM_NM   
               ,B.TSF_CHRG_NM    AS BEFORE_TSF_CHRG_NM   
               ,B.LAST_CHG_DT    AS BEFORE_LAST_CHG_DT   
               ,B.ADD_NOTE1      AS BEFORE_ADD_NOTE1     
               ,B.ADD_NOTE2      AS BEFORE_ADD_NOTE2     
               ,B.ADD_NOTE3      AS BEFORE_ADD_NOTE3     
               ,B.ADD_NOTE4      AS BEFORE_ADD_NOTE4     
               ,B.APP_SI_NM      AS BEFORE_APP_SI_NM     
            FROM WAQ_ASIS_DMN_CD_VAL A
            INNER JOIN WAM_ASIS_DMN_CD_VAL B
            ON A.DMN_ID = B.DMN_ID
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,
           (SELECT SEQ AS NO FROM seq_1_to_24) B
       )A
  </select>
  <select id="selectAppStwdChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN 'APP단어논리명'
                WHEN NO = 2 THEN 'APP단어물리명'
                WHEN NO = 3 THEN '영문의미'
                WHEN NO = 4 THEN '출처구분'
                WHEN NO = 5 THEN '단어구분'
                WHEN NO = 6 THEN '설명'
                
                END AS ITEM_NM
              ,CASE WHEN NO = 1 THEN BEFORE_APP_STWD_LNM 
                WHEN NO = 2 THEN BEFORE_APP_STWD_PNM
                WHEN NO = 3 THEN BEFORE_ENG_MEAN
                WHEN NO = 4 THEN BEFORE_ORG_DS
                WHEN NO = 5 THEN BEFORE_WD_DCD
                WHEN NO = 6 THEN BEFORE_OBJ_DESCN
                
               END AS BEFORE_DATA
              ,CASE WHEN NO = 1 THEN AFTER_APP_STWD_LNM 
                WHEN NO = 2 THEN AFTER_APP_STWD_PNM
                WHEN NO = 3 THEN AFTER_ENG_MEAN
                WHEN NO = 4 THEN AFTER_ORG_DS
                WHEN NO = 5 THEN AFTER_WD_DCD
                WHEN NO = 6 THEN AFTER_OBJ_DESCN
                
               END AS AFTER_DATA
        FROM 
            (SELECT
                A.RQST_NO
               ,A.RQST_SNO
               ,A.APP_STWD_LNM   AS AFTER_APP_STWD_LNM         
               ,A.APP_STWD_PNM   AS AFTER_APP_STWD_PNM         
               ,A.ENG_MEAN       AS AFTER_ENG_MEAN        
               ,A.ORG_DS 		 AS AFTER_ORG_DS  
               ,A.WD_DCD  		 AS AFTER_WD_DCD
               ,A.OBJ_DESCN  	 AS AFTER_OBJ_DESCN  
               ,B.APP_STWD_LNM   AS BEFORE_APP_STWD_LNM         
               ,B.APP_STWD_PNM   AS BEFORE_APP_STWD_PNM         
               ,B.ENG_MEAN       AS BEFORE_ENG_MEAN        
               ,B.ORG_DS 		 AS BEFORE_ORG_DS  
               ,B.WD_DCD  		 AS BEFORE_WD_DCD  
               ,B.OBJ_DESCN  	 AS BEFORE_OBJ_DESCN   
            FROM WAQ_APP_STWD A
            INNER JOIN WAM_APP_STWD B
            ON A.APP_STWD_ID = B.APP_STWD_ID
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,
           (SELECT SEQ AS NO FROM seq_1_to_6) B
       )A
  </select>
  <select id="selectAppSditmChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
          <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN 'APP용어논리명'
                WHEN NO = 2 THEN 'APP용어물리명'
                WHEN NO = 3 THEN '논리명기준구분'
                WHEN NO = 4 THEN '물리명기준구분'
                WHEN NO = 5 THEN '설명'
   
                END AS ITEM_NM
              ,CASE WHEN NO = 1 THEN BEFORE_APP_SDITM_LNM 
                WHEN NO = 2 THEN BEFORE_APP_SDITM_PNM
                WHEN NO = 3 THEN BEFORE_LNM_CRI_DS
                WHEN NO = 4 THEN BEFORE_PNM_CRI_DS
                WHEN NO = 5 THEN BEFORE_OBJ_DESCN
 
               END AS BEFORE_DATA
              ,CASE WHEN NO = 1 THEN AFTER_APP_SDITM_LNM 
                WHEN NO = 2 THEN AFTER_APP_SDITM_PNM
                WHEN NO = 3 THEN AFTER_LNM_CRI_DS
                WHEN NO = 4 THEN AFTER_PNM_CRI_DS
                WHEN NO = 5 THEN AFTER_OBJ_DESCN
          
               END AS AFTER_DATA
        FROM 
            (SELECT
                A.RQST_NO
               ,A.RQST_SNO
               ,A.APP_SDITM_LNM     AS AFTER_APP_SDITM_LNM         
               ,A.APP_SDITM_PNM    	AS AFTER_APP_SDITM_PNM         
               ,A.LNM_CRI_DS      	AS AFTER_LNM_CRI_DS        
               ,A.PNM_CRI_DS 		AS AFTER_PNM_CRI_DS  
               ,A.OBJ_DESCN  		AS AFTER_OBJ_DESCN   
               ,B.APP_SDITM_LNM     AS BEFORE_APP_SDITM_LNM         
               ,B.APP_SDITM_PNM    	AS BEFORE_APP_SDITM_PNM         
               ,B.LNM_CRI_DS      	AS BEFORE_LNM_CRI_DS        
               ,B.PNM_CRI_DS 		AS BEFORE_PNM_CRI_DS  
               ,B.OBJ_DESCN  		AS BEFORE_OBJ_DESCN   
            FROM WAQ_APP_SDITM A
            INNER JOIN WAM_APP_SDITM B
            ON A.APP_SDITM_ID = B.APP_SDITM_ID
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,
           (SELECT SEQ AS NO FROM seq_1_to_5) B
       )A
  </select>
  
  
   <select id="selectDdlSeqChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
  -- DDL 시퀀스 변경전후 비교
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 select RQST_NO
       ,RQST_SNO
       ,(CASE 
       		  WHEN B.NO = 1 THEN '시퀀스물리명'
              WHEN B.NO = 2 THEN '접속대상명'
              WHEN B.NO = 3 THEN 'DB스키마(물리명)'
              WHEN B.NO = 4 THEN 'INCREMENT BY'
              WHEN B.NO = 5 THEN 'START WITH'
              WHEN B.NO = 6 THEN 'MIN VALUE'
              WHEN B.NO = 7 THEN 'MAX VALUE'
              WHEN B.NO = 8 THEN 'CYCLE여부'
              WHEN B.NO = 9 THEN 'ORDER여부'
              WHEN B.NO = 10 THEN 'CACHE SIZE'
              WHEN B.NO = 11 THEN '설명'  
         ELSE NULL END) AS ITEM_NM          
       ,(CASE 
       		  WHEN B.NO = 1 THEN     	AFTER_DDL_SEQ_PNM
              WHEN B.NO = 2 THEN 		AFTER_DB_CONN_TRG_PNM
              WHEN B.NO = 3 THEN 		AFTER_DB_SCH_PNM
              WHEN B.NO = 4 THEN 		AFTER_INCBY
              WHEN B.NO = 5 THEN 		AFTER_STRTWT
              WHEN B.NO = 6 THEN 		AFTER_MINVAL
              WHEN B.NO = 7 THEN 		AFTER_MAXVAL
              WHEN B.NO = 8 THEN 		AFTER_CYC_YN
              WHEN B.NO = 9 THEN 		AFTER_ORD_YN
              WHEN B.NO = 10 THEN 		AFTER_CACHE_SZ
              WHEN B.NO = 11 THEN     	AFTER_OBJ_DESCN              
          ELSE NULL END) AS AFTER_DATA          
       ,(CASE 
       		  WHEN B.NO = 1 THEN     	BEFORE_DDL_SEQ_PNM
              WHEN B.NO = 2 THEN 		BEFORE_DB_CONN_TRG_PNM
              WHEN B.NO = 3 THEN 		BEFORE_DB_SCH_PNM
              WHEN B.NO = 4 THEN 		BEFORE_INCBY
              WHEN B.NO = 5 THEN 		BEFORE_STRTWT
              WHEN B.NO = 6 THEN 		BEFORE_MINVAL
              WHEN B.NO = 7 THEN 		BEFORE_MAXVAL
              WHEN B.NO = 8 THEN 		BEFORE_CYC_YN
              WHEN B.NO = 9 THEN 		BEFORE_ORD_YN
              WHEN B.NO = 10 THEN 		BEFORE_CACHE_SZ
              WHEN B.NO = 11 THEN     	BEFORE_OBJ_DESCN
         ELSE NULL END) AS BEFORE_DATA  
from   (SELECT   A.RQST_NO
                ,A.RQST_SNO
                ,A.DDL_SEQ_PNM        AS AFTER_DDL_SEQ_PNM      
				,A.DB_CONN_TRG_PNM    AS AFTER_DB_CONN_TRG_PNM  
				,A.DB_SCH_PNM         AS AFTER_DB_SCH_PNM  
				     
				,A.INCBY              AS AFTER_INCBY            
				,A.STRTWT             AS AFTER_STRTWT           
				,A.MINVAL             AS AFTER_MINVAL           
				,A.MAXVAL             AS AFTER_MAXVAL           
				,A.CYC_YN             AS AFTER_CYC_YN           
				,A.ORD_YN             AS AFTER_ORD_YN           
				,A.CACHE_SZ           AS AFTER_CACHE_SZ         
				,A.OBJ_DESCN          AS AFTER_OBJ_DESCN        
				
				,B.DDL_SEQ_PNM        AS BEFORE_DDL_SEQ_PNM      
				,D.DB_CONN_TRG_PNM    AS BEFORE_DB_CONN_TRG_PNM  
				,C.DB_SCH_PNM         AS BEFORE_DB_SCH_PNM       
				,B.INCBY              AS BEFORE_INCBY            
				,B.STRTWT             AS BEFORE_STRTWT           
				,B.MINVAL             AS BEFORE_MINVAL           
				,B.MAXVAL             AS BEFORE_MAXVAL           
				,B.CYC_YN             AS BEFORE_CYC_YN           
				,B.ORD_YN             AS BEFORE_ORD_YN           
				,B.CACHE_SZ           AS BEFORE_CACHE_SZ         
				,B.OBJ_DESCN          AS BEFORE_OBJ_DESCN 
       		    
          FROM WAQ_DDL_SEQ A
               LEFT OUTER JOIN WAM_DDL_SEQ B
                 ON A.DDL_SEQ_PNM = B.DDL_SEQ_PNM
                AND A.DB_SCH_ID =B.DB_SCH_ID 
			   LEFT OUTER JOIN  WAA_DB_SCH C
                 ON B.DB_SCH_ID = C.DB_SCH_ID
                AND C.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
                AND C.REG_TYP_CD IN ('C', 'U')
               LEFT OUTER JOIN WAA_DB_CONN_TRG D
			    ON C.DB_CONN_TRG_ID = D.DB_CONN_TRG_ID
			   AND D.REG_TYP_CD IN ('C', 'U')
			   AND D.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
         WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_11) B
       )A
  </select>
  
  
    <select id="selectSymnItemChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN '유사용어논리명'
                WHEN NO = 2 THEN '유사용어물리명'
                WHEN NO = 3 THEN '참조항목논리명'
                WHEN NO = 4 THEN '참조항목물리명'
                WHEN NO = 5 THEN '설명'
   
                END AS ITEM_NM
              ,CASE WHEN NO = 1 THEN BEFORE_SYMN_ITEM_LNM 
                WHEN NO = 2 THEN BEFORE_SYMN_ITEM_PNM
                WHEN NO = 3 THEN BEFORE_SDITM_LNM
                WHEN NO = 4 THEN BEFORE_SDITM_PNM
                WHEN NO = 5 THEN BEFORE_OBJ_DESCN
 
               END AS BEFORE_DATA
              ,CASE WHEN NO = 1 THEN AFTER_SYMN_ITEM_LNM 
                WHEN NO = 2 THEN AFTER_SYMN_ITEM_PNM
                WHEN NO = 3 THEN AFTER_SDITM_LNM
                WHEN NO = 4 THEN AFTER_SDITM_PNM
                WHEN NO = 5 THEN AFTER_OBJ_DESCN
          
               END AS AFTER_DATA
        FROM 
            (SELECT
                A.RQST_NO
               ,A.RQST_SNO
               ,A.SYMN_ITEM_LNM     AS AFTER_SYMN_ITEM_LNM         
               ,A.SYMN_ITEM_PNM    	AS AFTER_SYMN_ITEM_PNM         
               ,A.SDITM_LNM     AS AFTER_SDITM_LNM         
               ,A.SDITM_PNM    	AS AFTER_SDITM_PNM         
               ,A.OBJ_DESCN  		AS AFTER_OBJ_DESCN   
               ,B.SYMN_ITEM_LNM     AS BEFORE_SYMN_ITEM_LNM         
               ,B.SYMN_ITEM_PNM    	AS BEFORE_SYMN_ITEM_PNM         
               ,B.SDITM_LNM    	AS BEFORE_SDITM_LNM         
               ,B.SDITM_PNM    	AS BEFORE_SDITM_PNM         
               ,B.OBJ_DESCN  		AS BEFORE_OBJ_DESCN   
            FROM WAQ_SYMN_ITEM A
            INNER JOIN WAM_SYMN_ITEM B
            ON A.SYMN_ITEM_ID = B.SYMN_ITEM_ID
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,
           (SELECT SEQ AS NO FROM seq_1_to_5) B
       )A
  </select>
  
  
  
   <select id="selectSubDmnChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
   SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER_DATA AS 'AFTER'
         ,BEFORE_DATA AS 'BEFORE'
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
		]]>
  FROM (
 SELECT  RQST_NO
       , RQST_SNO
       , (CASE WHEN B.NO = 1 THEN 'SUBDOMIN영문약어'
               WHEN B.NO = 2 THEN 'DOMAIN명'
               WHEN B.NO = 3 THEN '시스템'
               WHEN B.NO = 4 THEN '어플리케이션'
               WHEN B.NO = 5 THEN '설명'               
          ELSE NULL END) AS ITEM_NM          
       , (CASE WHEN B.NO = 1 THEN AFTER_SUBDMN_PNM
               WHEN B.NO = 2 THEN AFTER_DMN_LNM
               WHEN B.NO = 3 THEN AFTER_DATAMODEL_LNM
               WHEN B.NO = 4 THEN AFTER_APPSYSTEM_LNM
               WHEN B.NO = 5 THEN AFTER_OBJ_DESCN
          ELSE NULL END) AS AFTER_DATA          
       , (CASE WHEN B.NO = 1 THEN BEFORE_SUBDMN_PNM
               WHEN B.NO = 2 THEN BEFORE_DMN_LNM
               WHEN B.NO = 3 THEN BEFORE_DATAMODEL_LNM
               WHEN B.NO = 4 THEN BEFORE_APPSYSTEM_LNM
               WHEN B.NO = 5 THEN BEFORE_OBJ_DESCN
          ELSE NULL END) AS BEFORE_DATA 
    FROM (SELECT A.RQST_NO
               , A.RQST_SNO
               , A.SUBDMN_PNM      AS AFTER_SUBDMN_PNM
               , A.DMN_LNM 		  AS AFTER_DMN_LNM
               , A.DATAMODEL_LNM   AS AFTER_DATAMODEL_LNM
               , A.APPSYSTEM_LNM   AS AFTER_APPSYSTEM_LNM
               , A.OBJ_DESCN       AS AFTER_OBJ_DESCN
               , B.SUBDMN_PNM      AS BEFORE_SUBDMN_PNM
               , F.DMN_LNM         AS BEFORE_DMN_LNM
               , D.SUBJ_LNM        AS BEFORE_DATAMODEL_LNM
               , E.SUBJ_LNM        AS BEFORE_APPSYSTEM_LNM
               , B.OBJ_DESCN       AS BEFORE_OBJ_DESCN
          FROM WAQ_DMN_SUBDMN A
               LEFT JOIN WAM_DMN_SUBDMN B
                 ON A.SUBDMN_LNM   = B.SUBDMN_LNM
               LEFT JOIN WAM_DMN F
                 ON B.DMN_ID = F.DMN_ID
                AND F.REG_TYP_CD IN ('C', 'U')
               LEFT JOIN WAA_SUBJ D
                  ON B.OF_DATAMODEL = D.SUBJ_ID
					  AND D.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
					  AND D.REG_TYP_CD IN('C','U') 
					  AND D.SUBJ_LVL = '1'
			     LEFT JOIN WAA_SUBJ E
                  ON D.SUBJ_ID = E.UPP_SUBJ_ID
					  AND A.APPSYSTEM_LNM = E.SUBJ_LNM
					  AND E.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
					  AND E.REG_TYP_CD IN('C','U') 
					  AND E.SUBJ_LVL = '2' 
         WHERE B.REG_TYP_CD IN ('C','U')         
            AND A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT SEQ AS NO 
          FROM seq_1_to_5) B
   )CHG
  </select>
  
  
  <select id="selectSubVvChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
  
  
  SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER_DATA AS 'AFTER'
         ,BEFORE_DATA AS 'BEFORE'
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
		]]>
  FROM (
 SELECT  RQST_NO
       , RQST_SNO
       , (CASE WHEN B.NO = 1 THEN 'POSITION'
               WHEN B.NO = 2 THEN 'SUB유효값LABEL'
               WHEN B.NO = 3 THEN 'DOMAIN유효값한글정의'               
          ELSE NULL END) AS ITEM_NM          
       , (CASE WHEN B.NO = 1 THEN AFTER_DISP_ORD
               WHEN B.NO = 2 THEN AFTER_CD_VAL_LAB
               WHEN B.NO = 3 THEN AFTER_OBJ_DESCN
          ELSE NULL END) AS AFTER_DATA   
       , (CASE WHEN B.NO = 1 THEN BEFORE_DISP_ORD
               WHEN B.NO = 2 THEN BEFORECD_VAL_LAB
               WHEN B.NO = 3 THEN BEFORE_OBJ_DESCN
          ELSE NULL END) AS BEFORE_DATA 
    FROM (SELECT A.RQST_NO
               , A.RQST_SNO
               , A.DISP_ORD      AS AFTER_DISP_ORD
               , A.CD_VAL_LAB    AS AFTER_CD_VAL_LAB
               , A.OBJ_DESCN     AS AFTER_OBJ_DESCN
               , B.DISP_ORD      AS BEFORE_DISP_ORD
               , B.CD_VAL_LAB    AS BEFORECD_VAL_LAB
               , B.OBJ_DESCN     AS BEFORE_OBJ_DESCN
          FROM WAQ_DMN_SUBVV A
          LEFT JOIN WAM_DMN_SUBDMN F
            ON A.SUBDMN_LNM = F.SUBDMN_LNM
           AND F.REG_TYP_CD IN ('C', 'U')
          LEFT JOIN WAM_DMN_SUBVV B
            ON A.CD_VAL   = B.CD_VAL
           AND F.SUBDMN_ID = B.SUBDMN_ID
          WHERE B.REG_TYP_CD IN ('C','U')         
           AND A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
       (SELECT SEQ AS NO 
          FROM seq_1_to_3) B
   )CHG
  </select>
  
	<select id="selectStdErrCdChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
		SELECT RQST_NO
			,RQST_SNO
			,ITEM_NM
			, AFTER_DATA AS "AFTER_CHG"
			, BEFORE_DATA AS "BEFORE_CHG"
          <![CDATA[
			, (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  		FROM (
				SELECT A.RQST_NO, A.RQST_SNO
					,CASE WHEN NO = 1 THEN '국가코드'
					 WHEN NO = 2 THEN '메세지구분'
					 WHEN NO = 3 THEN '내부오류원인부'
					 WHEN NO = 4 THEN '내부오류조치부'
					 WHEN NO = 5 THEN '외부오류원인부'
					 WHEN NO = 6 THEN '외부오류조치부'
					 WHEN NO = 7 THEN '담당자'
					END AS ITEM_NM
					,CASE WHEN NO = 1 THEN BEFORE_STND_ASRT 
					  WHEN NO = 2 THEN BEFORE_ERR_TYP_CD      
					  WHEN NO = 3 THEN BEFORE_ISD_ERR_CAS_CTS 
					  WHEN NO = 4 THEN BEFORE_ISD_ERR_ACTN_CTS
					  WHEN NO = 5 THEN BEFORE_OSD_ERR_CAS_CTS 
					  WHEN NO = 6 THEN BEFORE_OSD_ERR_ACTN_CTS
					  WHEN NO = 7 THEN BEFORE_CRG_USER_NM
					 END AS BEFORE_DATA
					,CASE WHEN NO = 1 THEN AFTER_STND_ASRT 
					  WHEN NO = 2 THEN AFTER_ERR_TYP_CD       
					  WHEN NO = 3 THEN AFTER_ISD_ERR_CAS_CTS  
					  WHEN NO = 4 THEN AFTER_ISD_ERR_ACTN_CTS 
					  WHEN NO = 5 THEN AFTER_OSD_ERR_CAS_CTS  
					  WHEN NO = 6 THEN AFTER_OSD_ERR_ACTN_CTS 
					  WHEN NO = 7 THEN AFTER_CRG_USER_NM
					 END AS AFTER_DATA
        FROM 
            (SELECT
                A.RQST_NO
               ,A.RQST_SNO
               ,A.STND_ASRT     			AS AFTER_STND_ASRT         
               ,A.ERR_TYP_CD    		AS AFTER_ERR_TYP_CD        
               ,A.ISD_ERR_CAS_CTS      	AS AFTER_ISD_ERR_CAS_CTS     
               ,A.ISD_ERR_ACTN_CTS 		AS AFTER_ISD_ERR_ACTN_CTS
               ,A.OSD_ERR_CAS_CTS      	AS AFTER_OSD_ERR_CAS_CTS   
               ,A.OSD_ERR_ACTN_CTS 		AS AFTER_OSD_ERR_ACTN_CTS
               ,B.STND_ASRT     			AS BEFORE_STND_ASRT      
               ,B.ERR_TYP_CD    		AS BEFORE_ERR_TYP_CD     
               ,B.ISD_ERR_CAS_CTS      	AS BEFORE_ISD_ERR_CAS_CTS 
               ,B.ISD_ERR_ACTN_CTS 		AS BEFORE_ISD_ERR_ACTN_CTS 
               ,B.OSD_ERR_CAS_CTS      	AS BEFORE_OSD_ERR_CAS_CTS
               ,B.OSD_ERR_ACTN_CTS 		AS BEFORE_OSD_ERR_ACTN_CTS
               ,U.USER_NM  			    AS AFTER_CRG_USER_NM
               ,C.USER_NM 				AS BEFORE_CRG_USER_NM
            FROM WAQ_STD_ERR_CD A
            INNER JOIN WAM_STD_ERR_CD B
            ON A.STND_ASRT = B.STND_ASRT
         --   AND A.STD_ERR_CD_ID = B.STD_ERR_CD_ID
           AND A.STD_ERR_CD = B.STD_ERR_CD
            LEFT OUTER JOIN WAA_USER C		-- 이전 담당자 명
			  ON B.CRG_USER_ID = C.USER_ID
			 AND C.REG_TYP_CD IN ('C', 'U')
			 AND C.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
			LEFT OUTER JOIN WAA_USER U		-- 이후 담당자 명
			  ON A.CRG_USER_ID = U.USER_ID
			 AND U.REG_TYP_CD IN ('C', 'U')
			 AND U.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
			 
			 
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,
           (SELECT SEQ AS NO FROM seq_1_to_7) B
       )A
	</select>
  
   <select id="selectChnlErrCdChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN '추가메시지'
                	 WHEN NO = 2 THEN '대외표준코드'
                	 WHEN NO = 3 THEN '담당자'
                END AS ITEM_NM
               ,CASE WHEN NO = 1 THEN BEFORE_ADT_MSG 
                	 WHEN NO = 2 THEN BEFORE_TA_STD_CD
                	 WHEN NO = 3 THEN BEFORE_CRG_USER_NM
                END AS BEFORE_DATA
               ,CASE WHEN NO = 1 THEN AFTER_ADT_MSG 
                	 WHEN NO = 2 THEN AFTER_TA_STD_CD
                	 WHEN NO = 3 THEN  AFTER_CRG_USER_NM
                END AS AFTER_DATA
        FROM 
            (SELECT
            		 A.RQST_NO
            		,A.RQST_SNO
            		,A.ADT_MSG AS AFTER_ADT_MSG
            		,A.TA_STD_CD AS AFTER_TA_STD_CD
            		,B.ADT_MSG AS BEFORE_ADT_MSG
            		,B.TA_STD_CD AS BEFORE_TA_STD_CD
            		,H.USER_NM   AS AFTER_CRG_USER_NM
               		,G.USER_NM   AS BEFORE_CRG_USER_NM
            FROM WAQ_CHNL_ERR_CD A 
            INNER JOIN (SELECT B.*
                               ,C.STD_ERR_CD
		  				       ,CONCAT(C.ISD_ERR_CAS_CTS, ' ', C.ISD_ERR_ACTN_CTS) AS STD_ERR_MSG
            			 FROM WAM_CHNL_ERR_CD B 
            			 INNER JOIN WAM_STD_ERR_CD C
            			 ON C.STND_ASRT = B.STND_ASRT
            			 AND C.STD_ERR_CD_ID = B.STD_ERR_CD_ID) B
<!--            	ON CASE WHEN A.CHNL_ERR_CD_ID IS NULL  -->
<!--            	  	    THEN CONCAT(IFNULL(A.STD_ERR_CD,''), IFNULL(A.CHNL_TYP_CD,''), IFNULL(A.CHNL_LAN_DVCD,''), IFNULL(A.MSG_SEQ,''), IFNULL(A.STND_ASRT,''))    -->
<!--            			ELSE CONCAT(IFNULL(A.STND_ASRT,''),A.CHNL_ERR_CD_ID)   -->
<!--            	        END = CASE WHEN A.CHNL_ERR_CD_ID IS NULL  -->
<!--            	   		      THEN CONCAT(IFNULL(B.STD_ERR_CD,''), IFNULL(B.CHNL_TYP_CD,''), IFNULL(B.CHNL_LAN_DVCD,''), IFNULL(B.MSG_SEQ,''),IFNULL(B.STND_ASRT,''))    -->
<!--            	   		      ELSE CONCAT(IFNULL(B.STND_ASRT,''),B.CHNL_ERR_CD_ID)   -->
<!--            	   		      END  -->
 	        ON  IFNULL(A.STD_ERR_CD,'')    = IFNULL(B.STD_ERR_CD,'') 
            AND IFNULL(A.CHNL_TYP_CD,'')   = IFNULL(B.CHNL_TYP_CD,'')
            AND IFNULL(A.CHNL_LAN_DVCD,'') = IFNULL(B.CHNL_LAN_DVCD,'')
            AND IFNULL(A.MSG_SEQ,'')       = IFNULL(B.MSG_SEQ,'')
            AND IFNULL(A.STND_ASRT,'')       = IFNULL(B.STND_ASRT,'')
            LEFT OUTER JOIN WAA_USER G
			  ON B.CRG_USER_ID = G.USER_ID
			 AND G.REG_TYP_CD IN ('C', 'U')
			 AND G.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
		    LEFT OUTER JOIN WAA_USER H
			  ON A.CRG_USER_ID = H.USER_ID
			 AND H.REG_TYP_CD IN ('C', 'U')
			 AND H.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
			 
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
              AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,
           (SELECT SEQ AS NO FROM seq_1_to_3) B
       )A
  </select>
  
  <!-- 업무별오류코드 -->
 <select id="selectBizErrCdChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
	SELECT RQST_NO
			,RQST_SNO
			,ITEM_NM
			, AFTER_DATA AS "AFTER_CHG"
			, BEFORE_DATA AS "BEFORE_CHG"
          <![CDATA[
			, (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  		FROM (
				SELECT A.RQST_NO, A.RQST_SNO
					,CASE WHEN NO = 1 THEN '국가코드'
					 WHEN NO = 2 THEN '기관구분'
					 WHEN NO = 3 THEN '생성방법'
					 WHEN NO = 4 THEN '어플리케이션/모듈'
					 WHEN NO = 5 THEN '업무별오류CODE'
					 WHEN NO = 6 THEN '표준오류CODE'
					 WHEN NO = 7 THEN '담당자'
					END AS ITEM_NM
					,CASE WHEN NO = 1 THEN BEFORE_STND_ASRT 
					  WHEN NO = 2 THEN BEFORE_OF_SYSTEM      
					  WHEN NO = 3 THEN BEFORE_CODE_GEN_MTHD 
					  WHEN NO = 4 THEN BEFORE_SUBJ_LNM
					  WHEN NO = 5 THEN BEFORE_BIZ_ERR_CD 
					  WHEN NO = 6 THEN BEFORE_STD_ERR_CD
					  WHEN NO = 7 THEN BEFORE_CRG_USER_NM
					 END AS BEFORE_DATA
					,CASE WHEN NO = 1 THEN AFTER_STND_ASRT 
					  WHEN NO = 2 THEN AFTER_OF_SYSTEM      
					  WHEN NO = 3 THEN AFTER_CODE_GEN_MTHD 
					  WHEN NO = 4 THEN AFTER_SUBJ_LNM
					  WHEN NO = 5 THEN AFTER_BIZ_ERR_CD 
					  WHEN NO = 6 THEN AFTER_STD_ERR_CD 
					  WHEN NO = 7 THEN AFTER_CRG_USER_NM
					 END AS AFTER_DATA
        FROM 
            (SELECT
                A.RQST_NO
               ,A.RQST_SNO
               ,A.STND_ASRT     			AS AFTER_STND_ASRT         
               ,A.OF_SYSTEM    			AS AFTER_OF_SYSTEM        
               ,A.CODE_GEN_MTHD      	AS AFTER_CODE_GEN_MTHD     
               ,E.FULL_PATH 			AS AFTER_SUBJ_LNM
               ,A.BIZ_ERR_CD			AS AFTER_BIZ_ERR_CD
               ,C.STD_ERR_CD	       	AS AFTER_STD_ERR_CD 
               ,B.STND_ASRT     			AS BEFORE_STND_ASRT      
               ,B.OF_SYSTEM    			AS BEFORE_OF_SYSTEM     
               ,B.CODE_GEN_MTHD      	AS BEFORE_CODE_GEN_MTHD 
               ,F.FULL_PATH 			AS BEFORE_SUBJ_LNM 
               ,B.BIZ_ERR_CD			AS BEFORE_BIZ_ERR_CD
               ,D.STD_ERR_CD 	      	AS BEFORE_STD_ERR_CD
               ,H.USER_NM           AS AFTER_CRG_USER_NM
               ,G.USER_NM               AS BEFORE_CRG_USER_NM
            FROM WAQ_BIZ_ERR_CD A
            INNER JOIN WAM_BIZ_ERR_CD B
            ON A.STND_ASRT = B.STND_ASRT
            AND A.BIZ_ERR_CD = B.BIZ_ERR_CD
            INNER JOIN WAM_STD_ERR_CD C
              ON A.STND_ASRT = C.STND_ASRT
             AND A.STD_ERR_CD_ID = C.STD_ERR_CD_ID
            INNER JOIN WAM_STD_ERR_CD D
              ON B.STND_ASRT = D.STND_ASRT
             AND B.STD_ERR_CD_ID = D.STD_ERR_CD_ID
            INNER JOIN WAA_SUBJ E
               ON E.STND_ASRT = A.STND_ASRT
              AND E.SUBJ_ID = A.SUBJ_ID
			  AND E.EXP_DTM = STR_TO_DATE('9999-12-31','%Y-%m-%d')
			  AND E.REG_TYP_CD IN ('C', 'U') 
			INNER JOIN WAA_SUBJ F
               ON F.STND_ASRT = B.STND_ASRT
              AND F.SUBJ_ID = B.SUBJ_ID
			  AND F.EXP_DTM = STR_TO_DATE('9999-12-31','%Y-%m-%d')
			  AND F.REG_TYP_CD IN ('C', 'U') 
			LEFT OUTER JOIN WAA_USER G
			  ON B.CRG_USER_ID = G.USER_ID
			 AND G.REG_TYP_CD IN ('C', 'U')
			 AND G.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
		    LEFT OUTER JOIN WAA_USER H
			  ON A.CRG_USER_ID = H.USER_ID
			 AND H.REG_TYP_CD IN ('C', 'U')
			 AND H.EXP_DTM = STR_TO_DATE('9999-12-31', '%Y-%m-%d')
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,
           (SELECT SEQ AS NO FROM seq_1_to_7) B
       )A
  </select>  
  
  <!-- 언어별코드유효값 -->
  <select id="selectLangCdvalCmmtChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
	SELECT RQST_NO
			,RQST_SNO
			,ITEM_NM
			, AFTER_DATA AS "AFTER_CHG"
			, BEFORE_DATA AS "BEFORE_CHG"
          <![CDATA[
			, (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  		FROM (
				SELECT A.RQST_NO, A.RQST_SNO
					,CASE WHEN NO = 1 THEN '언어코드'
					 	  WHEN NO = 2 THEN '언어별코드값커멘트논리명'
					 <!-- WHEN NO = 2 THEN '도메인유효값' -->
					 <!-- WHEN NO = 3 THEN '국가코드' -->
					 <!-- WHEN NO = 5 THEN '언어별코드값커멘트물리명' -->
					END AS ITEM_NM
					,CASE WHEN NO = 1 THEN BEFORE_LANG_CD 
					  	  WHEN NO = 2 THEN BEFORE_LANG_CDVAL_CMMT_LNM
					  <!-- WHEN NO = 2 THEN BEFORE_CD_VAL_ID -->      
					  <!-- WHEN NO = 3 THEN BEFORE_STND_ASRT --> 
					  <!-- WHEN NO = 5 THEN BEFORE_LANG_CDVAL_CMMT_PNM --> 
					   
					 END AS BEFORE_DATA
					,CASE WHEN NO = 1 	THEN AFTER_LANG_CD 
					  	  WHEN NO = 2 	THEN AFTER_LANG_CDVAL_CMMT_LNM
					  	  <!-- WHEN NO = 2 		THEN AFTER_CD_VAL_ID -->      
					  	  <!-- WHEN NO = 3 		THEN AFTER_STND_ASRT --> 
					  	  <!-- WHEN NO = 5 		THEN AFTER_LANG_CDVAL_CMMT_PNM --> 
					 END AS AFTER_DATA
        FROM 
            (SELECT
                A.RQST_NO
               ,A.RQST_SNO
               ,A.LANG_CD     			AS AFTER_LANG_CD         
               ,A.LANG_CDVAL_CMMT_LNM 	AS AFTER_LANG_CDVAL_CMMT_LNM
               <!-- ,A.CD_VAL_ID    			AS AFTER_CD_VAL_ID -->        
               <!-- ,A.STND_ASRT      			AS AFTER_STND_ASRT -->     
               <!-- ,A.LANG_CDVAL_CMMT_PNM	AS AFTER_LANG_CDVAL_CMMT_PNM -->
               
               ,B.LANG_CD     			AS BEFORE_LANG_CD      
               ,B.LANG_CDVAL_CMMT_LNM 	AS BEFORE_LANG_CDVAL_CMMT_LNM
               <!-- ,B.CD_VAL_ID    			AS BEFORE_CD_VAL_ID -->     
               <!-- ,B.STND_ASRT      			AS BEFORE_STND_ASRT --> 
               <!-- ,B.LANG_CDVAL_CMMT_PNM	AS BEFORE_LANG_CDVAL_CMMT_PNM -->
               
            FROM WAQ_LANG_CDVAL_CMMT A
            INNER JOIN WAM_LANG_CDVAL_CMMT B
            ON A.STND_ASRT = B.STND_ASRT
            AND A.LANG_CDVAL_CMMT_ID = B.LANG_CDVAL_CMMT_ID
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,
           (SELECT SEQ AS NO FROM seq_1_to_2) B
       )A
  </select>
  
  
  <!-- 언어별컬럼명 -->
  <select id="selectLangColCmmtChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
	SELECT RQST_NO
	         ,RQST_SNO
	         ,ITEM_NM
	         , AFTER_DATA AS "AFTER_CHG"
	         , BEFORE_DATA AS "BEFORE_CHG"
	         <![CDATA[
	         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
	         ]]>
	  FROM (
	        SELECT A.RQST_NO, A.RQST_SNO
	               ,CASE WHEN NO = 1 THEN '언어별컬럼커멘트논리명'    
	                	 WHEN NO = 2 THEN '언어별컬럼커멘트물리명'    
	                	 WHEN NO = 3 THEN '설명'             
	                END AS ITEM_NM
	               ,CASE WHEN NO = 1 THEN BEFORE_LANG_COL_CMMT_LNM
	                	 WHEN NO = 2 THEN BEFORE_LANG_COL_CMMT_PNM
	                	 WHEN NO = 3 THEN BEFORE_OBJ_DESCN        
	                END AS BEFORE_DATA
	               ,CASE WHEN NO = 1 THEN AFTER_LANG_COL_CMMT_LNM
	                	 WHEN NO = 2 THEN AFTER_LANG_COL_CMMT_PNM
	                	 WHEN NO = 3 THEN AFTER_OBJ_DESCN        
	                END AS AFTER_DATA
	        FROM 
	            (SELECT
	            		 A.RQST_NO
	            		,A.RQST_SNO
	            		,A.LANG_COL_CMMT_LNM	AS AFTER_LANG_COL_CMMT_LNM
	            		,A.LANG_COL_CMMT_PNM 	AS AFTER_LANG_COL_CMMT_PNM
	            		,A.OBJ_DESCN        	AS AFTER_OBJ_DESCN             
	            		,B.LANG_COL_CMMT_LNM	AS BEFORE_LANG_COL_CMMT_LNM
	            		,B.LANG_COL_CMMT_PNM 	AS BEFORE_LANG_COL_CMMT_PNM
	            		,B.OBJ_DESCN        	AS BEFORE_OBJ_DESCN        
	            FROM WAQ_LANG_COL_CMMT A INNER JOIN 
	            									(SELECT B.*, D.FULL_PATH, D.PDM_TBL_PNM, C.PDM_COL_PNM
	            								   	 FROM WAM_LANG_COL_CMMT B INNER JOIN WAM_PDM_COL C
	            								   								  	  ON B.PDM_COL_ID = C.PDM_COL_ID
	            								   							  INNER JOIN WAM_PDM_TBL D
	            								   								  	  ON C.PDM_TBL_ID = D.PDM_TBL_ID
	            								   	)B							  	  
		            							   ON CASE WHEN NULLIF(A.LANG_COL_CMMT_ID,'') IS NULL 
		            							   		   THEN CONCAT(IFNULL(A.STND_ASRT,''), IFNULL(A.LANG_CD,''), IFNULL(A.FULL_PATH,''), IFNULL(A.PDM_TBL_PNM,''), IFNULL(A.PDM_COL_PNM,''))   
		            							   		   ELSE A.LANG_COL_CMMT_ID  
		            							      END = CASE WHEN NULLIF(A.LANG_COL_CMMT_ID,'') IS NULL 
		            							      		     THEN CONCAT(IFNULL(B.STND_ASRT,''), IFNULL(B.LANG_CD,''), IFNULL(B.FULL_PATH,''), IFNULL(B.PDM_TBL_PNM,''), IFNULL(B.PDM_COL_PNM,''))    
		            							      		     ELSE B.LANG_COL_CMMT_ID  
		            							      		END
	            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
	              AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
	        ,
	           (SELECT SEQ AS NO FROM seq_1_to_3) B
	       )A
  </select>
  
    <!-- 언어별테이블명 -->
  <select id="selectLangPdmTblCmmtChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
	SELECT RQST_NO
			,RQST_SNO
			,ITEM_NM
			, AFTER_DATA AS "AFTER_CHG"
			, BEFORE_DATA AS "BEFORE_CHG"
          <![CDATA[
			, (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  		FROM (
				SELECT A.RQST_NO, A.RQST_SNO
					,CASE 
					 WHEN NO = 1 		THEN '언어구분'
					 WHEN NO = 2 		THEN '언어별테이블커멘트논리명'
					END AS ITEM_NM
					,CASE 
						WHEN NO = 1 	THEN BEFORE_LANG_CD
					  	WHEN NO = 2 	THEN BEFORE_TBL_LANG_CMMT_LNM      
					 END AS BEFORE_DATA
					,CASE 
						WHEN NO = 1 	THEN AFTER_LANG_CD
						WHEN NO = 2 	THEN AFTER_TBL_LANG_CMMT_LNM      
					 END AS AFTER_DATA
        FROM 
            (SELECT
                A.RQST_NO
               ,A.RQST_SNO
               
               ,A.LANG_CD     			AS AFTER_LANG_CD          
               ,A.TBL_LANG_CMMT_LNM 	AS AFTER_TBL_LANG_CMMT_LNM
               
               ,B.LANG_CD     			AS BEFORE_LANG_CD      
               ,B.TBL_LANG_CMMT_LNM 	AS BEFORE_TBL_LANG_CMMT_LNM 
               
               
            FROM WAQ_LANG_TBL_CMMT A
            INNER JOIN WAM_LANG_TBL_CMMT B
            ON A.TBL_LANG_CMMT_ID = B.TBL_LANG_CMMT_ID
            AND A.STND_ASRT = B.STND_ASRT
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,
           (SELECT SEQ AS NO FROM seq_1_to_2) B
       )A
  </select>
  
  <!-- CDC테이블 -->
  <select id="selectCdcTblChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
	SELECT RQST_NO
	         ,RQST_SNO
	         ,ITEM_NM
	         , AFTER_DATA AS "AFTER_CHG"
	         , BEFORE_DATA AS "BEFORE_CHG"
	         <![CDATA[
	         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
	         ]]>
	  FROM (
	        SELECT A.RQST_NO, A.RQST_SNO
	               ,CASE WHEN NO = 1 THEN 'CDC테이블물리명'    
	                	 WHEN NO = 2 THEN 'CDC테이블논리명'    
	                	 WHEN NO = 3 THEN 'CDC여부'             
	                	 WHEN NO = 4 THEN 'CDC테이블크기'             
	                	 WHEN NO = 5 THEN '날짜Key'             
	                	 WHEN NO = 6 THEN '복제시 추가컬럼'             
	                	 WHEN NO = 7 THEN 'CDC담당자 수'             
	                END AS ITEM_NM
	               ,CASE WHEN NO = 1 THEN BEFORE_CDC_TBL_PNM
	                	 WHEN NO = 2 THEN BEFORE_CDC_TBL_LNM
	                	 WHEN NO = 3 THEN BEFORE_CDC_YN   
	                	 WHEN NO = 4 THEN BEFORE_CDC_TBL_SIZE             
	                	 WHEN NO = 5 THEN BEFORE_DATE_KEY    
	                	 WHEN NO = 6 THEN BEFORE_CDC_ADT_COLS
	                	 WHEN NO = 7 THEN BEFORE_CDC_CRGP_CNT
	                END AS BEFORE_DATA
	               ,CASE WHEN NO = 1 THEN AFTER_CDC_TBL_PNM  
	                	 WHEN NO = 2 THEN AFTER_CDC_TBL_LNM  
	                	 WHEN NO = 3 THEN AFTER_CDC_YN       
	                	 WHEN NO = 4 THEN AFTER_CDC_TBL_SIZE          
	                	 WHEN NO = 5 THEN AFTER_DATE_KEY     
	                	 WHEN NO = 6 THEN AFTER_CDC_ADT_COLS 
	                	 WHEN NO = 7 THEN AFTER_CDC_CRGP_CNT
	                END AS AFTER_DATA
	        FROM 
	            (SELECT
	            		 A.RQST_NO
	            		,A.RQST_SNO
	            		,A.CDC_TBL_PNM 	     AS AFTER_CDC_TBL_PNM 
	            		,A.CDC_TBL_LNM       AS AFTER_CDC_TBL_LNM 
	            		,A.CDC_YN      	     AS AFTER_CDC_YN           
	            		,A.CDC_TBL_SIZE	     AS AFTER_CDC_TBL_SIZE     
	            		,A.DATE_KEY    	     AS AFTER_DATE_KEY         
	            		,A.CDC_ADT_COLS	     AS AFTER_CDC_ADT_COLS  
	            		, (SELECT COUNT(1) FROM WAQ_CDC_MNG 
                       	    WHERE RQST_NO = #{rqstNo,jdbcType=VARCHAR}
	                          AND RQST_SNO = #{rqstSno,jdbcType=VARCHAR}
	                          AND RQST_DCD NOT IN ('DD')  ) AS AFTER_CDC_CRGP_CNT
	            		   
	            		,B.CDC_TBL_PNM 	     AS BEFORE_CDC_TBL_PNM 
	            		,B.CDC_TBL_LNM       AS BEFORE_CDC_TBL_LNM 
	            		,B.CDC_YN      	     AS BEFORE_CDC_YN      
	            		,B.CDC_TBL_SIZE	     AS BEFORE_CDC_TBL_SIZE
	            		,B.DATE_KEY    	     AS BEFORE_DATE_KEY    
	            		,B.CDC_ADT_COLS	     AS BEFORE_CDC_ADT_COLS
	            		, (SELECT COUNT(1) FROM WAM_CDC_MNG 
                       		WHERE CDC_TBL_ID = B.CDC_TBL_ID) AS BEFORE_CDC_CRGP_CNT
	            FROM WAQ_CDC_TBL A INNER JOIN 
           									(SELECT B.*, C.DDL_TBL_PNM, E.DB_CONN_TRG_PNM, D.DB_SCH_PNM
           										  , G.DB_CONN_TRG_PNM AS TGT_DB_CONN_TRG_PNM, F.DB_SCH_PNM AS TGT_DB_SCH_PNM
          								   	 FROM WAM_CDC_TBL B  INNER JOIN WAM_DDL_TBL C
					                          							 ON B.DDL_TBL_ID = C.DDL_TBL_ID
					                          							AND B.STND_ASRT = C.STND_ASRT
					                          					 INNER JOIN WAA_DB_SCH D
					    					  							 ON D.EXP_DTM = STR_TO_DATE('9999-12-31','%Y-%m-%d')
					    					  							AND D.REG_TYP_CD IN ('C', 'U') 
					    					  						    AND C.DB_SCH_ID = D.DB_SCH_ID
					    					  						    AND C.STND_ASRT 	= D.STND_ASRT
					    					  					 INNER JOIN WAA_DB_CONN_TRG E
					    					  					 		 ON E.EXP_DTM = STR_TO_DATE('9999-12-31','%Y-%m-%d')
					    					  					 		AND E.REG_TYP_CD IN ('C', 'U')
					    					  					 		AND D.DB_CONN_TRG_ID = E.DB_CONN_TRG_ID
					    					  					 		AND D.STND_ASRT 		 = E.STND_ASRT
					    					  					 INNER JOIN WAA_DB_SCH F
					    					  							 ON F.EXP_DTM = STR_TO_DATE('9999-12-31','%Y-%m-%d')
					    					  							AND F.REG_TYP_CD IN ('C', 'U') 
					    					  						    AND B.TGT_DB_SCH_ID = F.DB_SCH_ID
					    					  						    AND B.STND_ASRT 		= F.STND_ASRT
					    					  					 INNER JOIN WAA_DB_CONN_TRG G
					    					  					 		 ON G.EXP_DTM = STR_TO_DATE('9999-12-31','%Y-%m-%d')
					    					  					 		AND G.REG_TYP_CD IN ('C', 'U')
					    					  					 		AND F.DB_CONN_TRG_ID = G.DB_CONN_TRG_ID
					    					  					 		AND F.STND_ASRT 		 = G.STND_ASRT	    
           								   	)B							  	  
            							   ON CASE WHEN NULLIF(A.CDC_TBL_ID,'') IS NULL 
            							   		   THEN CONCAT(IFNULL(A.STND_ASRT,''), IFNULL(A.DDL_TBL_PNM,''), IFNULL(A.DB_CONN_TRG_PNM,''), IFNULL(A.DB_SCH_PNM,''), IFNULL(A.TGT_DB_CONN_TRG_PNM,''), IFNULL(A.TGT_DB_SCH_PNM,''))   
            							   		   ELSE A.CDC_TBL_ID  
            							      END = CASE WHEN NULLIF(A.CDC_TBL_ID,'') IS NULL 
	            							   		     THEN CONCAT(IFNULL(B.STND_ASRT,''), IFNULL(B.DDL_TBL_PNM,''), IFNULL(B.DB_CONN_TRG_PNM,''), IFNULL(B.DB_SCH_PNM,''), IFNULL(B.TGT_DB_CONN_TRG_PNM,''), IFNULL(B.TGT_DB_SCH_PNM,''))   
            							      		     ELSE B.CDC_TBL_ID  
            							      		END
	            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
	              AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
	        ,
	           (SELECT SEQ AS NO FROM seq_1_to_7) B
	       )A
  </select>
  
  <!-- CDC테이블 -->
  <select id="selectCdcMngChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
	SELECT RQST_NO
	         ,RQST_SNO
	         ,ITEM_NM
	         , AFTER_DATA AS "AFTER_CHG"
	         , BEFORE_DATA AS "BEFORE_CHG"
	         <![CDATA[
	         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
	         ]]>
	  FROM (
	        SELECT A.RQST_NO, A.RQST_SNO
	               ,CASE WHEN NO = 1 THEN 'CDC담당자명'    
	                	 WHEN NO = 2 THEN 'CDC담당부서'    
	                	 WHEN NO = 3 THEN '업무용도'             
	                	 WHEN NO = 4 THEN '보관주기'             
	                END AS ITEM_NM
	               ,CASE WHEN NO = 1 THEN BEFORE_CDC_CRGP_NM
	                	 WHEN NO = 2 THEN BEFORE_CDC_CRGP_DEPT_NM
	                	 WHEN NO = 3 THEN BEFORE_MNG_USAGE   
	                	 WHEN NO = 4 THEN BEFORE_CTD_FCY            
	                END AS BEFORE_DATA
	               ,CASE WHEN NO = 1 THEN AFTER_CDC_CRGP_NM     
	                	 WHEN NO = 2 THEN AFTER_CDC_CRGP_DEPT_NM
	                	 WHEN NO = 3 THEN AFTER_MNG_USAGE       
	                	 WHEN NO = 4 THEN AFTER_CTD_FCY                
	                END AS AFTER_DATA
	        FROM 
	            (SELECT
	            		 A.RQST_NO
	            		,A.RQST_SNO
	            		,A.CDC_CRGP_NM          AS AFTER_CDC_CRGP_NM     
	            		,A.CDC_CRGP_DEPT_NM     AS AFTER_CDC_CRGP_DEPT_NM
	            		,A.MNG_USAGE            AS AFTER_MNG_USAGE            
	            		,A.CTD_FCY              AS AFTER_CTD_FCY              
	            		,B.CDC_CRGP_NM          AS BEFORE_CDC_CRGP_NM     
	            		,B.CDC_CRGP_DEPT_NM     AS BEFORE_CDC_CRGP_DEPT_NM
	            		,B.MNG_USAGE            AS BEFORE_MNG_USAGE       
	            		,B.CTD_FCY              AS BEFORE_CTD_FCY         
	            FROM WAQ_CDC_MNG A INNER JOIN 
           									(SELECT B.* 
           											, E.DB_CONN_TRG_PNM AS TGT_DB_CONN_TRG_PNM
           											, D.DB_SCH_PNM AS TGT_DB_SCH_PNM 
          								   	 FROM WAM_CDC_MNG B  INNER JOIN WAM_CDC_TBL C
					                          							 ON B.CDC_TBL_ID = C.CDC_TBL_ID
					                          							AND B.STND_ASRT = C.STND_ASRT
					                          					 INNER JOIN WAA_DB_SCH D
					    					  							 ON D.EXP_DTM = STR_TO_DATE('9999-12-31','%Y-%m-%d')
					    					  							AND D.REG_TYP_CD IN ('C', 'U') 
					    					  						    AND C.TGT_DB_SCH_ID = D.DB_SCH_ID
					    					  						    AND C.STND_ASRT 	= D.STND_ASRT
					    					  					 INNER JOIN WAA_DB_CONN_TRG E
					    					  					 		 ON E.EXP_DTM = STR_TO_DATE('9999-12-31','%Y-%m-%d')
					    					  					 		AND E.REG_TYP_CD IN ('C', 'U')
					    					  					 		AND D.DB_CONN_TRG_ID = E.DB_CONN_TRG_ID
					    					  					 		AND D.STND_ASRT 		 = E.STND_ASRT
           								   	)B							  	  
            							   ON CASE WHEN NULLIF(A.CDC_MNG_ID,'') IS NULL 
            							   		   THEN CONCAT(IFNULL(A.STND_ASRT,''), IFNULL(A.CDC_TBL_PNM,''), IFNULL(A.TGT_DB_CONN_TRG_PNM,''), IFNULL(A.TGT_DB_SCH_PNM,''))   
            							   		   ELSE A.CDC_MNG_ID  
            							      END = CASE WHEN NULLIF(A.CDC_MNG_ID,'') IS NULL 
	            							   		     THEN CONCAT(IFNULL(B.STND_ASRT,''), IFNULL(B.CDC_TBL_PNM,''), IFNULL(B.TGT_DB_CONN_TRG_PNM,''), IFNULL(B.TGT_DB_SCH_PNM,''))   
            							      		     ELSE B.CDC_MNG_ID  
            							      		END
	            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
	              AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}
	              AND A.RQST_DTL_SNO = #{rqstDtlSno,jdbcType=DECIMAL}
	              ) A
	        ,
	           (SELECT SEQ AS NO FROM seq_1_to_4) B
	       )A
  </select>

	<select id="selectApplicationModuleChangeList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
		SELECT RQST_NO
				,RQST_SNO
				,ITEM_NM
				, AFTER_DATA AS "AFTER_CHG"
				, BEFORE_DATA AS "BEFORE_CHG"
	          <![CDATA[
				, (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
	         ]]>
	  		FROM (
					SELECT A.RQST_NO, A.RQST_SNO
						,CASE 	WHEN NO = 1 THEN '어플리케이션/모듈논리명'
						 	  	WHEN NO = 2 THEN '어플리케이션/모듈물리명'
						 		WHEN NO = 3 THEN '어플리케이션/모듈약어'
						 		WHEN NO = 4 THEN '상위어플리케이션/모듈명'
						 		WHEN NO = 5 THEN '어플리케이션/모듈레벨'
						 		WHEN NO = 6 THEN '표준적용여부'
						 		WHEN NO = 7 THEN '레거시구분코드'
						 		WHEN NO = 8 THEN '시스템영역'
						 		WHEN NO = 9 THEN 'DBMS유형코드'
						 		WHEN NO = 10 THEN '영문약어'
						 		
						 		WHEN NO = 11 THEN 'AP시스템명'
						 		WHEN NO = 12 THEN 'DB시스템명'
						 		WHEN NO = 13 THEN 'SID'
						 		WHEN NO = 14 THEN 'AP구성방식'
						 		WHEN NO = 15 THEN 'DB구성방식'
						 		WHEN NO = 16 THEN 'DR구축여부'
						 		WHEN NO = 17 THEN 'DR방식'
						 		WHEN NO = 18 THEN 'DBMS'
						 		WHEN NO = 19 THEN '관리부서'
						 		WHEN NO = 20 THEN '팀명(업무)'
						 		
						 		WHEN NO = 21 THEN '업무주관부서'
						 		WHEN NO = 22 THEN 'DB갱신권한'
						 		WHEN NO = 23 THEN '시스템이행일'
						 		WHEN NO = 24 THEN '작성자'
						 		WHEN NO = 25 THEN '변경관리자'
						 		WHEN NO = 26 THEN '업무중요도'
						END AS ITEM_NM
						,CASE 	WHEN NO = 1 THEN BEFORE_SUBJ_LNM 
						  	  	WHEN NO = 2 THEN BEFORE_SUBJ_PNM
						 		WHEN NO = 3 THEN BEFORE_SUBJ_ABR_NM
						 		WHEN NO = 4 THEN BEFORE_UPP_SUBJ_ID
						 		WHEN NO = 5 THEN BEFORE_SUBJ_LVL
						 		WHEN NO = 6 THEN BEFORE_STD_APL_YN
						 		WHEN NO = 7 THEN BEFORE_LECY_DCD
						 		WHEN NO = 8 THEN BEFORE_SYS_AREA_ID
						 		WHEN NO = 9 THEN BEFORE_DBMS_TYP_CD
						 		WHEN NO = 10 THEN BEFORE_PRE_NM
						 		
						 		WHEN NO = 11 THEN BEFORE_AP_SYS_NM
						 		WHEN NO = 12 THEN BEFORE_DB_SYS_NM
						 		WHEN NO = 13 THEN BEFORE_DB_SID_NM
						 		WHEN NO = 14 THEN BEFORE_AP_DUAL_MTH
						 		WHEN NO = 15 THEN BEFORE_DB_DUAL_MTH
						 		WHEN NO = 16 THEN BEFORE_DR_YN
						 		WHEN NO = 17 THEN BEFORE_DR_MTH
						 		WHEN NO = 18 THEN BEFORE_DBMS_NM
						 		WHEN NO = 19 THEN BEFORE_MNG_DEPT_NM
						 		WHEN NO = 20 THEN BEFORE_WRK_NM
						 		
						 		WHEN NO = 21 THEN BEFORE_WRK_DEPT
						 		WHEN NO = 22 THEN BEFORE_DB_CHG_AUTH
						 		WHEN NO = 23 THEN BEFORE_SYS_RUN_DTM
						 		WHEN NO = 24 THEN BEFORE_WRITER
						 		WHEN NO = 25 THEN BEFORE_CHG_USER
						 		WHEN NO = 26 THEN BEFORE_WRK_STAT
						   
						 END AS BEFORE_DATA
						,CASE 	WHEN NO = 1 THEN AFTER_SUBJ_LNM 
						  	  	WHEN NO = 2 THEN AFTER_SUBJ_PNM
						 		WHEN NO = 3 THEN AFTER_SUBJ_ABR_NM
						 		WHEN NO = 4 THEN AFTER_UPP_SUBJ_ID
						 		WHEN NO = 5 THEN AFTER_SUBJ_LVL
						 		WHEN NO = 6 THEN AFTER_STD_APL_YN
						 		WHEN NO = 7 THEN AFTER_LECY_DCD
						 		WHEN NO = 8 THEN AFTER_SYS_AREA_ID
						 		WHEN NO = 9 THEN AFTER_DBMS_TYP_CD
						 		WHEN NO = 10 THEN AFTER_PRE_NM
						 		
						 		WHEN NO = 11 THEN AFTER_AP_SYS_NM
						 		WHEN NO = 12 THEN AFTER_DB_SYS_NM
						 		WHEN NO = 13 THEN AFTER_DB_SID_NM
						 		WHEN NO = 14 THEN AFTER_AP_DUAL_MTH
						 		WHEN NO = 15 THEN AFTER_DB_DUAL_MTH
						 		WHEN NO = 16 THEN AFTER_DR_YN
						 		WHEN NO = 17 THEN AFTER_DR_MTH
						 		WHEN NO = 18 THEN AFTER_DBMS_NM
						 		WHEN NO = 19 THEN AFTER_MNG_DEPT_NM
						 		WHEN NO = 20 THEN AFTER_WRK_NM
						 		
						 		WHEN NO = 21 THEN AFTER_WRK_DEPT
						 		WHEN NO = 22 THEN AFTER_DB_CHG_AUTH
						 		WHEN NO = 23 THEN AFTER_SYS_RUN_DTM
						 		WHEN NO = 24 THEN AFTER_WRITER
						 		WHEN NO = 25 THEN AFTER_CHG_USER
						 		WHEN NO = 26 THEN AFTER_WRK_STAT
						 END AS AFTER_DATA
	        FROM 
	            (SELECT
	                A.RQST_NO					
	               ,A.RQST_SNO         
	               ,A.SUBJ_LNM      AS AFTER_SUBJ_LNM      
	               ,A.SUBJ_PNM      AS AFTER_SUBJ_PNM   
	               ,A.SUBJ_ABR_NM   AS AFTER_SUBJ_ABR_NM
	               ,A.UPP_SUBJ_ID   AS AFTER_UPP_SUBJ_ID
	               ,A.SUBJ_LVL      AS AFTER_SUBJ_LVL   
	               ,A.STD_APL_YN    AS AFTER_STD_APL_YN 
	               ,A.LECY_DCD      AS AFTER_LECY_DCD   
	               ,A.SYS_AREA_ID   AS AFTER_SYS_AREA_ID
	               ,A.DBMS_TYP_CD   AS AFTER_DBMS_TYP_CD
	               ,A.PRE_NM        AS AFTER_PRE_NM     
	               ,A.AP_SYS_NM     AS AFTER_AP_SYS_NM  
	               ,A.DB_SYS_NM     AS AFTER_DB_SYS_NM  
	               ,A.DB_SID_NM     AS AFTER_DB_SID_NM  
	               ,A.AP_DUAL_MTH   AS AFTER_AP_DUAL_MTH
	               ,A.DB_DUAL_MTH   AS AFTER_DB_DUAL_MTH
	               ,A.DR_YN         AS AFTER_DR_YN      
	               ,A.DR_MTH        AS AFTER_DR_MTH     
	               ,A.DBMS_NM       AS AFTER_DBMS_NM    
	               ,A.MNG_DEPT_NM   AS AFTER_MNG_DEPT_NM
	               ,A.WRK_NM        AS AFTER_WRK_NM     
	               ,A.WRK_DEPT      AS AFTER_WRK_DEPT   
	               ,A.DB_CHG_AUTH   AS AFTER_DB_CHG_AUTH
	               ,A.SYS_RUN_DTM   AS AFTER_SYS_RUN_DTM
	               ,A.WRITER        AS AFTER_WRITER     
	               ,A.CHG_USER      AS AFTER_CHG_USER   
	               ,A.WRK_STAT      AS AFTER_WRK_STAT   

	               ,B.SUBJ_LNM      AS BEFORE_SUBJ_LNM    
	               ,B.SUBJ_PNM      AS BEFORE_SUBJ_PNM    
	               ,B.SUBJ_ABR_NM   AS BEFORE_SUBJ_ABR_NM 
	               ,B.UPP_SUBJ_ID   AS BEFORE_UPP_SUBJ_ID 
	               ,B.SUBJ_LVL      AS BEFORE_SUBJ_LVL    
	               ,B.STD_APL_YN    AS BEFORE_STD_APL_YN  
	               ,B.LECY_DCD      AS BEFORE_LECY_DCD    
	               ,B.SYS_AREA_ID   AS BEFORE_SYS_AREA_ID 
	               ,B.DBMS_TYP_CD   AS BEFORE_DBMS_TYP_CD 
	               ,B.PRE_NM        AS BEFORE_PRE_NM      
	               ,B.AP_SYS_NM     AS BEFORE_AP_SYS_NM   
	               ,B.DB_SYS_NM     AS BEFORE_DB_SYS_NM   
	               ,B.DB_SID_NM     AS BEFORE_DB_SID_NM   
	               ,B.AP_DUAL_MTH   AS BEFORE_AP_DUAL_MTH 
	               ,B.DB_DUAL_MTH   AS BEFORE_DB_DUAL_MTH 
	               ,B.DR_YN         AS BEFORE_DR_YN       
	               ,B.DR_MTH        AS BEFORE_DR_MTH      
	               ,B.DBMS_NM       AS BEFORE_DBMS_NM     
	               ,B.MNG_DEPT_NM   AS BEFORE_MNG_DEPT_NM 
	               ,B.WRK_NM        AS BEFORE_WRK_NM      
	               ,B.WRK_DEPT      AS BEFORE_WRK_DEPT    
	               ,B.DB_CHG_AUTH   AS BEFORE_DB_CHG_AUTH 
	               ,B.SYS_RUN_DTM   AS BEFORE_SYS_RUN_DTM 
	               ,B.WRITER        AS BEFORE_WRITER      
	               ,B.CHG_USER      AS BEFORE_CHG_USER    
	               ,B.WRK_STAT      AS BEFORE_WRK_STAT    
	               
	            FROM WAQ_SUBJ A
	            INNER JOIN WAA_SUBJ B
	            ON A.SUBJ_ID = B.SUBJ_ID
	            AND A.STND_ASRT = B.STND_ASRT
	            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
	            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
	        ,
	           (SELECT SEQ AS NO FROM seq_1_to_26) B
	       )A
  	</select>  
  
  <!-- 고객정보/비밀번호 변환 -->
  <select id="selectCustInfoChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
	SELECT RQST_NO
	         ,RQST_SNO
	         ,ITEM_NM
	         , AFTER_DATA AS "AFTER_CHG"
	         , BEFORE_DATA AS "BEFORE_CHG"
	         <![CDATA[
	         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
	         ]]>
	  FROM (
	        SELECT A.RQST_NO, A.RQST_SNO
	               ,CASE WHEN NO = 1 THEN '변환구분'    
	                	 WHEN NO = 2 THEN '변환기준 항목명'    
	                	 WHEN NO = 3 THEN '변환여부'             
	                	 WHEN NO = 4 THEN 'TRUNCATE여부'             
<!-- 	                	 WHEN NO = 5 THEN '암호화여부'              -->
<!-- 	                	 WHEN NO = 6 THEN '확인여부'              -->
<!-- 	                	 WHEN NO = 7 THEN '메모'              -->
<!-- 	                	 WHEN NO = 8 THEN '관리자'              -->
	                END AS ITEM_NM
	               ,CASE WHEN NO = 1 THEN BEFORE_TRANS_INFO_CD
	                	 WHEN NO = 2 THEN BEFORE_TRANS_ITEM_NM
	                	 WHEN NO = 3 THEN BEFORE_TRANS_YN    
	                	 WHEN NO = 4 THEN BEFORE_TRUNC_YN       
<!-- 	                	 WHEN NO = 5 THEN BEFORE_ENC_YN        -->
<!-- 	                	 WHEN NO = 6 THEN BEFORE_CONF_YN     -->
<!-- 	                	 WHEN NO = 7 THEN BEFORE_MEMO_TXT        -->
<!-- 	                	 WHEN NO = 8 THEN BEFORE_MNG_USER       -->
	                END AS BEFORE_DATA
	               ,CASE WHEN NO = 1 THEN AFTER_TRANS_INFO_CD
	                	 WHEN NO = 2 THEN AFTER_TRANS_ITEM_NM
	                	 WHEN NO = 3 THEN AFTER_TRANS_YN     
	                	 WHEN NO = 4 THEN AFTER_TRUNC_YN     
<!-- 	                	 WHEN NO = 5 THEN AFTER_ENC_YN        -->
<!-- 	                	 WHEN NO = 6 THEN AFTER_CONF_YN       -->
<!-- 	                	 WHEN NO = 7 THEN AFTER_MEMO_TXT      -->
<!-- 	                	 WHEN NO = 8 THEN AFTER_MNG_USER      -->
	                END AS AFTER_DATA
	        FROM 
	            (SELECT
	            		 A.RQST_NO
	            		,A.RQST_SNO
	            		,A.TRANS_INFO_CD				AS AFTER_TRANS_INFO_CD
	            		,A.TRANS_ITEM_NM 				AS AFTER_TRANS_ITEM_NM
	            		,CASE IFNULL(A.TRANS_YN, '0') 
	            			  WHEN '1' THEN 'Y' 
	            			  WHEN '0' THEN 'N'
	            		 	  ELSE 'N'
	            		 END  							AS AFTER_TRANS_YN       
	            		,CASE IFNULL(A.TRUNC_YN, '0') 
	            			  WHEN '1' THEN 'Y' 
	            			  WHEN '0' THEN 'N'
	            		 	  ELSE 'N'
	            		 END  							AS AFTER_TRUNC_YN         
<!-- 	            		,IFNULL(A.ENC_YN  , 'N')     	AS AFTER_ENC_YN             -->
<!-- 	            		,IFNULL(A.CONF_YN , 'N')     	AS AFTER_CONF_YN            -->
<!-- 	            		,A.MEMO_TXT     				AS AFTER_MEMO_TXT           -->
<!-- 	            		,A.MNG_USER     				AS AFTER_MNG_USER           -->
	            		,B.TRANS_INFO_CD				AS BEFORE_TRANS_INFO_CD
	            		,B.TRANS_ITEM_NM 				AS BEFORE_TRANS_ITEM_NM
	            		,CASE IFNULL(B.TRANS_YN, '0') 
	            			  WHEN '1' THEN 'Y' 
	            			  WHEN '0' THEN 'N'
	            		 	  ELSE 'N'
	            		 END  							AS BEFORE_TRANS_YN     
	            		,CASE IFNULL(B.TRUNC_YN, '0') 
	            			  WHEN '1' THEN 'Y' 
	            			  WHEN '0' THEN 'N'
	            		 	  ELSE 'N'
	            		 END  							AS BEFORE_TRUNC_YN     
<!-- 	            		,IFNULL(B.ENC_YN  , 'N')     	AS BEFORE_ENC_YN        -->
<!-- 	            		,IFNULL(B.CONF_YN , 'N')     	AS BEFORE_CONF_YN       -->
<!-- 	            		,B.MEMO_TXT     	AS BEFORE_MEMO_TXT      -->
<!-- 	            		,B.MNG_USER     	AS BEFORE_MNG_USER      -->
	            FROM WAQ_CUST_INFO A INNER JOIN 
            									(SELECT B.*, C.DB_SCH_PNM, D.DB_CONN_TRG_PNM
            								   	 FROM WAM_CUST_INFO B INNER JOIN WAA_DB_SCH C
										                   					  ON C.EXP_DTM = STR_TO_DATE('9999-12-31','%Y-%m-%d')
												  						     AND C.REG_TYP_CD IN ('C', 'U') 
												  						     AND B.DB_SCH_ID = C.DB_SCH_ID
												  						     AND B.STND_ASRT 	= C.STND_ASRT
											  					      INNER JOIN WAA_DB_CONN_TRG D
											  					 	    	  ON D.EXP_DTM = STR_TO_DATE('9999-12-31','%Y-%m-%d')
											  					 		     AND D.REG_TYP_CD IN ('C', 'U')
											  					 		     AND C.DB_CONN_TRG_ID = D.DB_CONN_TRG_ID
											  					 		     AND C.STND_ASRT 		 = D.STND_ASRT
            								   	)B							  	  
	            							   ON CASE WHEN NULLIF(A.CUST_INFO_ID,'') IS NULL 
	            							   		   THEN CONCAT(IFNULL(A.DB_CONN_TRG_PNM,''), IFNULL(A.DB_SCH_PNM,''), IFNULL(A.DDL_TBL_PNM,''), IFNULL(A.DDL_COL_PNM,''))   
	            							   		   ELSE A.CUST_INFO_ID  
	            							      END = CASE WHEN NULLIF(A.CUST_INFO_ID,'') IS NULL 
	            							      		     THEN CONCAT(IFNULL(B.DB_CONN_TRG_PNM,''), IFNULL(B.DB_SCH_PNM,''), IFNULL(B.DDL_TBL_PNM,''), IFNULL(B.DDL_COL_PNM,''))     
	            							      		     ELSE B.CUST_INFO_ID  
	            							      		END
	            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
	              AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
	        ,
	           (SELECT SEQ AS NO FROM seq_1_to_4) B
	       )A
  </select>
  
  
   <select id="selectRenameInfoChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         , AFTER_DATA AS "AFTER_CHG"
         , BEFORE_DATA AS "BEFORE_CHG"
         <![CDATA[
         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
 SELECT RQST_NO
      , RQST_SNO
      , (CASE WHEN B.NO = 1 THEN '물리테이블 변경'
              WHEN B.NO = 2 THEN '물리컬럼 신규/삭제'
              WHEN B.NO = 3 THEN 'DDL테이블 변경'
              WHEN B.NO = 4 THEN 'DDL컬럼 신규/삭제'
              WHEN B.NO = 5 THEN 'DDL인덱스 변경'
              WHEN B.NO = 6 THEN 'DDL인덱스 컬럼 신규/삭제'
         ELSE NULL END) AS ITEM_NM   
                
      , (CASE WHEN B.NO = 1 THEN AFTER_PDM_TBL_PNM
              WHEN B.NO = 2 THEN AFTER_PDM_COL_PNM
              WHEN B.NO = 3 THEN AFTER_DDL_TBL_PNM
              WHEN B.NO = 4 THEN AFTER_DDL_COL_PNM
              WHEN B.NO = 5 THEN AFTER_DDL_IDX_PNM
              WHEN B.NO = 6 THEN AFTER_DDL_IDX_COL_PNM
         ELSE NULL END) AS AFTER_DATA          
         
      , (CASE WHEN B.NO = 1 THEN BEFORE_PDM_TBL_PNM
              WHEN B.NO = 2 THEN BEFORE_PDM_COL_PNM
              WHEN B.NO = 3 THEN BEFORE_DDL_TBL_PNM
              WHEN B.NO = 4 THEN BEFORE_DDL_COL_PNM
              WHEN B.NO = 5 THEN BEFOR_DDL_IDX_PNM
              WHEN B.NO = 6 THEN BEFORE_DDL_IDX_COL_PNM
         ELSE NULL END) AS BEFORE_DATA 
  FROM (	SELECT A.RQST_NO
             , A.RQST_SNO
             , A.DDL_TBL_PNM     	   AS AFTER_DDL_TBL_PNM
             , A.DDL_TBL_PNM     	   AS AFTER_PDM_TBL_PNM
             , A.DDL_TRANS_COL_PNM     AS AFTER_DDL_COL_PNM
             , A.DDL_TRANS_COL_PNM     AS AFTER_PDM_COL_PNM
              ,RTRIM(GROUP_CONCAT(B.DDL_IDX_PNM ORDER BY A.DDL_TBL_PNM, A.RQST_NO SEPARATOR   ', '))  AS AFTER_DDL_IDX_PNM
              , CASE WHEN A.DDL_IDX_CHG_YN ='N' THEN '' 
               ELSE A.DDL_TRANS_COL_PNM END AS  AFTER_DDL_IDX_COL_PNM
               
             , A.DDL_TBL_PNM     	   AS BEFORE_DDL_TBL_PNM
             , A.DDL_TBL_PNM     	   AS BEFORE_PDM_TBL_PNM
             , A.DDL_COL_PNM     	   AS BEFORE_DDL_COL_PNM
             , A.DDL_COL_PNM     	   AS BEFORE_PDM_COL_PNM
             ,RTRIM(GROUP_CONCAT(B.DDL_IDX_PNM ORDER BY A.DDL_TBL_PNM, A.RQST_NO SEPARATOR   ', '))  AS BEFOR_DDL_IDX_PNM
             , CASE WHEN A.DDL_IDX_CHG_YN ='N' THEN '' 
               ELSE A.DDL_COL_PNM END AS  BEFORE_DDL_IDX_COL_PNM
          FROM WAQ_DDL_RENM A
         LEFT OUTER JOIN WAM_DDL_IDX B
            ON A.STND_ASRT = B.STND_ASRT
			  AND A.DDL_TBL_ID = B.DDL_TBL_ID
			LEFT OUTER JOIN WAM_DDL_IDX_COL C
			  ON B.STND_ASRT = C.STND_ASRT
			 AND B.DDL_IDX_ID = C.DDL_IDX_ID
			 AND A.DDL_COL_PNM = C.DDL_IDX_COL_PNM
         WHERE A.RQST_NO          = #{rqstNo,jdbcType=VARCHAR}
           AND A.RQST_SNO         = #{rqstSno,jdbcType=DECIMAL}
       ) A ,
           (SELECT SEQ AS NO FROM seq_1_to_6) B
       )A
  </select>
  
  <!-- 개발/테스트 데이터이관 -->
  <select id="selectTransDataChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
	SELECT RQST_NO
	         ,RQST_SNO
	         ,ITEM_NM
	         , AFTER_DATA AS "AFTER_CHG"
	         , BEFORE_DATA AS "BEFORE_CHG"
	         <![CDATA[
	         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
	         ]]>
	  FROM (
	        SELECT A.RQST_NO, A.RQST_SNO
	               ,CASE WHEN NO = 1 THEN '소스DB명'    
	                	 WHEN NO = 2 THEN '소스스키마명'    
	                	 WHEN NO = 3 THEN '소스테이블명'             
	                	 WHEN NO = 4 THEN '타겟DB명'             
	                	 WHEN NO = 5 THEN '타겟스키마명'       
	                	 WHEN NO = 6 THEN '타겟테이블명'      
	                	 WHEN NO = 7 THEN '조건절'          
	                	 WHEN NO = 8 THEN '데이터조건여부'             
	                	 WHEN NO = 9 THEN '데이터삭제예정일시'          
	                	 WHEN NO = 10 THEN '적용예정일시'          
	                	 WHEN NO = 11 THEN '기존데이터삭제구분'          
	                	 WHEN NO = 12 THEN '프로젝트번호'          
	                END AS ITEM_NM
	               ,CASE WHEN NO = 1 THEN BEFORE_SRC_DB_CONN_TRG_PNM
	                	 WHEN NO = 2 THEN BEFORE_SRC_DB_SCH_PNM
	                	 WHEN NO = 3 THEN BEFORE_SRC_DDL_TBL_PNM
	                	 WHEN NO = 4 THEN BEFORE_TGT_DB_CONN_TRG_PNM 
	                	 WHEN NO = 5 THEN BEFORE_TGT_DB_SCH_PNM
	                	 WHEN NO = 6 THEN BEFORE_TGT_DDL_TBL_PNM
	                	 WHEN NO = 7 THEN BEFORE_WHERE_TXT 
	                	 WHEN NO = 8 THEN BEFORE_WHERE_YN
	                	 WHEN NO = 9 THEN BEFORE_DATA_DEL_DTM
	                	 WHEN NO = 10 THEN BEFORE_APL_DTM
	                	 WHEN NO = 11 THEN BEFORE_DATA_DEL_DCD
	                	 WHEN NO = 12 THEN BEFORE_PRJ_NO     
	                END AS BEFORE_DATA
	               ,CASE WHEN NO = 1 THEN AFTER_SRC_DB_CONN_TRG_PNM
	                	 WHEN NO = 2 THEN AFTER_SRC_DB_SCH_PNM     
	                	 WHEN NO = 3 THEN AFTER_SRC_DDL_TBL_PNM    
	                	 WHEN NO = 4 THEN AFTER_TGT_DB_CONN_TRG_PNM
	                	 WHEN NO = 5 THEN AFTER_TGT_DB_SCH_PNM     
	                	 WHEN NO = 6 THEN AFTER_TGT_DDL_TBL_PNM    
	                	 WHEN NO = 7 THEN AFTER_WHERE_TXT          
	                	 WHEN NO = 8 THEN AFTER_WHERE_YN           
	                	 WHEN NO = 9 THEN AFTER_DATA_DEL_DTM       
	                	 WHEN NO = 10 THEN AFTER_APL_DTM           
	                	 WHEN NO = 11 THEN AFTER_DATA_DEL_DCD      
	                	 WHEN NO = 12 THEN AFTER_PRJ_NO            
	                END AS AFTER_DATA
	        FROM 
	            (SELECT
	            		 A.RQST_NO
	            		,A.RQST_SNO
	            		,A.SRC_DB_CONN_TRG_PNM			AS AFTER_SRC_DB_CONN_TRG_PNM 
	            		,A.SRC_DB_SCH_PNM     			AS AFTER_SRC_DB_SCH_PNM      
	            		,A.SRC_DDL_TBL_PNM    			AS AFTER_SRC_DDL_TBL_PNM      
	            		,A.TGT_DB_CONN_TRG_PNM			AS AFTER_TGT_DB_CONN_TRG_PNM  
	            		,A.TGT_DB_SCH_PNM     			AS AFTER_TGT_DB_SCH_PNM       
	            		,A.TGT_DDL_TBL_PNM    			AS AFTER_TGT_DDL_TBL_PNM      
	            		,A.WHERE_TXT          			AS AFTER_WHERE_TXT            
	            		,A.WHERE_YN           			AS AFTER_WHERE_YN             
	            		,A.DATA_DEL_DTM       			AS AFTER_DATA_DEL_DTM         
	            		,A.APL_DTM            			AS AFTER_APL_DTM             
	            		,A.DATA_DEL_DCD       			AS AFTER_DATA_DEL_DCD        
	            		,A.PRJ_NO             			AS AFTER_PRJ_NO              
	            		,B.SRC_DB_CONN_TRG_PNM 		    AS BEFORE_SRC_DB_CONN_TRG_PNM  
	            		,B.SRC_DB_SCH_PNM      		    AS BEFORE_SRC_DB_SCH_PNM       
	            		,B.SRC_DDL_TBL_PNM      	    AS BEFORE_SRC_DDL_TBL_PNM      
	            		,B.TGT_DB_CONN_TRG_PNM 		    AS BEFORE_TGT_DB_CONN_TRG_PNM  
	            		,B.TGT_DB_SCH_PNM      		    AS BEFORE_TGT_DB_SCH_PNM       
	            		,B.TGT_DDL_TBL_PNM     		    AS BEFORE_TGT_DDL_TBL_PNM      
	            		,B.WHERE_TXT           		    AS BEFORE_WHERE_TXT            
	            		,B.WHERE_YN            		    AS BEFORE_WHERE_YN             
	            		,B.DATA_DEL_DTM        		    AS BEFORE_DATA_DEL_DTM         
	            		,B.APL_DTM             		    AS BEFORE_APL_DTM             
	            		,B.DATA_DEL_DCD        		    AS BEFORE_DATA_DEL_DCD        
	            		,B.PRJ_NO              		    AS BEFORE_PRJ_NO              
	            FROM WAQ_DATA_TSF A INNER JOIN 
           									(SELECT B.*, SS.DB_SCH_PNM 		AS SRC_DB_SCH_PNM
           											   , SD.DB_CONN_TRG_PNM AS SRC_DB_CONN_TRG_PNM
           											   , TS.DB_SCH_PNM 		AS TGT_DB_SCH_PNM
           											   , TD.DB_CONN_TRG_PNM AS TGT_DB_CONN_TRG_PNM
           								   	 FROM WAM_DATA_TSF B  INNER JOIN WAA_DB_SCH SS
					                          					   		  ON SS.EXP_DTM = STR_TO_DATE('9999-12-31','%Y-%m-%d')
					    					  							 AND SS.REG_TYP_CD IN ('C', 'U') 
					    					  						     AND B.SRC_DB_SCH_ID = SS.DB_SCH_ID
					    					  						     AND B.STND_ASRT 	= SS.STND_ASRT
					    					  					  INNER JOIN WAA_DB_CONN_TRG SD
					    					  					 	  	  ON SD.EXP_DTM = STR_TO_DATE('9999-12-31','%Y-%m-%d')
					    					  					 		 AND SD.REG_TYP_CD IN ('C', 'U')
					    					  					 		 AND SS.DB_CONN_TRG_ID = SD.DB_CONN_TRG_ID
					    					  					 		 AND SS.STND_ASRT 		 = SD.STND_ASRT
					    					  					  INNER JOIN WAA_DB_SCH TS
					                          					   		  ON TS.EXP_DTM = STR_TO_DATE('9999-12-31','%Y-%m-%d')
					    					  							 AND TS.REG_TYP_CD IN ('C', 'U') 
					    					  						     AND B.TGT_DB_SCH_ID = TS.DB_SCH_ID
					    					  						     AND B.STND_ASRT 	= TS.STND_ASRT
					    					  					  INNER JOIN WAA_DB_CONN_TRG TD
					    					  					 	  	  ON TD.EXP_DTM = STR_TO_DATE('9999-12-31','%Y-%m-%d')
					    					  					 		 AND TD.REG_TYP_CD IN ('C', 'U')
					    					  					 		 AND TS.DB_CONN_TRG_ID = TD.DB_CONN_TRG_ID
					    					  					 		 AND TS.STND_ASRT 		 = TD.STND_ASRT 
           								   	)B							  	  
            							   ON CASE WHEN NULLIF(A.DATA_TSF_ID,'') IS NULL 
            							   		   THEN CONCAT(IFNULL(A.SRC_DB_CONN_TRG_PNM,''), IFNULL(A.SRC_DB_SCH_PNM,''), IFNULL(A.SRC_DDL_TBL_PNM,'')
            							   		   			  ,IFNULL(A.TGT_DB_CONN_TRG_PNM,''), IFNULL(A.TGT_DB_SCH_PNM,''), IFNULL(A.TGT_DDL_TBL_PNM,'')
            							   		   			  ,IFNULL(A.WHERE_TXT,''))   
            							   		   ELSE A.DATA_TSF_ID  
            							      END = CASE WHEN NULLIF(A.DATA_TSF_ID,'') IS NULL
            							      		     THEN CONCAT(IFNULL(B.SRC_DB_CONN_TRG_PNM,''), IFNULL(B.SRC_DB_SCH_PNM,''), IFNULL(B.SRC_DDL_TBL_PNM,'')
            							   		   			  		,IFNULL(B.TGT_DB_CONN_TRG_PNM,''), IFNULL(B.TGT_DB_SCH_PNM,''), IFNULL(B.TGT_DDL_TBL_PNM,'')
            							   		   			  		,IFNULL(B.WHERE_TXT,''))     
            							      		     ELSE B.DATA_TSF_ID  
            							      		END
	            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
	              AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
	        ,
	           (SELECT SEQ AS NO FROM seq_1_to_12) B
	       )A
  </select>
  
  <select id="selectLangCmmtChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
	SELECT RQST_NO
	         ,RQST_SNO
	         ,ITEM_NM
	         , AFTER_DATA AS "AFTER_CHG"
	         , BEFORE_DATA AS "BEFORE_CHG"
	         <![CDATA[
	         , (CASE WHEN IFNULL(AFTER_DATA, '') <> IFNULL(BEFORE_DATA, '') THEN  '#FF0000' END  ) AS FontColor
	         ]]>
	  FROM (
	        SELECT A.RQST_NO, A.RQST_SNO
	               ,CASE WHEN NO = 1 THEN '커멘트명'    
	               	     WHEN NO = 2 THEN '담당자명'
	                END AS ITEM_NM
	               ,CASE WHEN NO = 1 THEN BEFORE_LANG_CMMT_PNM
	                     WHEN NO = 2 THEN BEFORE_CRG_USER_NM
	                END AS BEFORE_DATA
	               ,CASE WHEN NO = 1 THEN AFTER_LANG_CMMT_PNM
	                     WHEN NO = 2 THEN AFTER_CRG_USER_NM
	                END AS AFTER_DATA
	        FROM 
	            (SELECT
	            		 A.RQST_NO
	            		,A.RQST_SNO
	            		,A.LANG_CMMT_PNM 	AS AFTER_LANG_CMMT_PNM
	            		,C.USER_NM			AS AFTER_CRG_USER_NM
	            		,B.LANG_CMMT_PNM 	AS BEFORE_LANG_CMMT_PNM
	            		,D.USER_NM			AS BEFORE_CRG_USER_NM
	            FROM WAQ_LANG_CMMT A 
	            INNER JOIN WAM_LANG_CMMT B
	               ON A.REF_ID 			= B.REF_ID 
              	  AND A.STND_ASRT 			= B.STND_ASRT
              	  AND A.LANG_CD			= B.LANG_CD
              	  AND A.LANG_BIZ_DCD    = B.LANG_BIZ_DCD
              	LEFT OUTER JOIN WAA_USER C
				  ON A.CRG_USER_ID = C.USER_ID
				 AND C.REG_TYP_CD IN ('C', 'U')
				LEFT OUTER JOIN WAA_USER D
				  ON B.CRG_USER_ID = D.USER_ID
				 AND D.REG_TYP_CD IN ('C', 'U')
	            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
	              AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
	        ,
	           (SELECT SEQ AS NO FROM seq_1_to_2) B
	       )A
  </select>
  
  
   <select id="selectDmngChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
          <![CDATA[
         , (CASE WHEN coalesce(AFTER, '_') <> coalesce(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN '도메인그룹논리명'
                     WHEN NO = 2 THEN '도메인그룹물리명'
                     WHEN NO = 3 THEN '상위도메인논리명'
                     WHEN NO = 4 THEN '레벨'
                     WHEN NO = 5 THEN '설명'
   
                END AS ITEM_NM
              ,CASE WHEN NO = 1 THEN BEFORE_DMNG_LNM    
                    WHEN NO = 2 THEN BEFORE_DMNG_PNM    
                    WHEN NO = 3 THEN BEFORE_UPP_DMNG_LNM
                    WHEN NO = 4 THEN BEFORE_DMNG_LVL    
                    WHEN NO = 5 THEN BEFORE_OBJ_DESCN   
 
               END AS BEFORE
              ,CASE WHEN NO = 1 THEN AFTER_DMNG_LNM     
                    WHEN NO = 2 THEN AFTER_DMNG_PNM    
                    WHEN NO = 3 THEN AFTER_UPP_DMNG_LNM
                    WHEN NO = 4 THEN AFTER_DMNG_LVL    
                    WHEN NO = 5 THEN AFTER_OBJ_DESCN   
          
               END AS AFTER
        FROM 
            (SELECT
                A.RQST_NO
               ,A.RQST_SNO
               ,A.DMNG_LNM          AS AFTER_DMNG_LNM                
               ,A.DMNG_PNM    	    AS AFTER_DMNG_PNM    	          
               ,A.UPP_DMNG_LNM      AS AFTER_UPP_DMNG_LNM        
               ,CONCAT(A.DMNG_LVL)	AS AFTER_DMNG_LVL      	  
               ,A.CD_DMN_YN        AS AFTER_CD_DMN_YN
               ,A.OBJ_DESCN   		AS AFTER_OBJ_DESCN   		
               ,B.DMNG_LNM          AS BEFORE_DMNG_LNM               
               ,B.DMNG_PNM    	    AS BEFORE_DMNG_PNM    	         
               ,B.UPP_DMNG_LNM      AS BEFORE_UPP_DMNG_LNM       
               ,CONCAT(B.DMNG_LVL)	AS BEFORE_DMNG_LVL
               ,B.CD_DMN_YN        AS BEFORE_CD_DMN_YN      	 
               ,B.OBJ_DESCN   		AS BEFORE_OBJ_DESCN   		
            FROM WAQ_DMNG A
            INNER JOIN WAA_DMNG B
            ON A.DMNG_ID = B.DMNG_ID
            AND B.EXP_DTM = STR_TO_DATE('99991231', '%Y%m%d')
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,  (SELECT SEQ AS NO FROM seq_1_to_6) B
)
  </select>
  
  
  <select id="selectInfoTypeChgList" resultMap="BaseResultMap" parameterType="kr.wise.commons.rqstmst.service.WaqMstr" >
SELECT RQST_NO
         ,RQST_SNO
         ,ITEM_NM
         ,AFTER
         ,BEFORE
          <![CDATA[
         , (CASE WHEN coalesce(AFTER, '_') <> coalesce(BEFORE, '_') THEN  '#FF0000' END  ) AS FontColor
         ]]>
  FROM (
        SELECT A.RQST_NO, A.RQST_SNO
               ,CASE WHEN NO = 1 THEN '인포타입논리명'
                     WHEN NO = 2 THEN '데이터타입'
                     WHEN NO = 3 THEN '데이터길이'
                     WHEN NO = 4 THEN '데이터소수점'
                     WHEN NO = 5 THEN '설명'
                END AS ITEM_NM
              ,CASE WHEN NO = 1 THEN AFTER_INFOTP_LNM   
                    WHEN NO = 2 THEN AFTER_DATA_TYPE    
                    WHEN NO = 3 THEN AFTER_SDITM_LNM    
                    WHEN NO = 4 THEN AFTER_SDITM_PNM    
                    WHEN NO = 5 THEN AFTER_OBJ_DESCN    
 
               END AS BEFORE
              ,CASE WHEN NO = 1 THEN BEFORE_INFOTP_LNM  
                    WHEN NO = 2 THEN BEFORE_DATA_TYPE   
                    WHEN NO = 3 THEN BEFORE_SDITM_LNM   
                    WHEN NO = 4 THEN BEFORE_SDITM_PNM   
                    WHEN NO = 5 THEN BEFORE_OBJ_DESCN   
          
               END AS AFTER
        FROM 
            (SELECT
                A.RQST_NO
               ,A.RQST_SNO
               ,A.INFOTP_LNM         AS AFTER_INFOTP_LNM       
               ,A.DATA_TYPE    	     AS AFTER_DATA_TYPE        
               ,CONCAT(A.DATA_LEN)  AS AFTER_SDITM_LNM         
               ,CONCAT(A.DATA_SCAL) AS AFTER_SDITM_PNM         
               ,A.OBJ_DESCN  		 AS AFTER_OBJ_DESCN   
               ,B.INFOTP_LNM         AS BEFORE_INFOTP_LNM       
               ,B.DATA_TYPE    	     AS BEFORE_DATA_TYPE        
               ,CONCAT(B.DATA_LEN)  AS BEFORE_SDITM_LNM         
               ,CONCAT(B.DATA_SCAL) AS BEFORE_SDITM_PNM         
               ,B.OBJ_DESCN  		 AS BEFORE_OBJ_DESCN   
            FROM WAQ_INFO_TYPE A
            INNER JOIN WAA_INFO_TYPE B
            ON A.INFOTP_ID = B.INFOTP_ID
            AND B.EXP_DTM = STR_TO_DATE('99991231', '%Y%m%d')
            WHERE A.RQST_NO = #{rqstNo,jdbcType=VARCHAR}
            AND A.RQST_SNO = #{rqstSno,jdbcType=DECIMAL}) A
        ,  (SELECT SEQ AS NO FROM seq_1_to_5) B
)
  </select>
</mapper>